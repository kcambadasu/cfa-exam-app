<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CFA Level I ‚Äì Practice Hub</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400;1,600&family=DM+Sans:wght@300;400;500;600&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<style>

:root {
  --navy:#0f1e3c; --navy-mid:#1a2f5a; --navy-soft:#243a6b; --navy-glow:#1e3a78;
  --gold:#c9a84c; --gold-light:#e8c97a; --gold-pale:#f7f0dc; --gold-dim:#a07c30;
  --cream:#faf8f3; --white:#ffffff;
  --text:#1a1a2e; --text-mid:#3a3a5c; --text-light:#7a7a9a;
  --border:#ddd8cc; --border-soft:#eceae4;
  --green:#1a7a4a; --green-bg:#e8f7ef;
  --shadow-sm:0 2px 12px rgba(15,30,60,.07);
  --shadow-md:0 6px 28px rgba(15,30,60,.12);
  --shadow-lg:0 16px 56px rgba(15,30,60,.16);
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{scroll-behavior:smooth}
body{font-family:'DM Sans',sans-serif;background:var(--cream);color:var(--text);min-height:100vh;overflow-x:hidden}

/* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
header {
  background:var(--navy);
  padding:20px 40px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  position:relative;
  overflow:hidden;
}
header::before {
  content:'';
  position:absolute;
  inset:0;
  background:
    repeating-linear-gradient(90deg,transparent,transparent 79px,rgba(201,168,76,.04) 79px,rgba(201,168,76,.04) 80px),
    repeating-linear-gradient(0deg,transparent,transparent 79px,rgba(201,168,76,.04) 79px,rgba(201,168,76,.04) 80px);
}
.header-brand {
  display:flex;
  align-items:center;
  gap:16px;
  position:relative;
}
.brand-badge {
  width:44px;height:44px;
  background:linear-gradient(135deg, var(--gold) 0%, var(--gold-dim) 100%);
  border-radius:10px;
  display:flex;align-items:center;justify-content:center;
  font-family:'Cormorant Garamond',serif;
  font-size:1.2rem;font-weight:700;
  color:var(--navy);
  flex-shrink:0;
  box-shadow:0 4px 12px rgba(201,168,76,.35);
}
.brand-text h1{font-family:'Cormorant Garamond',serif;color:var(--white);font-size:1.1rem;font-weight:600;line-height:1.2}
.brand-text p{color:rgba(255,255,255,.4);font-size:.68rem;letter-spacing:.12em;text-transform:uppercase;margin-top:2px}
.header-nav {
  display:flex;gap:8px;position:relative;
}
.nav-link {
  color:rgba(255,255,255,.5);
  font-size:.78rem;font-weight:500;
  text-decoration:none;
  padding:7px 16px;border-radius:7px;
  transition:all .2s;
  letter-spacing:.02em;
}
.nav-link:hover{color:var(--gold-light);background:rgba(255,255,255,.06)}
.nav-link.active{color:var(--gold-light);background:rgba(201,168,76,.15)}

/* ‚îÄ‚îÄ HERO ‚îÄ‚îÄ */
.hero {
  position:relative;
  background:var(--navy);
  overflow:hidden;
  padding:80px 40px 0;
}
.hero-bg {
  position:absolute;inset:0;
  background:
    radial-gradient(ellipse 60% 80% at 10% 60%, rgba(201,168,76,.09) 0%, transparent 60%),
    radial-gradient(ellipse 40% 50% at 90% 20%, rgba(36,58,107,.9) 0%, transparent 60%),
    radial-gradient(ellipse 80% 60% at 50% 100%, rgba(15,30,60,1) 0%, transparent 70%);
}
.hero-grid {
  position:absolute;inset:0;
  background-image:
    repeating-linear-gradient(0deg,transparent,transparent 49px,rgba(201,168,76,.05) 49px,rgba(201,168,76,.05) 50px),
    repeating-linear-gradient(90deg,transparent,transparent 49px,rgba(201,168,76,.05) 49px,rgba(201,168,76,.05) 50px);
}
.hero-inner {
  max-width:1100px;
  margin:0 auto;
  position:relative;
  display:grid;
  grid-template-columns: 1fr;
  gap: 0;
  align-items:end;
  padding-bottom:0;
}
@media(max-width:900px){.hero-inner{grid-template-columns:1fr}.hero-card-col{display:none}}
.hero-text {
  padding-bottom:64px;
}
.hero-eyebrow {
  display:inline-flex;align-items:center;gap:8px;
  background:rgba(201,168,76,.12);
  border:1px solid rgba(201,168,76,.25);
  border-radius:20px;
  padding:5px 14px 5px 10px;
  margin-bottom:28px;
}
.hero-eyebrow-dot{width:6px;height:6px;background:var(--gold);border-radius:50%;animation:pulse 2s infinite}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.5;transform:scale(1.3)}}
.hero-eyebrow span{font-size:.72rem;font-weight:600;letter-spacing:.1em;text-transform:uppercase;color:var(--gold)}
.hero h2 {
  font-family:'Cormorant Garamond',serif;
  color:var(--white);
  font-size:clamp(2.8rem,5.5vw,4.4rem);
  font-weight:700;
  line-height:1.05;
  letter-spacing:-.02em;
  margin-bottom:24px;
}
.hero h2 em{color:var(--gold-light);font-style:italic}
.hero-desc {
  color:rgba(255,255,255,.6);
  font-size:1rem;
  line-height:1.7;
  max-width:480px;
  margin-bottom:36px;
}
.hero-stats {
  display:flex;gap:32px;flex-wrap:wrap;
  padding-top:32px;
  border-top:1px solid rgba(255,255,255,.08);
}
.hero-stat-num{font-family:'Cormorant Garamond',serif;font-size:1.9rem;font-weight:700;color:var(--gold-light);line-height:1}
.hero-stat-label{font-size:.72rem;color:rgba(255,255,255,.4);text-transform:uppercase;letter-spacing:.08em;margin-top:3px}

/* Floating card in hero */
.hero-card-col {
  position:relative;
  padding-bottom:40px;
}
.hero-float-card {
  background:rgba(255,255,255,.05);
  backdrop-filter:blur(20px);
  border:1px solid rgba(255,255,255,.1);
  border-radius:20px;
  padding:28px;
  box-shadow:0 24px 64px rgba(0,0,0,.3);
}
.hfc-label{font-size:.65rem;font-weight:700;letter-spacing:.14em;text-transform:uppercase;color:var(--gold);margin-bottom:16px}
.hfc-chapter {
  background:rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.1);
  border-radius:10px;
  padding:12px 14px;
  display:flex;align-items:center;gap:12px;
  margin-bottom:8px;
  cursor:pointer;
  transition:all .2s;
}
.hfc-chapter:hover{background:rgba(201,168,76,.12);border-color:rgba(201,168,76,.3)}
.hfc-ch-num{font-family:'DM Mono',monospace;font-size:.65rem;color:var(--gold);background:rgba(201,168,76,.15);padding:3px 7px;border-radius:4px;flex-shrink:0}
.hfc-ch-title{font-size:.78rem;color:rgba(255,255,255,.75);line-height:1.3}
.hfc-ch-count{margin-left:auto;font-size:.65rem;color:rgba(255,255,255,.35);flex-shrink:0}
.hfc-available{display:inline-block;background:var(--green-bg);color:var(--green);font-size:.65rem;font-weight:600;padding:2px 8px;border-radius:4px;margin-top:10px}
.hfc-coming{display:inline-block;background:rgba(255,255,255,.07);color:rgba(255,255,255,.35);font-size:.65rem;padding:2px 8px;border-radius:4px;margin-top:10px}

/* ‚îÄ‚îÄ WAVE DIVIDER ‚îÄ‚îÄ */
.wave {
  display:block;
  width:100%;
  height:64px;
  background:var(--navy);
  clip-path:ellipse(55% 100% at 50% 0%);
  margin-bottom:-2px;
}

/* ‚îÄ‚îÄ MAIN CONTENT ‚îÄ‚îÄ */
.main {
  max-width:1100px;
  margin:0 auto;
  padding:60px 40px 80px;
}
@media(max-width:640px){.main{padding:40px 20px 60px}}

/* Section label */
.section-eyebrow {
  display:flex;align-items:center;gap:10px;
  margin-bottom:12px;
}
.eyebrow-line{flex:0 0 32px;height:2px;background:var(--gold);border-radius:2px}
.section-eyebrow span{font-size:.68rem;font-weight:700;letter-spacing:.14em;text-transform:uppercase;color:var(--gold)}
.section-title{font-family:'Cormorant Garamond',serif;font-size:clamp(1.6rem,3vw,2.1rem);font-weight:700;color:var(--navy);line-height:1.2;margin-bottom:8px}
.section-sub{font-size:.88rem;color:var(--text-light);line-height:1.6;max-width:560px}

/* ‚îÄ‚îÄ HOW IT WORKS ‚îÄ‚îÄ */
.how-list {
  margin-top:20px;
  background:var(--white);
  border:1px solid var(--border);
  border-radius:14px;
  overflow:hidden;
  box-shadow:var(--shadow-sm);
}
.how-item {
  display:flex;align-items:flex-start;gap:14px;
  padding:13px 20px;
  border-bottom:1px solid var(--border-soft);
  transition:background .15s;
}
.how-item:last-child{border-bottom:none}
.how-item:hover{background:#f9f8ff}
.how-step {
  width:24px;height:24px;flex-shrink:0;margin-top:1px;
  background:var(--navy);color:var(--gold-light);
  border-radius:50%;display:flex;align-items:center;justify-content:center;
  font-family:'DM Mono',monospace;font-size:.68rem;font-weight:700;
}
.how-icon{font-size:.95rem;flex-shrink:0;margin-top:3px}
.how-item-text strong{font-size:.85rem;font-weight:600;color:var(--navy)}
.how-item-text p{font-size:.77rem;color:var(--text-mid);margin-top:1px;line-height:1.4}

/* ‚îÄ‚îÄ START EXAM SECTION ‚îÄ‚îÄ */
.start-section {margin-top:60px}
.start-grid {
  display:grid;
  grid-template-columns:1fr 360px;
  gap:36px;align-items:start;margin-top:32px;
}
@media(max-width:800px){.start-grid{grid-template-columns:1fr}}

/* Chapter selector */
.selector-card {
  background:var(--white);border:1px solid var(--border);
  border-radius:20px;overflow:hidden;box-shadow:var(--shadow-sm);
}
.selector-header {
  background:var(--navy);padding:18px 24px;
  display:flex;align-items:center;gap:12px;
}
.selector-header h3{color:var(--gold-light);font-family:'Cormorant Garamond',serif;font-size:1.1rem;font-weight:600}
.selector-header p{color:rgba(255,255,255,.45);font-size:.72rem;margin-top:2px}
.selector-body{padding:22px}

.field-label {
  font-size:.7rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;
  color:var(--text-light);margin-bottom:8px;display:block;
}

/* Native select dropdown */
.chapter-select-wrap{position:relative;margin-bottom:18px}
.chapter-select-wrap::after{
  content:'‚ñæ';position:absolute;right:14px;top:50%;transform:translateY(-50%);
  color:var(--gold);font-size:.85rem;pointer-events:none;
}
select#chapterDropdown,
select#topicDropdown,
select#summaryTopicDropdown,
select#summaryChapterDropdown {
  appearance:none;-webkit-appearance:none;
  width:100%;background:var(--white);
  border:2px solid var(--border);border-radius:10px;
  padding:11px 40px 11px 14px;
  font-family:'DM Sans',sans-serif;font-size:.85rem;font-weight:500;color:var(--text);
  cursor:pointer;outline:none;transition:border-color .18s;
}
select#chapterDropdown:focus,
select#topicDropdown:focus,
select#summaryTopicDropdown:focus,
select#summaryChapterDropdown:focus{border-color:var(--navy)}
select#chapterDropdown option,
select#topicDropdown option,
select#summaryTopicDropdown option,
select#summaryChapterDropdown option{font-size:.85rem}
select#chapterDropdown option:disabled,
select#topicDropdown option:disabled,
select#summaryTopicDropdown option:disabled,
select#summaryChapterDropdown option:disabled{color:var(--text-light)}
select:disabled{opacity:.55;cursor:not-allowed}

/* Options row */
.options-row {
  display:flex;align-items:center;gap:20px;
  padding:14px 0;
  border-top:1px solid var(--border-soft);
  border-bottom:1px solid var(--border-soft);
  margin-bottom:20px;
}
.toggle-wrap {
  display:flex;align-items:center;gap:10px;cursor:pointer;user-select:none;
}
.toggle {
  width:40px;height:22px;
  background:var(--border);border-radius:11px;
  position:relative;transition:background .2s;
  flex-shrink:0;
}
.toggle.on{background:var(--navy)}
.toggle::after{
  content:'';position:absolute;
  top:3px;left:3px;
  width:16px;height:16px;
  background:var(--white);border-radius:50%;
  transition:left .2s;
  box-shadow:0 1px 4px rgba(0,0,0,.2);
}
.toggle.on::after{left:21px}
.toggle-label{font-size:.8rem;font-weight:500;color:var(--text-mid)}
.toggle-sublabel{font-size:.7rem;color:var(--text-light)}

/* Start button */
.btn-start {
  display:flex;align-items:center;justify-content:center;gap:10px;
  width:100%;padding:15px 28px;
  background:linear-gradient(135deg, var(--navy) 0%, var(--navy-soft) 100%);
  color:var(--gold-light);
  border:none;border-radius:12px;
  font-family:'DM Sans',sans-serif;font-size:.95rem;font-weight:700;
  letter-spacing:.02em;
  cursor:pointer;
  transition:all .2s;
  box-shadow:0 4px 20px rgba(15,30,60,.25);
  text-decoration:none;
}
.btn-start:hover{transform:translateY(-2px);box-shadow:0 8px 28px rgba(15,30,60,.32)}
.btn-start:active{transform:translateY(0)}
.btn-start-arrow{font-size:1.1rem;transition:transform .2s}
.btn-start:hover .btn-start-arrow{transform:translateX(4px)}
.btn-start.disabled{opacity:.4;cursor:not-allowed;pointer-events:none}

/* Right side info */
.info-aside {
  display:flex;flex-direction:column;gap:16px;
  position:sticky;top:24px;
}
.info-box {
  background:var(--white);
  border:1px solid var(--border);
  border-radius:16px;
  overflow:hidden;
  box-shadow:var(--shadow-sm);
}
.info-box-header {
  background:linear-gradient(135deg,var(--gold-pale),#f0e8cc);
  padding:14px 18px;
  border-bottom:1px solid var(--border);
  display:flex;align-items:center;gap:8px;
}
.info-box-header h4{font-family:'Cormorant Garamond',serif;font-size:.95rem;font-weight:700;color:var(--navy)}
.info-box-body{padding:16px 18px}
.info-row{display:flex;justify-content:space-between;align-items:center;font-size:.8rem;padding:6px 0;border-bottom:1px solid var(--border-soft)}
.info-row:last-child{border-bottom:none}
.info-row-label{color:var(--text-light)}
.info-row-val{font-weight:600;color:var(--navy)}
.info-row-val.green{color:var(--green)}

/* Tips box */
.tips-list{list-style:none;display:flex;flex-direction:column;gap:8px}
.tips-list li{display:flex;gap:10px;font-size:.78rem;color:var(--text-mid);line-height:1.45}
.tips-list li::before{content:'üí°';flex-shrink:0;font-size:.8rem;margin-top:1px}

/* ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ */
footer{
  background:var(--navy);
  padding:28px 40px;
  text-align:center;
}
.footer-logo{font-family:'Cormorant Garamond',serif;color:rgba(255,255,255,.3);font-size:.85rem;letter-spacing:.1em}
.footer-note{color:rgba(255,255,255,.2);font-size:.7rem;margin-top:6px}

/* ‚îÄ‚îÄ ANIMATIONS ‚îÄ‚îÄ */
@keyframes fadeUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
.anim-1{animation:fadeUp .6s ease both}
.anim-2{animation:fadeUp .6s .1s ease both}
.anim-3{animation:fadeUp .6s .2s ease both}
.anim-4{animation:fadeUp .6s .3s ease both}
.anim-5{animation:fadeUp .6s .4s ease both}
.anim-6{animation:fadeUp .6s .5s ease both}



/* ‚îÄ‚îÄ HOME TABS ‚îÄ‚îÄ */
.home-tabs {
  display:flex;gap:4px;position:relative;
}
.home-tab {
  background:none;border:none;cursor:pointer;
  padding:8px 20px;border-radius:8px;
  font-family:'DM Sans',sans-serif;font-size:.8rem;font-weight:500;
  color:rgba(255,255,255,.5);letter-spacing:.03em;
  transition:all .2s;display:flex;align-items:center;gap:7px;
}
.home-tab:hover{color:rgba(255,255,255,.85);background:rgba(255,255,255,.06)}
.home-tab.active{background:rgba(201,168,76,.18);color:var(--gold-light);font-weight:600}

/* ‚îÄ‚îÄ TAB PANELS ‚îÄ‚îÄ */
.tab-pane{display:none}
.tab-pane.active{display:block}

/* ‚îÄ‚îÄ SUMMARY PANEL ‚îÄ‚îÄ */
.summary-wrap{max-width:960px;margin:0 auto;padding:48px 40px 80px}
@media(max-width:640px){.summary-wrap{padding:32px 20px 60px}}

/* Summary hero */
.sum-hero{background:var(--navy);background-image:radial-gradient(ellipse at 20% 50%,rgba(201,168,76,.12) 0%,transparent 60%);padding:40px 40px 32px;border-radius:16px;position:relative;overflow:hidden;margin-bottom:32px}
.sum-hero::before{content:'';position:absolute;inset:0;background-image:repeating-linear-gradient(0deg,transparent,transparent 39px,rgba(201,168,76,.05) 39px,rgba(201,168,76,.05) 40px),repeating-linear-gradient(90deg,transparent,transparent 39px,rgba(201,168,76,.05) 39px,rgba(201,168,76,.05) 40px)}
.sum-hero-label{font-size:.65rem;font-weight:600;letter-spacing:.18em;text-transform:uppercase;color:var(--gold);margin-bottom:10px;position:relative}
.sum-hero h1{font-family:'Cormorant Garamond',serif;color:var(--white);font-size:clamp(1.3rem,3vw,2rem);font-weight:700;line-height:1.2;max-width:600px;position:relative}
.sum-hero h1 em{color:var(--gold-light);font-style:italic}
.sum-hero-tags{display:flex;flex-wrap:wrap;gap:8px;margin-top:16px;position:relative}
.sum-hero-tag{background:rgba(201,168,76,.15);border:1px solid rgba(201,168,76,.3);color:var(--gold-light);font-size:.68rem;font-weight:500;padding:3px 10px;border-radius:16px}

/* Summary body */
.sum-body{background:var(--white);border:1px solid var(--border);border-radius:16px;padding:36px;box-shadow:var(--shadow-sm)}
@media(max-width:600px){.sum-body{padding:24px 18px}}

.s-divider{border:none;border-top:1px solid var(--border);margin:28px 0}

.s-header{display:flex;align-items:center;gap:12px;margin-bottom:16px}
.s-icon{width:34px;height:34px;background:var(--navy);border-radius:8px;display:flex;align-items:center;justify-content:center;flex-shrink:0;font-size:.85rem}
.s-header h2{font-family:'Cormorant Garamond',serif;font-size:1.05rem;font-weight:700;color:var(--navy);line-height:1.2}
.s-header h2 span{display:block;font-family:'DM Sans',sans-serif;font-size:.65rem;font-weight:700;letter-spacing:.12em;text-transform:uppercase;color:var(--gold);margin-bottom:2px}

/* LOs */
.lo-list{display:flex;flex-direction:column;gap:7px}
.lo-item{display:flex;gap:10px;align-items:flex-start;background:var(--cream);border-left:3px solid var(--gold);padding:9px 14px;border-radius:0 7px 7px 0}
.lo-pill{font-family:'DM Mono',monospace;font-size:.65rem;font-weight:600;color:var(--gold);background:var(--gold-pale);padding:2px 7px;border-radius:4px;flex-shrink:0;margin-top:1px}
.lo-text{font-size:.8rem;color:var(--text-mid);line-height:1.45}

/* Phases */
.phases-table{border:1px solid var(--border);border-radius:12px;overflow:hidden}
.phase-row{display:grid;grid-template-columns:36px 1fr;align-items:stretch;border-bottom:1px solid var(--border)}
.phase-row:last-child{border-bottom:none}
.phase-row:hover{background:#f9f8ff}
.phase-n{background:var(--navy);color:var(--gold-light);font-family:'Cormorant Garamond',serif;font-size:.9rem;font-weight:700;display:flex;align-items:center;justify-content:center}
.phase-body{padding:11px 16px}
.phase-title{font-weight:600;font-size:.84rem;color:var(--navy);margin-bottom:3px}
.phase-desc{font-size:.77rem;color:var(--text-mid);line-height:1.5}
.phase-out{display:inline-block;margin-top:5px;font-size:.67rem;font-weight:500;color:var(--gold);background:var(--gold-pale);border-radius:4px;padding:2px 8px;font-family:'DM Mono',monospace}

/* Key numbers */
.kn-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(130px,1fr));gap:10px}
.kn-box{background:var(--cream);border:1px solid var(--border);border-radius:10px;padding:14px 12px;text-align:center}
.kn-num{font-family:'Cormorant Garamond',serif;font-size:1.8rem;font-weight:700;color:var(--navy);line-height:1}
.kn-num sup{font-size:.85rem;color:var(--gold)}
.kn-label{font-size:.67rem;color:var(--text-light);margin-top:5px;line-height:1.4;font-weight:500}

/* Filing cards */
.filing-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px}
.filing-card{background:var(--cream);border:1px solid var(--border);border-radius:10px;padding:14px 16px}
.filing-card:hover{background:#f2f0fa;border-color:var(--navy-soft)}
.filing-card h3{font-weight:600;font-size:.82rem;color:var(--navy);margin-bottom:5px}
.filing-card p{font-size:.75rem;color:var(--text-mid);line-height:1.5}

/* Audit */
.audit-list{display:flex;flex-direction:column;gap:9px}
.audit-item{display:flex;align-items:flex-start;gap:12px;background:var(--cream);border:1px solid var(--border);border-radius:9px;padding:12px 14px}
.audit-dot{width:9px;height:9px;border-radius:50%;flex-shrink:0;margin-top:5px}
.audit-item h4{font-size:.82rem;font-weight:600;color:var(--navy);margin-bottom:2px}
.audit-item p{font-size:.75rem;color:var(--text-mid);line-height:1.4}

/* Compare table */
.cmp-table{width:100%;border-collapse:collapse;font-size:.79rem;border-radius:10px;overflow:hidden}
.cmp-table thead tr{background:var(--navy);color:var(--gold-light)}
.cmp-table th{padding:10px 14px;font-weight:600;text-align:left}
.cmp-table tbody tr{background:var(--white);border-bottom:1px solid var(--border)}
.cmp-table tbody tr:last-child{border-bottom:none}
.cmp-table tbody tr:nth-child(even){background:#f9f8ff}
.cmp-table tbody tr:hover{background:var(--gold-pale)}
.cmp-table td{padding:9px 14px;color:var(--text-mid);vertical-align:top}
.cmp-table td:first-child{font-weight:600;color:var(--navy)}
.badge{display:inline-block;padding:2px 7px;border-radius:4px;font-size:.67rem;font-weight:600}
.badge-us{background:#e8f0fe;color:#1a3a8f}
.badge-ifrs{background:#e8f7ef;color:#1a5c3a}

/* Sources */
.src-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
@media(max-width:560px){.src-grid{grid-template-columns:1fr}}
.src-card{background:var(--white);border:1px solid var(--border);border-radius:9px;overflow:hidden}
.src-card-hd{background:var(--navy-soft);color:var(--white);padding:8px 14px;font-size:.71rem;font-weight:600;letter-spacing:.05em}
.src-items{padding:10px 14px;list-style:none;display:flex;flex-direction:column;gap:5px}
.src-items li{font-size:.75rem;color:var(--text-mid);padding-left:12px;position:relative;line-height:1.4}
.src-items li::before{content:'‚Ä∫';position:absolute;left:0;color:var(--gold);font-weight:700}

/* Info note */
.info-note{padding:10px 14px;border-radius:7px;border-left:3px solid;font-size:.76rem;line-height:1.5;margin-top:10px}
.info-note.gold{background:var(--gold-pale);border-color:var(--gold);color:var(--text-mid)}
.info-note.blue{background:#eef1f9;border-color:var(--navy-soft);color:var(--text-mid)}

/* Takeaway */
.takeaway{background:var(--navy);border-radius:12px;padding:22px 24px;margin-top:28px;position:relative;overflow:hidden}
.takeaway::before{content:'"';position:absolute;top:-20px;left:14px;font-family:'Cormorant Garamond',serif;font-size:9rem;color:rgba(201,168,76,.07);line-height:1;pointer-events:none}
.takeaway h3{font-family:'Cormorant Garamond',serif;color:var(--gold-light);font-size:.95rem;margin-bottom:8px;position:relative}
.takeaway p{color:rgba(255,255,255,.75);font-size:.79rem;line-height:1.65;position:relative}
.takeaway strong{color:var(--gold-light)}


/* ‚îÄ‚îÄ SUMMARY SELECTOR BAR ‚îÄ‚îÄ */
.sum-selector-bar {
  display:flex;align-items:flex-end;justify-content:space-between;
  gap:24px;flex-wrap:wrap;
  margin-bottom:28px;
}
.sum-selector-left{flex:1;min-width:200px}
.sum-selector-right{flex-shrink:0}
.sum-selector-right .chapter-select-wrap{min-width:340px}
@media(max-width:640px){
  .sum-selector-bar{flex-direction:column;align-items:flex-start}
  .sum-selector-right{width:100%}
  .sum-selector-right .chapter-select-wrap{min-width:0;width:100%}
}

/* ‚îÄ‚îÄ SUMMARY EMPTY STATE ‚îÄ‚îÄ */
.sum-empty{
  text-align:center;padding:80px 40px;
  background:var(--white);border:1px solid var(--border);
  border-radius:16px;box-shadow:var(--shadow-sm);
}
.sum-empty-icon{font-size:3rem;margin-bottom:16px;opacity:.3}
.sum-empty h3{font-family:'Cormorant Garamond',serif;color:var(--navy);font-size:1.3rem;opacity:.5;margin-bottom:8px}
.sum-empty p{color:var(--text-light);font-size:.85rem;max-width:400px;margin:0 auto;line-height:1.6}

/* ‚îÄ‚îÄ EXAM PANEL ‚îÄ‚îÄ */
#examPanel {
  display: none;
  position: fixed;
  inset: 0;
  z-index: 1000;
  overflow-y: auto;
  background: #f3f4f6;
}
#examPanel.active { display: block; }
#homePanel.hidden { display: none; }

/* Exam specific styles from original */
.eliminated { opacity: 0.35; text-decoration: line-through; }
.gradient-bg { background: linear-gradient(135deg, #064E3B 0%, #10B981 100%); }
.gradient-bg-2 { background: linear-gradient(135deg, #10B981 0%, #34D399 100%); }
.card-shadow { box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
.option-card { transition: all 0.2s ease; }
.option-card:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
</style>
</head>
<body>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     HOME PANEL
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="homePanel">

<!-- ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ -->
<header>
  <div class="header-brand">
    <div class="brand-badge">CFA</div>
    <div class="brand-text">
      <h1>Practice Hub</h1>
      <p>CFA Level I</p>
    </div>
  </div>
  <nav class="home-tabs" id="homeTabs">
    <button class="home-tab active" onclick="switchHomeTab('practice',this)">üìù Practice</button>
    <button class="home-tab" onclick="switchHomeTab('summaries',this)">üìñ Chapter Summaries</button>
  </nav>
</header>

<!-- ‚îÄ‚îÄ HERO ‚îÄ‚îÄ -->
<section class="hero">
  <div class="hero-bg"></div>
  <div class="hero-grid"></div>
  <div class="hero-inner">
    <div class="hero-text anim-1">
      <div class="hero-eyebrow">
        <div class="hero-eyebrow-dot"></div>
        <span>2026 CFA¬Æ Program ¬∑ Level I</span>
      </div>
      <h2>Master <em>CFA</em><br>Level I</h2>
      <p class="hero-desc">A structured practice environment for CFA Level I candidates. Work through every topic across the full curriculum ‚Äî chapter by chapter or all at once ‚Äî with practice questions, concept summaries, and live score tracking.</p>
      <div class="hero-stats">
        <div>
          <div class="hero-stat-num">680</div>
          <div class="hero-stat-label">Questions Available</div>
        </div>
        <div>
          <div class="hero-stat-num">2</div>
          <div class="hero-stat-label">Topics Available</div>
        </div>
        <div>
          <div class="hero-stat-num">10</div>
          <div class="hero-stat-label">Topic Areas Total</div>
        </div>
        <div>
          <div class="hero-stat-num">100+</div>
          <div class="hero-stat-label">Chapters Mapped</div>
        </div>
      </div>
    </div>
  </div>
</section>
<div class="wave"></div>

<!-- ‚îÄ‚îÄ MAIN ‚îÄ‚îÄ -->
<main>
<!-- PRACTICE TAB -->
<div id="tab-practice" class="tab-pane active main">

  <!-- HOW IT WORKS -->
  <section class="anim-3">
    <div class="section-eyebrow"><div class="eyebrow-line"></div><span>Guide</span></div>
    <h2 class="section-title">How It Works</h2>
    <p class="section-sub">Everything you need to know to get the most out of your CFA practice sessions.</p>
    <div class="how-list">
      <div class="how-item">
        <div class="how-step">1</div>
        <div class="how-icon">üéØ</div>
        <div class="how-item-text"><strong>Choose your scope</strong><p>Pick a topic area, then a specific chapter to drill one reading ‚Äî or select <em>All</em> within a topic to mix questions across it.</p></div>
      </div>
      <div class="how-item">
        <div class="how-step">2</div>
        <div class="how-icon">üîÄ</div>
        <div class="how-item-text"><strong>Optionally shuffle</strong><p>Toggle shuffle to randomise question order and break pattern recognition ‚Äî closer to real exam conditions.</p></div>
      </div>
      <div class="how-item">
        <div class="how-step">3</div>
        <div class="how-icon">üìù</div>
        <div class="how-item-text"><strong>Answer, skip, or mark for review</strong><p>Select an answer and submit. Mark tricky questions to revisit. Navigate freely before finishing.</p></div>
      </div>
      <div class="how-item">
        <div class="how-step">4</div>
        <div class="how-icon">üìä</div>
        <div class="how-item-text"><strong>Get detailed results</strong><p>Full score breakdown by difficulty, chapter, and topic ‚Äî plus explanations for every question after submission.</p></div>
      </div>
      <div class="how-item">
        <div class="how-step">5</div>
        <div class="how-icon">üìñ</div>
        <div class="how-item-text"><strong>Return anytime</strong><p>Click Exit at any point to see your score, answers, and explanations for all questions attempted so far.</p></div>
      </div>
    </div>
  </section>

  <!-- CONFIGURE SESSION -->
  <section class="start-section anim-4">
    <div class="section-eyebrow"><div class="eyebrow-line"></div><span>Begin</span></div>
    <h2 class="section-title">Configure Your Session</h2>
    <p class="section-sub">Select a topic, set your preferences, then launch your practice exam across any part of the CFA Level I curriculum.</p>

    <div class="start-grid">

      <!-- LEFT: Selector card -->
      <div class="selector-card">
        <div class="selector-header">
          <div>
            <h3>Select Topic &amp; Chapter</h3>
            <p>Browse the full CFA Level I curriculum</p>
          </div>
        </div>
        <div class="selector-body">
          <span class="field-label">Topic Area</span>
          <div class="chapter-select-wrap" style="margin-bottom:12px">
            <select id="topicDropdown" onchange="selectTopic(this.value)">
              <option value="" disabled selected>‚Äî Select a topic ‚Äî</option>
            </select>
          </div>

          <span class="field-label">Chapter / Reading</span>
          <div class="chapter-select-wrap">
            <select id="chapterDropdown" onchange="selectChapter(this.value)" disabled>
              <option value="" disabled selected>‚Äî Select a topic first ‚Äî</option>
            </select>
          </div>

          <div class="options-row">
            <div class="toggle-wrap" onclick="toggleShuffle()">
              <div class="toggle" id="shuffleToggle"></div>
              <div>
                <div class="toggle-label">Shuffle Questions</div>
                <div class="toggle-sublabel">Randomize question order</div>
              </div>
            </div>
          </div>

          <a href="#" class="btn-start disabled" id="startBtn">
            <span>Start Practice Exam</span>
            <span class="btn-start-arrow">‚Üí</span>
          </a>
        </div>
      </div>

      <!-- RIGHT: Info aside -->
      <div class="info-aside">
        <div class="info-box">
          <div class="info-box-header">
            <span>üìã</span>
            <h4>Session Preview</h4>
          </div>
          <div class="info-box-body">
            <div class="info-row"><span class="info-row-label">Selected Chapter</span><span class="info-row-val" id="previewChapter">‚Äî</span></div>
            <div class="info-row"><span class="info-row-label">Questions</span><span class="info-row-val green" id="previewCount">‚Äî</span></div>
            <div class="info-row"><span class="info-row-label">Shuffle</span><span class="info-row-val" id="previewShuffle">Off</span></div>
            <div class="info-row"><span class="info-row-label">Est. Time</span><span class="info-row-val" id="previewTime">‚Äî</span></div>
          </div>
        </div>
        <div class="info-box">
          <div class="info-box-header">
            <span>üí°</span>
            <h4>Study Tips</h4>
          </div>
          <div class="info-box-body">
            <ul class="tips-list">
              <li>CFA questions often hinge on "most likely" or "least likely" ‚Äî read carefully.</li>
              <li>Mark tricky questions to revisit them before finishing.</li>
              <li>After submitting, review every explanation ‚Äî not just wrong answers.</li>
              <li>Use the difficulty badges to spot your weak areas in the results screen.</li>
            </ul>
          </div>
        </div>
      </div>

    </div>
  </section>

</div><!-- /#tab-practice -->

<!-- SUMMARIES TAB -->
<div id="tab-summaries" class="tab-pane">
<div class="summary-wrap">

  <!-- Chapter selector -->
  <div class="sum-selector-bar">
    <div class="sum-selector-left">
      <div class="section-eyebrow"><div class="eyebrow-line"></div><span>Chapter Summaries</span></div>
      <h2 class="section-title" style="margin-bottom:0">Select a Reading</h2>
    </div>
    <div class="sum-selector-right">
      <div class="chapter-select-wrap" style="margin-bottom:10px">
        <select id="summaryTopicDropdown" onchange="selectSummaryTopic(this.value)">
          <option value="" disabled selected>‚Äî Select a topic ‚Äî</option>
        </select>
      </div>
      <div class="chapter-select-wrap">
        <select id="summaryChapterDropdown" onchange="loadSummary(this.value)" disabled>
          <option value="" disabled selected>‚Äî Select a topic first ‚Äî</option>
        </select>
      </div>
    </div>
  </div>

  <!-- Empty state (shown by default) -->
  <div id="sum-empty" class="sum-empty">
    <div class="sum-empty-icon">üìñ</div>
    <h3>Select a reading above to view its summary</h3>
    <p>Concise notes covering learning outcomes, key frameworks, thresholds, and comparison tables ‚Äî ready to read before or after your practice session.</p>
  </div>

  <!-- Chapter content (hidden until selection) -->
  <div id="sum-content" style="display:none">

  <!-- ‚îÄ‚îÄ FSA-1 SUMMARY ‚îÄ‚îÄ -->
  <div id="sum-fsa-1" class="sum-chapter" style="display:none">
  <div class="sum-hero">
    <div class="sum-hero-label">2026 CFA¬Æ Program ¬∑ Level I ¬∑ FSA Reading 1</div>
    <h1>Introduction to <em>Financial Statement Analysis</em></h1>
    <div class="sum-hero-tags">
      <span class="sum-hero-tag">5 Learning Outcomes</span>
      <span class="sum-hero-tag">6-Phase Framework</span>
      <span class="sum-hero-tag">IFRS vs US GAAP</span>
      <span class="sum-hero-tag">Audit Opinions</span>
      <span class="sum-hero-tag">SEC Filings</span>
      <span class="sum-hero-tag">Information Sources</span>
    </div>
  </div>

  <div class="sum-body">

    <div class="s-header">
      <div class="s-icon">üéØ</div>
      <h2><span>Learning Outcomes</span>What You Need to Master</h2>
    </div>
    <div class="lo-list">
      <div class="lo-item"><span class="lo-pill">LO 1</span><span class="lo-text">Describe the steps in the <strong>financial statement analysis framework</strong></span></div>
      <div class="lo-item"><span class="lo-pill">LO 2</span><span class="lo-text">Describe the <strong>roles</strong> of financial statement analysis</span></div>
      <div class="lo-item"><span class="lo-pill">LO 3</span><span class="lo-text">Describe the importance of <strong>regulatory filings, financial notes, management commentary, and audit reports</strong></span></div>
      <div class="lo-item"><span class="lo-pill">LO 4</span><span class="lo-text">Describe implications of <strong>alternative financial reporting systems</strong> (IFRS vs US GAAP) and monitoring standard developments</span></div>
      <div class="lo-item"><span class="lo-pill">LO 5</span><span class="lo-text">Describe <strong>other information sources</strong> analysts use beyond annual and interim reports</span></div>
    </div>

    <hr class="s-divider">

    <div class="s-header">
      <div class="s-icon">üîÑ</div>
      <h2><span>The Framework</span>6-Phase Financial Statement Analysis Process</h2>
    </div>
    <div class="phases-table">
      <div class="phase-row"><div class="phase-n">1</div><div class="phase-body"><div class="phase-title">Articulate Purpose &amp; Context</div><div class="phase-desc">Define why the analysis is being done. Who is the audience? What decisions will it support? Resist calculating ratios before understanding what's relevant.</div><span class="phase-out">‚Üí Purpose statement + specific questions to answer</span></div></div>
      <div class="phase-row"><div class="phase-n">2</div><div class="phase-body"><div class="phase-title">Collect Data</div><div class="phase-desc">Gather financial statements, industry and economic data, management discussions. Top-down: macroeconomic ‚Üí industry ‚Üí company. Site visits and management meetings are valid data sources.</div><span class="phase-out">‚Üí Financial data in usable form</span></div></div>
      <div class="phase-row"><div class="phase-n">3</div><div class="phase-body"><div class="phase-title">Process Data</div><div class="phase-desc">Compute ratios, growth rates, common-size statements. Adjust financial statements for comparability. Apply statistical analyses, regressions, and sensitivity analyses.</div><span class="phase-out">‚Üí Adjusted statements, ratios, graphs</span></div></div>
      <div class="phase-row"><div class="phase-n">4</div><div class="phase-body"><div class="phase-title">Analyze / Interpret Data</div><div class="phase-desc">Numbers alone are never the answer. Interpret results in context to support a conclusion ‚Äî buy/sell ratings, credit decisions, valuations.</div><span class="phase-out">‚Üí Analytical results, forecasts, valuations</span></div></div>
      <div class="phase-row"><div class="phase-n">5</div><div class="phase-body"><div class="phase-title">Communicate Conclusions &amp; Recommendations</div><div class="phase-desc">Report in the appropriate format for the audience. Equity reports include: investment conclusion, industry overview, financial model, valuation, and risks. CFA Standard V(B): distinguish opinions from facts.</div><span class="phase-out">‚Üí Analytical report + recommendation</span></div></div>
      <div class="phase-row"><div class="phase-n">6</div><div class="phase-body"><div class="phase-title">Follow-Up</div><div class="phase-desc">Periodically repeat prior steps as new information arrives. Update forecasts and recommendations. Even rejected investments may require monitoring if conditions change.</div><span class="phase-out">‚Üí Actual vs. expected comparison, revised forecasts</span></div></div>
    </div>

    <hr class="s-divider">

    <div class="s-header">
      <div class="s-icon">üî¢</div>
      <h2><span>Key Numbers</span>Critical Thresholds to Memorise</h2>
    </div>
    <div class="kn-grid">
      <div class="kn-box"><div class="kn-num">95<sup>%</sup></div><div class="kn-label">of world's financial markets covered by IOSCO</div></div>
      <div class="kn-box"><div class="kn-num">115<sup>+</sup></div><div class="kn-label">jurisdictions in IOSCO membership</div></div>
      <div class="kn-box"><div class="kn-num">75<sup>%</sup></div><div class="kn-label">of IOSCO ordinary members from emerging markets</div></div>
      <div class="kn-box"><div class="kn-num">10<sup>%</sup></div><div class="kn-label">threshold for mandatory segment disclosure</div></div>
      <div class="kn-box"><div class="kn-num">75<sup>%</sup></div><div class="kn-label">min. external revenue by reportable segments</div></div>
      <div class="kn-box"><div class="kn-num">10<sup>%</sup></div><div class="kn-label">single-customer concentration trigger</div></div>
    </div>

    <hr class="s-divider">

    <div class="s-header">
      <div class="s-icon">üìã</div>
      <h2><span>SEC Filings</span>Key Forms Analysts Use</h2>
    </div>
    <div class="filing-grid">
      <div class="filing-card"><h3>10-K / 20-F / 40-F</h3><p>Annual reports. <strong>10-K</strong> for US companies, <strong>20-F</strong> for non-US registrants, <strong>40-F</strong> for certain Canadian registrants. Contains audited financials, MD&amp;A, and risk factors.</p></div>
      <div class="filing-card"><h3>10-Q / 6-K</h3><p>Interim reports. <strong>10-Q</strong> filed quarterly by US companies (unaudited). <strong>6-K</strong> filed semi-annually by many non-US companies.</p></div>
      <div class="filing-card"><h3>Form 8-K</h3><p>Current report for material events ‚Äî acquisitions, management changes, accounting changes, Reg FD disclosures. Must be filed promptly.</p></div>
      <div class="filing-card"><h3>DEF-14A (Proxy)</h3><p>Executive compensation, security ownership by management, director biographies, and shareholder vote items.</p></div>
      <div class="filing-card"><h3>Forms 3, 4, 5 &amp; 144</h3><p>Insider ownership filings. Track beneficial ownership by directors, officers, and &gt;10% holders. Form 144 covers proposed sale of restricted securities.</p></div>
      <div class="filing-card"><h3>Registration Statement</h3><p>Filed for new securities offerings. Includes risk factors, audited financial statements, use of proceeds, and capital structure.</p></div>
    </div>

    <hr class="s-divider">

    <div class="s-header">
      <div class="s-icon">‚úÖ</div>
      <h2><span>Audit Reports</span>Four Types of Opinion</h2>
    </div>
    <div class="audit-list">
      <div class="audit-item"><div class="audit-dot" style="background:#1a7a4a"></div><div><h4>Unqualified (Clean / Unmodified) ‚Äî Preferred ‚úì</h4><p>Financial statements are fairly presented in accordance with applicable accounting standards. Also called "true and fair view" internationally. This is the opinion analysts want to see.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b98a1c"></div><div><h4>Qualified ‚Äî Some Exception or Scope Limitation</h4><p>Fairly presented <em>except</em> for a specific issue. Exception described in additional explanatory paragraphs. Analyst must evaluate the importance of the exception.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b91c1c"></div><div><h4>Adverse ‚Äî Material Departure from Standards ‚ö†</h4><p>Financial statements materially depart from accounting standards and are <em>not</em> fairly presented. The most serious opinion ‚Äî a major red flag.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#6b6b8a"></div><div><h4>Disclaimer ‚Äî Unable to Issue an Opinion</h4><p>Due to a scope limitation or other reason, the auditor is unable to express an opinion at all.</p></div></div>
    </div>
    <div class="info-note gold">Audits use <em>sampling techniques</em> and statements involve <em>estimates</em> ‚Äî auditors can only provide <strong>reasonable assurance</strong>, not absolute assurance. Always apply healthy scepticism even with a clean opinion.</div>

    <hr class="s-divider">

    <div class="s-header">
      <div class="s-icon">‚öñÔ∏è</div>
      <h2><span>Standards Comparison</span>Key IFRS vs US GAAP Differences</h2>
    </div>
    <table class="cmp-table">
      <thead><tr><th>Topic</th><th><span class="badge badge-us">US GAAP (FASB)</span></th><th><span class="badge badge-ifrs">IFRS (IASB)</span></th></tr></thead>
      <tbody>
        <tr><td>Approach</td><td>Rules-based</td><td>Principles-based</td></tr>
        <tr><td>Inventory Methods</td><td>FIFO, LIFO, Weighted Average</td><td>FIFO, Weighted Average (LIFO <em>prohibited</em>)</td></tr>
        <tr><td>Inventory Write-Down Reversal</td><td>Prohibited</td><td>Permitted if conditions met</td></tr>
        <tr><td>Development Costs</td><td>Expensed as incurred</td><td>Capitalised if conditions satisfied</td></tr>
        <tr><td>Interest Paid (Cash Flow)</td><td>Operating Activities only</td><td>Financing <em>or</em> Operating Activities</td></tr>
        <tr><td>Standard Setter</td><td>FASB</td><td>IASB</td></tr>
      </tbody>
    </table>
    <div class="info-note blue"><strong>Convergence note:</strong> Reconciliation disclosures between IFRS and US GAAP are <strong>not required</strong>. New standards (revenue, leasing, credit losses) have largely converged.</div>

    <hr class="s-divider">

    <div class="s-header">
      <div class="s-icon">üîç</div>
      <h2><span>Information Sources</span>Beyond Annual Reports</h2>
    </div>
    <div class="src-grid">
      <div class="src-card"><div class="src-card-hd">üì¢ Issuer Sources (Non-Filing)</div><ul class="src-items"><li>Earnings calls (quarterly webcasts)</li><li>Investor day / analyst day events</li><li>Press releases</li><li>Speaking with management / IR personnel</li><li>Company site visits &amp; product experience</li></ul></div>
      <div class="src-card"><div class="src-card-hd">üåê Public Third-Party Sources</div><ul class="src-items"><li>Free industry whitepapers &amp; analyst reports</li><li>Government economic/industry indicators</li><li>General &amp; industry-specific news outlets</li><li>Social media (customer sentiment gauge)</li></ul></div>
      <div class="src-card"><div class="src-card-hd">üíº Proprietary Third-Party Sources</div><ul class="src-items"><li>Sell-side analyst &amp; credit agency reports</li><li>Bloomberg, FactSet, Wind data platforms</li><li>Industry consultancies (Rystad, Gartner, IQVIA)</li></ul></div>
      <div class="src-card"><div class="src-card-hd">üî¨ Proprietary Primary Research</div><ul class="src-items"><li>Surveys commissioned by the analyst</li><li>Direct product evaluations &amp; comparisons</li><li>Expert conversations &amp; channel checks</li></ul></div>
    </div>

    <div class="takeaway">
      <h3>Core Analyst Mindset</h3>
      <p>Financial statement analysis is not about verifying numbers ‚Äî it's about forming <strong>expectations of future performance</strong> to support investment, credit, and other economic decisions. Combine quantitative outputs with <strong>qualitative interpretation</strong>, maintain <strong>healthy scepticism</strong> toward even audited figures, and continuously monitor <strong>changes in accounting standards</strong> that could affect comparability.</p>
    </div>

  </div><!-- /.sum-body -->
  </div><!-- /#sum-fsa-1 -->


  <!-- ‚îÄ‚îÄ QM-1 SUMMARY: RATES AND RETURNS ‚îÄ‚îÄ -->
  <div id="sum-qm-1" class="sum-chapter" style="display:none">
  <div class="sum-hero">
    <div class="sum-hero-label">2026 CFA¬Æ Program ¬∑ Level I ¬∑ QM Reading 1</div>
    <h1>Rates and <em>Returns</em></h1>
    <div class="sum-hero-tags">
      <span class="sum-hero-tag">5 Learning Outcomes</span>
      <span class="sum-hero-tag">Interest Rate Components</span>
      <span class="sum-hero-tag">Return Measures</span>
      <span class="sum-hero-tag">MWR vs TWR</span>
      <span class="sum-hero-tag">Annualised Returns</span>
      <span class="sum-hero-tag">Leveraged Return</span>
    </div>
  </div>

  <div class="sum-body">

    <!-- Learning Outcomes -->
    <div class="s-header">
      <div class="s-icon">üéØ</div>
      <h2><span>Learning Outcomes</span>What You Need to Master</h2>
    </div>
    <div class="lo-list">
      <div class="lo-item"><span class="lo-pill">LO 1</span><span class="lo-text">Interpret interest rates as <strong>required rates of return, discount rates, or opportunity costs</strong> and explain an interest rate as the sum of a real risk-free rate and risk premiums</span></div>
      <div class="lo-item"><span class="lo-pill">LO 2</span><span class="lo-text">Calculate and interpret <strong>different approaches to return measurement</strong> over time and describe their appropriate uses (arithmetic, geometric, harmonic, trimmed, winsorised means)</span></div>
      <div class="lo-item"><span class="lo-pill">LO 3</span><span class="lo-text">Compare the <strong>money-weighted and time-weighted rates of return</strong> and evaluate portfolio performance based on these measures</span></div>
      <div class="lo-item"><span class="lo-pill">LO 4</span><span class="lo-text">Calculate and interpret <strong>annualised return measures and continuously compounded returns</strong>, and describe their appropriate uses</span></div>
      <div class="lo-item"><span class="lo-pill">LO 5</span><span class="lo-text">Calculate and interpret <strong>major return measures</strong> (gross/net, pre-tax/after-tax, real, leveraged) and describe their appropriate uses</span></div>
    </div>

    <hr class="s-divider">

    <!-- Interest Rate Interpretations -->
    <div class="s-header">
      <div class="s-icon">üìê</div>
      <h2><span>Section 1 ‚Äî LO 1</span>Interest Rates: Three Interpretations</h2>
    </div>
    <div class="phases-table">
      <div class="phase-row"><div class="phase-n">1</div><div class="phase-body"><div class="phase-title">Required Rate of Return</div><div class="phase-desc">The minimum return an investor must receive to accept an investment. Compensates for the time value of money and all relevant risks.</div><span class="phase-out">‚Üí Threshold below which an investor rejects the investment</span></div></div>
      <div class="phase-row"><div class="phase-n">2</div><div class="phase-body"><div class="phase-title">Discount Rate</div><div class="phase-desc">The rate used to find the present value of a future cash flow. A 5.26% discount rate makes USD 10,000 in one year equivalent to USD 9,500 today.</div><span class="phase-out">‚Üí "Interest rate" and "discount rate" are used almost interchangeably</span></div></div>
      <div class="phase-row"><div class="phase-n">3</div><div class="phase-body"><div class="phase-title">Opportunity Cost</div><div class="phase-desc">The value forgone by choosing one course of action over another. Spending USD 9,500 today forgoes earning 5.26% by saving instead.</div><span class="phase-out">‚Üí Cost of not investing (current consumption)</span></div></div>
    </div>

    <hr class="s-divider">

    <!-- Interest Rate Components -->
    <div class="s-header">
      <div class="s-icon">üî¢</div>
      <h2><span>Section 1 ‚Äî LO 1</span>Components of Interest Rates</h2>
    </div>
    <div class="info-note gold" style="margin-bottom:16px"><strong>The Formula:</strong> r = Real risk-free rate + Inflation premium + Default risk premium + Liquidity premium + Maturity premium</div>
    <div class="audit-list">
      <div class="audit-item"><div class="audit-dot" style="background:#1a3a8f"></div><div><h4>Real Risk-Free Rate</h4><p>Single-period rate for a completely risk-free security with no expected inflation. Reflects individuals' time preferences for current vs. future consumption. Varies continuously with economic conditions.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b98a1c"></div><div><h4>Inflation Premium</h4><p>Compensates for the expected average inflation rate over the maturity of the debt. Inflation erodes purchasing power. Nominal risk-free rate ‚âà Real risk-free rate + Inflation premium.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b91c1c"></div><div><h4>Default Risk Premium</h4><p>Compensates investors for the possibility that the borrower fails to make promised payments. Higher for lower-quality issuers; zero for government T-bills (assumed risk-free).</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#1a7a4a"></div><div><h4>Liquidity Premium</h4><p>Compensates for the risk of loss if the investment must be sold quickly at below fair value. US T-bills have no liquidity premium; thinly traded bonds of small issuers carry significant liquidity premiums.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#6b6b8a"></div><div><h4>Maturity Premium</h4><p>Compensates for increased sensitivity of bond price to interest rate changes as maturity extends. Longer-maturity government bonds typically carry a positive maturity premium over short-term bonds.</p></div></div>
    </div>
    <div class="info-note blue" style="margin-top:12px"><strong>Key relationship:</strong> (1 + nominal risk-free rate) = (1 + real risk-free rate) √ó (1 + inflation premium). In practice approximated as: Nominal ‚âà Real + Inflation premium.</div>

    <hr class="s-divider">

    <!-- Return Measures Overview -->
    <div class="s-header">
      <div class="s-icon">üìä</div>
      <h2><span>Section 2 ‚Äî LO 2</span>Return Measurement: Key Formulas</h2>
    </div>
    <div class="kn-grid" style="margin-bottom:16px">
      <div class="kn-box"><div class="kn-num" style="font-size:1.1rem">HPR</div><div class="kn-label">R = (P‚ÇÅ ‚àí P‚ÇÄ + I‚ÇÅ) / P‚ÇÄ<br>Single period, one holding period</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:1.1rem">Arith.</div><div class="kn-label">RÃÑ = (1/T) Œ£ R·µ¢‚Çú<br>Best for single-period estimates</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:1.1rem">Geo.</div><div class="kn-label">RÃÑG = [‚àè(1+R‚Çú)]^(1/T) ‚àí 1<br>Compound rate; multi-period</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:1.1rem">Harm.</div><div class="kn-label">XÃÑH = n / Œ£(1/X·µ¢)<br>Averaging rates/ratios (e.g. P/E, cost avg.)</div></div>
    </div>

    <table class="cmp-table">
      <thead><tr><th>Measure</th><th>Best Used For</th><th>Key Property</th></tr></thead>
      <tbody>
        <tr><td>Holding Period Return</td><td>Single specified period (any length)</td><td>Includes capital gain + income yield</td></tr>
        <tr><td>Arithmetic Mean</td><td>Average single-period performance; forward-looking estimates</td><td>Always ‚â• geometric mean; upward biased for multi-period</td></tr>
        <tr><td>Geometric Mean</td><td>Compound growth over multiple periods; historical performance</td><td>Always ‚â§ arithmetic mean; equals actual terminal wealth rate</td></tr>
        <tr><td>Harmonic Mean</td><td>Averaging P/E ratios; cost-averaging strategies</td><td>Always ‚â§ geometric mean; reduces outlier influence</td></tr>
        <tr><td>Trimmed Mean</td><td>Datasets with extreme outliers to exclude</td><td>Removes defined % of highest and lowest values before averaging</td></tr>
        <tr><td>Winsorised Mean</td><td>Datasets with extreme outliers to include but limit</td><td>Replaces extremes with nearest non-extreme values; then averages</td></tr>
      </tbody>
    </table>

    <div class="info-note gold" style="margin-top:12px">
      <strong>Key inequality:</strong> Harmonic mean ‚â§ Geometric mean ‚â§ Arithmetic mean (strict inequality unless all values are equal). Also: Arithmetic mean √ó Harmonic mean = (Geometric mean)¬≤.
    </div>

    <hr class="s-divider">

    <!-- Decision tree for mean selection -->
    <div class="s-header">
      <div class="s-icon">üîÄ</div>
      <h2><span>Section 2 ‚Äî LO 2</span>Which Mean to Use? Decision Guide</h2>
    </div>
    <div class="phases-table">
      <div class="phase-row"><div class="phase-n" style="font-size:.7rem;padding:4px">Q1</div><div class="phase-body"><div class="phase-title">Is there compounding involved?</div><div class="phase-desc"><strong>Yes ‚Üí</strong> Use Geometric Mean. It captures how returns compound over time and reflects the actual terminal value of an investment.</div></div></div>
      <div class="phase-row"><div class="phase-n" style="font-size:.7rem;padding:4px">Q2</div><div class="phase-body"><div class="phase-title">Are you averaging rates or ratios (e.g. P/E)?</div><div class="phase-desc"><strong>Yes ‚Üí</strong> Use Harmonic Mean. Particularly appropriate for cost-averaging strategies where a fixed amount is invested at varying prices.</div></div></div>
      <div class="phase-row"><div class="phase-n" style="font-size:.7rem;padding:4px">Q3</div><div class="phase-body"><div class="phase-title">Are there extreme outliers you want to include but limit?</div><div class="phase-desc"><strong>Yes ‚Üí</strong> Use Winsorised or Trimmed Mean to reduce the influence of outliers. Trimmed removes them; winsorised replaces them with boundary values.</div></div></div>
      <div class="phase-row"><div class="phase-n" style="font-size:.7rem;padding:4px">Q4</div><div class="phase-body"><div class="phase-title">Single-period, symmetric data, no special concerns?</div><div class="phase-desc"><strong>Yes ‚Üí</strong> Use Arithmetic Mean. Simple, has well-known statistical properties, and is the best predictor of next-period single-period returns.</div></div></div>
    </div>

    <hr class="s-divider">

    <!-- Money-Weighted vs Time-Weighted -->
    <div class="s-header">
      <div class="s-icon">‚öñÔ∏è</div>
      <h2><span>Section 3 ‚Äî LO 3</span>Money-Weighted vs Time-Weighted Return</h2>
    </div>
    <table class="cmp-table">
      <thead><tr><th>Feature</th><th><span class="badge badge-us">Money-Weighted Return (MWR)</span></th><th><span class="badge badge-ifrs">Time-Weighted Return (TWR)</span></th></tr></thead>
      <tbody>
        <tr><td>Definition</td><td>IRR of all cash flows (outflows = investments, inflows = withdrawals + ending value)</td><td>Geometric mean of sub-period holding period returns</td></tr>
        <tr><td>Sensitivity to cash flow timing</td><td>Yes ‚Äî highly sensitive to when money is invested/withdrawn</td><td>No ‚Äî eliminates the effect of cash flow timing</td></tr>
        <tr><td>Preferred for</td><td>Investor's actual return on capital invested</td><td>Evaluating portfolio manager skill (CFA Institute standard)</td></tr>
        <tr><td>Why managers prefer TWR</td><td>N/A</td><td>Removes effects of client-driven cash flows outside manager's control</td></tr>
        <tr><td>Calculation method</td><td>Solve for IRR: Œ£ CF‚Çú/(1+IRR)·µó = 0</td><td>Step 1: Value portfolio before each cash flow. Step 2: Compute HPR per sub-period. Step 3: Geometrically link HPRs</td></tr>
        <tr><td>When MWR &gt; TWR</td><td colspan="2">More capital was invested during high-return periods (favourable timing)</td></tr>
        <tr><td>When MWR &lt; TWR</td><td colspan="2">More capital was invested during low-return periods (unfavourable timing, e.g. client adds funds before a market decline)</td></tr>
      </tbody>
    </table>

    <div class="info-note blue" style="margin-top:12px">
      <strong>Practical note:</strong> Two investors in the same fund can have different MWRs because they invested different amounts at different times. The TWR is the same for all investors regardless of when they invested.
    </div>

    <hr class="s-divider">

    <!-- Annualised Returns -->
    <div class="s-header">
      <div class="s-icon">üìÖ</div>
      <h2><span>Section 4 ‚Äî LO 4</span>Annualised &amp; Continuously Compounded Returns</h2>
    </div>
    <div class="kn-grid" style="margin-bottom:16px">
      <div class="kn-box"><div class="kn-num" style="font-size:1rem">Daily</div><div class="kn-label">c = 365<br>R_annual = (1+R_daily)¬≥‚Å∂‚Åµ ‚àí 1</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:1rem">Weekly</div><div class="kn-label">c = 52<br>R_annual = (1+R_weekly)‚Åµ¬≤ ‚àí 1</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:1rem">Monthly</div><div class="kn-label">c = 12<br>R_annual = (1+R_monthly)¬π¬≤ ‚àí 1</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:1rem">Quarterly</div><div class="kn-label">c = 4<br>R_annual = (1+R_quarterly)‚Å¥ ‚àí 1</div></div>
    </div>

    <div class="audit-list">
      <div class="audit-item"><div class="audit-dot" style="background:#1a3a8f"></div><div><h4>General Annualisation Formula</h4><p>R_annual = (1 + R_period)^c ‚àí 1, where c = number of compounding periods per year. For holding periods &gt;1 year (e.g. 18 months): c = 2/3, so R_annual = (1 + R_18m)^(2/3) ‚àí 1.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b91c1c"></div><div><h4>Key Limitation of Annualisation</h4><p>Implicit assumption that the sub-period return can be repeated for the entire year ‚Äî often unrealistic for very short periods. A 5% weekly return annualises to 1,164% ‚Äî meaningless as a forward-looking estimate.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#1a7a4a"></div><div><h4>Continuously Compounded Return</h4><p>r_t,t+1 = ln(P_{t+1}/P_t) = ln(1 + R_{t,t+1}). Always less than the equivalent holding period return. Key property: multi-period continuously compounded returns ADD across sub-periods (vs. HPRs which multiply).</p></div></div>
    </div>
    <div class="info-note gold" style="margin-top:12px">
      <strong>Continuously compounded formula:</strong> r‚ÇÄ,T = ln(P_T / P‚ÇÄ). Multi-period: r‚ÇÄ,T = r_{T-1,T} + r_{T-2,T-1} + ‚Ä¶ + r‚ÇÄ,‚ÇÅ (additive property ‚Äî very useful in models).
    </div>

    <hr class="s-divider">

    <!-- Major Return Measures -->
    <div class="s-header">
      <div class="s-icon">üíº</div>
      <h2><span>Section 5 ‚Äî LO 5</span>Special Return Measures</h2>
    </div>
    <div class="filing-grid">
      <div class="filing-card"><h3>üìà Gross Return</h3><p>Return after deducting <em>trading costs only</em>. Excludes management fees, custody fees, taxes ‚Äî as these vary by investor. Used to evaluate and <strong>compare manager skill</strong> on a like-for-like basis.</p></div>
      <div class="filing-card"><h3>üìâ Net Return</h3><p>Gross return minus all managerial and administrative expenses. Represents what the investor <strong>actually earns</strong>. Small funds disadvantaged vs. large funds (fixed costs spread over smaller AUM).</p></div>
      <div class="filing-card"><h3>üèõÔ∏è Pre-Tax Nominal</h3><p>The default return measure ‚Äî no adjustment for taxes or inflation. All return measures are <strong>pre-tax nominal unless otherwise stated</strong>.</p></div>
      <div class="filing-card"><h3>üßæ After-Tax Nominal</h3><p>Total return minus tax on dividends, interest, and realised gains. Tax treatment varies: long-term capital gains often preferential; interest taxed as ordinary income. Managers minimise taxes via security selection and low turnover.</p></div>
      <div class="filing-card"><h3>üìä Real Return</h3><p>(1 + real return) = (1 + nominal return) / (1 + inflation). Useful for comparing returns <strong>across time periods or across countries</strong> with different inflation rates. After-tax real return = what the investor truly receives.</p></div>
      <div class="filing-card"><h3>üîß Leveraged Return</h3><p>R_L = R_P + (V_B / V_E) √ó (R_P ‚àí r_D). Leverage amplifies <strong>both gains and losses</strong>. Increases return only if R_P &gt; r_D (portfolio return &gt; borrowing cost). Created via borrowing or futures contracts.</p></div>
    </div>

    <hr class="s-divider">

    <!-- Key Numbers to Memorise -->
    <div class="s-header">
      <div class="s-icon">üî¢</div>
      <h2><span>Critical Numbers</span>Exam-Tested Thresholds &amp; Examples</h2>
    </div>
    <div class="kn-grid">
      <div class="kn-box"><div class="kn-num">5.26<sup>%</sup></div><div class="kn-label">USD 500 / USD 9,500 ‚Äî canonical interest rate example from the reading</div></div>
      <div class="kn-box"><div class="kn-num">‚àí5<sup>%</sup></div><div class="kn-label">Geometric mean of ‚àí50%, +35%, +27% ‚Äî arithmetic mean is +4% (biased upward)</div></div>
      <div class="kn-box"><div class="kn-num">10.76<sup>%</sup></div><div class="kn-label">TWR for dividend-stock example (vs. MWR of 9.39%) ‚Äî TWR &gt; MWR when more invested in worse year</div></div>
      <div class="kn-box"><div class="kn-num">ln(x)</div><div class="kn-label">Continuously compounded return = ln(P‚ÇÅ/P‚ÇÄ); always smaller than the equivalent HPR</div></div>
    </div>

    <hr class="s-divider">

    <!-- Comparison: IFRS Analogue - Interest Calculations -->
    <div class="s-header">
      <div class="s-icon">‚ö°</div>
      <h2><span>Common Pitfalls</span>Exam Traps to Avoid</h2>
    </div>
    <div class="src-grid">
      <div class="src-card"><div class="src-card-hd">‚ùå Arithmetic vs Geometric</div><ul class="src-items"><li>Arithmetic mean is always ‚â• geometric mean (except when all returns are equal)</li><li>Arithmetic is for forward-looking single-period estimates; Geometric is for multi-period historical rates</li><li>The more variable the returns, the greater the gap between arithmetic and geometric means</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå MWR vs TWR Direction</div><ul class="src-items"><li>If more capital is invested when returns are poor ‚Üí MWR &lt; TWR</li><li>If more capital is invested when returns are good ‚Üí MWR &gt; TWR</li><li>TWR is the CFA Institute-preferred measure for manager evaluation</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Gross vs Net Return</div><ul class="src-items"><li>Trading expenses ARE deducted from gross return (they directly affect manager returns)</li><li>Management fees, custody fees, and taxes are NOT in gross return</li><li>Net return = gross return ‚àí management &amp; administrative expenses</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Leverage Direction</div><ul class="src-items"><li>Leverage amplifies BOTH gains AND losses (not just gains)</li><li>If R_P &lt; r_D (portfolio return &lt; borrowing cost), leverage decreases the return</li><li>If 50% is borrowed, gross return doubles ‚Äî but interest cost must still be subtracted to get net</li></ul></div>
    </div>

    <div class="takeaway">
      <h3>Core Mindset for Rates &amp; Returns</h3>
      <p>Every return measure has a specific purpose. <strong>Geometric mean</strong> tells you what you actually earned by compounding. <strong>Arithmetic mean</strong> gives the best single-period forward estimate. <strong>Time-weighted return</strong> reveals manager skill free of client cash-flow noise. <strong>Real after-tax return</strong> is what the investor truly keeps. Always identify the purpose before choosing a measure ‚Äî the CFA exam will test whether you know which metric is appropriate, not just whether you can calculate it.</p>
    </div>

  </div><!-- /.sum-body -->
  </div><!-- /#sum-qm-1 -->


  <!-- ‚îÄ‚îÄ QM-2 SUMMARY: TIME VALUE OF MONEY IN FINANCE ‚îÄ‚îÄ -->
  <div id="sum-qm-2" class="sum-chapter" style="display:none">
  <div class="sum-hero">
    <div class="sum-hero-label">2026 CFA¬Æ Program ¬∑ Level I ¬∑ QM Reading 2</div>
    <h1>Time Value of Money <em>in Finance</em></h1>
    <div class="sum-hero-tags">
      <span class="sum-hero-tag">3 Learning Outcomes</span>
      <span class="sum-hero-tag">Bond Pricing</span>
      <span class="sum-hero-tag">Equity Valuation</span>
      <span class="sum-hero-tag">Implied Return &amp; Growth</span>
      <span class="sum-hero-tag">Cash Flow Additivity</span>
      <span class="sum-hero-tag">No-Arbitrage Pricing</span>
    </div>
  </div>

  <div class="sum-body">

    <!-- Learning Outcomes -->
    <div class="s-header">
      <div class="s-icon">üéØ</div>
      <h2><span>Learning Outcomes</span>What You Need to Master</h2>
    </div>
    <div class="lo-list">
      <div class="lo-item"><span class="lo-pill">LO 1</span><span class="lo-text">Calculate and interpret the <strong>present value (PV) of fixed-income and equity instruments</strong> based on expected future cash flows</span></div>
      <div class="lo-item"><span class="lo-pill">LO 2</span><span class="lo-text">Calculate and interpret the <strong>implied return of fixed-income instruments and required return and implied growth of equity instruments</strong> given PV and cash flows</span></div>
      <div class="lo-item"><span class="lo-pill">LO 3</span><span class="lo-text">Explain the <strong>cash flow additivity principle</strong>, its importance for the no-arbitrage condition, and its use in calculating implied forward interest rates, forward exchange rates, and option values</span></div>
    </div>

    <hr class="s-divider">

    <!-- Core TVM Formulas -->
    <div class="s-header">
      <div class="s-icon">üìê</div>
      <h2><span>Foundations</span>Core TVM Relationships</h2>
    </div>
    <div class="kn-grid" style="margin-bottom:16px">
      <div class="kn-box"><div class="kn-num" style="font-size:.95rem">FV = PV(1+r)·µó</div><div class="kn-label">Discrete compounding ‚Äî standard formula</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:.95rem">FV = PVe ≥·µó</div><div class="kn-label">Continuous compounding (t ‚Üí ‚àû periods)</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:.95rem">PV = FV¬∑(1+r)‚Åª·µó</div><div class="kn-label">Present value: discount FV back t periods</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:.95rem">PV = FV¬∑e‚Åª ≥·µó</div><div class="kn-label">Continuous discounting equivalent</div></div>
    </div>
    <div class="info-note blue">The discount rate <strong>r</strong> is always a <em>per-period</em> rate. For semiannual bonds: use r/2 as the periodic rate and 2N as the number of periods. Mixing annual rates with non-annual periods is a common exam error.</div>

    <hr class="s-divider">

    <!-- Fixed-Income Pricing: Three patterns -->
    <div class="s-header">
      <div class="s-icon">üè¶</div>
      <h2><span>Section 1 ‚Äî LO 1</span>Fixed-Income Pricing: Three Cash Flow Patterns</h2>
    </div>
    <div class="phases-table">
      <div class="phase-row">
        <div class="phase-n">1</div>
        <div class="phase-body">
          <div class="phase-title">Discount (Zero-Coupon) Bond</div>
          <div class="phase-desc">Investor pays PV today; receives a single principal (FV) at maturity. No intermediate cash flows. The spread (FV ‚àí PV) is the total interest earned.</div>
          <span class="phase-out">‚Üí PV = FV‚Çú / (1 + r)·µó &nbsp;|&nbsp; Excel: PV(r, t, 0, FV, 0)</span>
        </div>
      </div>
      <div class="phase-row">
        <div class="phase-n">2</div>
        <div class="phase-body">
          <div class="phase-title">Coupon Bond (Periodic Interest + Principal at Maturity)</div>
          <div class="phase-desc">Investor receives PMT at each period and FV at maturity. YTM is the single discount rate applied to all cash flows. When coupon rate = YTM ‚Üí PV = FV (par). When YTM &gt; coupon ‚Üí PV &lt; FV (discount). When YTM &lt; coupon ‚Üí PV &gt; FV (premium).</div>
          <span class="phase-out">‚Üí PV = PMT/(1+r)¬π + ‚Ä¶ + (PMT‚Çô + FV‚Çô)/(1+r)·¥∫ &nbsp;|&nbsp; Excel: PV(r, N, PMT, FV, 0)</span>
        </div>
      </div>
      <div class="phase-row">
        <div class="phase-n">3</div>
        <div class="phase-body">
          <div class="phase-title">Level-Payment / Annuity (Mortgage-Type)</div>
          <div class="phase-desc">Uniform periodic payment A covers both interest and principal repayment over the life of the loan. Interest portion declines each period as principal falls; principal portion rises. All 360 monthly payments are equal for a 30-year mortgage.</div>
          <span class="phase-out">‚Üí A = r¬∑PV / [1 ‚àí (1+r)‚Åª·µó] &nbsp;|&nbsp; Excel: PMT(r, t, ‚àíPV, 0, 0)</span>
        </div>
      </div>
    </div>
    <div class="info-note gold" style="margin-top:12px">
      <strong>Perpetual Bond:</strong> As N ‚Üí ‚àû, coupon bond simplifies to PV = PMT / r. Used for bonds with no maturity date (e.g. preference shares, AT1 capital instruments). YTM = PMT / PV, so a price below par implies a higher yield.
    </div>

    <hr class="s-divider">

    <!-- Key bond pricing numbers -->
    <div class="s-header">
      <div class="s-icon">üî¢</div>
      <h2><span>Section 1 ‚Äî LO 1</span>Bond Pricing: Critical Relationships</h2>
    </div>
    <table class="cmp-table">
      <thead><tr><th>Relationship</th><th>Direction</th><th>Why</th></tr></thead>
      <tbody>
        <tr><td>Price vs YTM</td><td><strong>Inverse</strong> ‚Äî higher YTM ‚Üí lower price</td><td>Discount rate in denominator; higher rate reduces PV</td></tr>
        <tr><td>Coupon rate = YTM</td><td>Bond priced at <strong>par</strong> (PV = FV)</td><td>Each cash flow discounted at same rate as it generates; net is exactly par</td></tr>
        <tr><td>Discount bond price over time (if r constant)</td><td><strong>Accretes</strong> toward FV</td><td>Fewer remaining periods; PV rises as t ‚Üí 0</td></tr>
        <tr><td>Premium bond price over time (if r constant)</td><td><strong>Amortises</strong> toward FV</td><td>Overpaid relative to par; price falls back toward redemption value</td></tr>
        <tr><td>More frequent compounding</td><td>Lower PV for same stated rate</td><td>1/(1+r)·µó &gt; 1/(1+r/2)¬≤·µó when r ‚â• 0</td></tr>
        <tr><td>Negative YTM bond at issuance</td><td>PV <strong>&gt;</strong> FV (issued at premium)</td><td>Investor accepts a guaranteed loss on principal in exchange for safety/storage of value</td></tr>
      </tbody>
    </table>

    <hr class="s-divider">

    <!-- Equity Valuation Models -->
    <div class="s-header">
      <div class="s-icon">üìà</div>
      <h2><span>Section 1 ‚Äî LO 1</span>Equity Valuation: Three Dividend Models</h2>
    </div>
    <div class="phases-table">
      <div class="phase-row">
        <div class="phase-n">1</div>
        <div class="phase-body">
          <div class="phase-title">Constant Dividend (Zero Growth)</div>
          <div class="phase-desc">Stock pays a fixed dividend D every period forever (perpetuity). Same formula as a perpetual bond. Suitable for preferred shares or stable mature companies with fixed payouts.</div>
          <span class="phase-out">‚Üí PV = D / r</span>
        </div>
      </div>
      <div class="phase-row">
        <div class="phase-n">2</div>
        <div class="phase-body">
          <div class="phase-title">Constant Dividend Growth (Gordon Growth Model)</div>
          <div class="phase-desc">Dividend grows at constant rate g forever. Requires r &gt; g. A higher growth rate g reduces the denominator (r ‚àí g), increasing the share price. The next dividend D‚Çú‚Çä‚ÇÅ = D‚Çú √ó (1 + g) is used (not the most recent dividend).</div>
          <span class="phase-out">‚Üí PV = D‚Çú‚Çä‚ÇÅ / (r ‚àí g) = D‚Çú(1+g) / (r ‚àí g)</span>
        </div>
      </div>
      <div class="phase-row">
        <div class="phase-n">3</div>
        <div class="phase-body">
          <div class="phase-title">Two-Stage (Changing) Dividend Growth</div>
          <div class="phase-desc">High initial growth g‚Çõ for n periods, then slower long-term growth g‚Çó indefinitely. Step 1: PV of each dividend in high-growth stage. Step 2: PV of terminal value E(S‚Çô) = D‚Çô‚Çä‚ÇÅ / (r ‚àí g‚Çó) discounted back n periods. Step 3: Sum both.</div>
          <span class="phase-out">‚Üí PV = Œ£·µ¢‚Çå‚ÇÅ‚Åø [D‚Çú(1+g‚Çõ)‚Å± / (1+r)‚Å±] + E(S‚Çô)/(1+r)‚Åø</span>
        </div>
      </div>
    </div>
    <div class="info-note blue" style="margin-top:12px">
      <strong>Sensitivity check:</strong> As long-term growth g‚Çó increases (0% ‚Üí 2% ‚Üí 4% ‚Üí 6%), the share price increases non-linearly because g‚Çó reduces the denominator in the terminal value formula. Small changes in g‚Çó near r have a large effect on PV.
    </div>

    <hr class="s-divider">

    <!-- Implied Return & Growth -->
    <div class="s-header">
      <div class="s-icon">üîç</div>
      <h2><span>Section 2 ‚Äî LO 2</span>Implied Return &amp; Growth: Key Formulas</h2>
    </div>
    <div class="filing-grid">
      <div class="filing-card">
        <h3>üìâ Discount Bond Implied Return</h3>
        <p>When price and principal are known, solve for the annualised periodic rate.<br><br><strong>r = (FV/PV)^(1/t) ‚àí 1</strong><br><br>An investor who sells before maturity earns the implied return based on <em>purchase price ‚Üí sale price</em>, not original YTM. If rates rise after purchase, implied return over the holding period is below YTM.</p>
      </div>
      <div class="filing-card">
        <h3>üîÑ Coupon Bond YTM (Implied Return)</h3>
        <p>YTM is the IRR of all promised cash flows. Cannot be solved algebraically ‚Äî use iteration (Excel RATE or YIELD function).<br><br>Assumes: (1) all cash flows received as promised, and (2) <strong>all coupon payments reinvested at the same YTM</strong>. The reinvestment rate assumption is critical ‚Äî a key limitation of YTM.</p>
      </div>
      <div class="filing-card">
        <h3>üìä Equity Implied Return</h3>
        <p>Given current price and expected dividends + growth:<br><br><strong>r = D‚Çú‚Çä‚ÇÅ/PV‚Çú + g</strong><br><br>Implied return = expected dividend yield + constant growth rate. Simple interpretation: total return = income + capital appreciation.</p>
      </div>
      <div class="filing-card">
        <h3>üå± Equity Implied Growth</h3>
        <p>Given current price, expected dividend, and required return:<br><br><strong>g = r ‚àí D‚Çú‚Çä‚ÇÅ/PV‚Çú</strong><br><br>Implied growth = required return minus expected dividend yield. If implied growth &gt; analyst's estimate ‚Üí stock may be overvalued. If implied growth &lt; analyst's estimate ‚Üí stock may be undervalued.</p>
      </div>
    </div>

    <hr class="s-divider">

    <!-- Price-to-Earnings -->
    <div class="s-header">
      <div class="s-icon">üíπ</div>
      <h2><span>Section 2 ‚Äî LO 2</span>Price-to-Earnings (P/E) Ratio &amp; Valuation</h2>
    </div>
    <div class="info-note gold" style="margin-bottom:14px">
      <strong>Forward P/E formula:</strong> PV‚Çú / E‚Çú‚Çä‚ÇÅ = (D‚Çú‚Çä‚ÇÅ/E‚Çú‚Çä‚ÇÅ) / (r ‚àí g) = Dividend payout ratio / (r ‚àí g)
    </div>
    <table class="cmp-table">
      <thead><tr><th>P/E is <em>higher</em> when...</th><th>P/E is <em>lower</em> when...</th></tr></thead>
      <tbody>
        <tr><td>Growth rate g is <strong>higher</strong> (reduces denominator r ‚àí g)</td><td>Required return r is <strong>higher</strong> (increases denominator)</td></tr>
        <tr><td>Dividend payout ratio is <strong>higher</strong></td><td>Dividend payout ratio is <strong>lower</strong></td></tr>
        <tr><td>Required return r is <strong>lower</strong></td><td>Growth rate g is <strong>lower</strong></td></tr>
      </tbody>
    </table>
    <div class="audit-list" style="margin-top:14px">
      <div class="audit-item"><div class="audit-dot" style="background:#1a7a4a"></div><div><h4>Overvalued Signal</h4><p>Observed P/E &gt; implied P/E (from fundamentals). The current price is too high relative to earnings, dividends, and growth expectations. Consider a short position or avoid.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#1a3a8f"></div><div><h4>Undervalued Signal</h4><p>Observed P/E &lt; implied P/E. Fundamentals (growth, payout, required return) justify a higher price than the market currently reflects. Consider a long position.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b98a1c"></div><div><h4>Fairly Valued</h4><p>Observed P/E = implied P/E. Market price correctly reflects the combination of expected growth and required return embedded in the dividend payout ratio.</p></div></div>
    </div>

    <hr class="s-divider">

    <!-- Cash Flow Additivity -->
    <div class="s-header">
      <div class="s-icon">‚öñÔ∏è</div>
      <h2><span>Section 3 ‚Äî LO 3</span>Cash Flow Additivity &amp; No-Arbitrage</h2>
    </div>
    <div class="info-note gold" style="margin-bottom:14px">
      <strong>Principle:</strong> The PV of any future cash flow stream equals the <em>sum</em> of the PVs of its individual cash flows (as long as they are indexed at the same point in time). Two strategies with identical cash flows must have the same price ‚Äî otherwise a riskless arbitrage profit exists.
    </div>
    <div class="phases-table">
      <div class="phase-row">
        <div class="phase-n" style="font-size:.7rem;padding:4px">App 1</div>
        <div class="phase-body">
          <div class="phase-title">Implied Forward Interest Rates</div>
          <div class="phase-desc">A risk-neutral investor is indifferent between (1) investing at the 2-year spot rate for 2 years, or (2) investing at the 1-year spot rate and rolling over at the implied 1-year forward rate F‚ÇÅ,‚ÇÅ. No-arbitrage requires both strategies to yield the same FV.</div>
          <span class="phase-out">‚Üí F‚ÇÅ,‚ÇÅ = (1+r‚ÇÇ)¬≤ / (1+r‚ÇÅ) ‚àí 1 &nbsp;|&nbsp; F‚ÇÅ,‚ÇÅ is the breakeven reinvestment rate in year 2</span>
        </div>
      </div>
      <div class="phase-row">
        <div class="phase-n" style="font-size:.7rem;padding:4px">App 2</div>
        <div class="phase-body">
          <div class="phase-title">Forward Exchange Rates (Covered Interest Parity)</div>
          <div class="phase-desc">Investor is indifferent between (1) investing in domestic currency at domestic risk-free rate, or (2) converting to foreign currency, investing at foreign risk-free rate, and locking in a forward FX rate today. Both must yield the same domestic-currency return.</div>
          <span class="phase-out">‚Üí F‚ÇÄ = S‚ÇÄ √ó e^(r_d ‚àí r_f)T &nbsp;|&nbsp; If r_d &gt; r_f, domestic currency depreciates on a forward basis</span>
        </div>
      </div>
      <div class="phase-row">
        <div class="phase-n" style="font-size:.7rem;padding:4px">App 3</div>
        <div class="phase-body">
          <div class="phase-title">Option Pricing (Replicating Portfolio)</div>
          <div class="phase-desc">Construct a portfolio of the underlying asset and the option such that the portfolio's value is the same in all scenarios (risk-free). Discount this known future payoff at the risk-free rate to find the no-arbitrage option price today. The proportion of underlying asset held = hedge ratio.</div>
          <span class="phase-out">‚Üí PV(replicating portfolio) = V‚ÇÅ/(1+r) &nbsp;|&nbsp; Solve for c‚ÇÄ or p‚ÇÄ</span>
        </div>
      </div>
    </div>

    <hr class="s-divider">

    <!-- Forward Rate Arbitrage mechanism -->
    <div class="s-header">
      <div class="s-icon">üîÄ</div>
      <h2><span>Section 3 ‚Äî LO 3</span>Arbitrage: How It Works &amp; Why It Fails</h2>
    </div>
    <div class="src-grid">
      <div class="src-card">
        <div class="src-card-hd">üìê Forward Rate Arbitrage (Interest Rates)</div>
        <ul class="src-items">
          <li>If F‚ÇÅ,‚ÇÅ is set too high: borrow for 2 years at r‚ÇÇ, invest year-by-year at r‚ÇÅ then F‚ÇÅ,‚ÇÅ ‚Üí riskless profit</li>
          <li>If F‚ÇÅ,‚ÇÅ is set too low: the reverse strategy generates riskless profit</li>
          <li>Markets force F‚ÇÅ,‚ÇÅ to the exact breakeven level ‚Äî F‚ÇÅ,‚ÇÅ = (1+r‚ÇÇ)¬≤/(1+r‚ÇÅ) ‚àí 1</li>
          <li>In a rising-rate environment: F‚ÇÅ,‚ÇÅ &gt; r‚ÇÇ &gt; r‚ÇÅ (upward-sloping yield curve)</li>
        </ul>
      </div>
      <div class="src-card">
        <div class="src-card-hd">üí± FX Forward Arbitrage (Interest Rate Parity)</div>
        <ul class="src-items">
          <li>If forward FX rate is too favourable: convert domestic ‚Üí foreign, invest, convert back ‚Üí riskless profit</li>
          <li>Higher domestic interest rate ‚Üí domestic currency depreciates on a forward basis</li>
          <li>The forward rate is the <em>only</em> rate consistent with no-arbitrage given the two risk-free rates and spot exchange rate</li>
        </ul>
      </div>
      <div class="src-card">
        <div class="src-card-hd">üìä Call Option Replication</div>
        <ul class="src-items">
          <li>Call option: right to BUY at exercise price X; value = Max(0, S‚ÇÅ ‚àí X) at expiry</li>
          <li>Replicating portfolio: buy h units of stock + sell call ‚Üí same payoff in both up/down scenarios</li>
          <li>Hedge ratio h = (c_up ‚àí c_down) / (S_up ‚àí S_down)</li>
          <li>PV of replicating portfolio = risk-free payoff discounted at risk-free rate ‚Üí solves for c‚ÇÄ</li>
        </ul>
      </div>
      <div class="src-card">
        <div class="src-card-hd">üìâ Put Option Replication</div>
        <ul class="src-items">
          <li>Put option: right to SELL at exercise price X; value = Max(0, X ‚àí S‚ÇÅ) at expiry</li>
          <li>Replicating portfolio: buy h units of stock + buy put ‚Üí same payoff in both scenarios</li>
          <li>Put increases in value when stock falls (opposite to call)</li>
          <li>Higher put payoff in the down scenario ‚Üí higher put option price vs call under same parameters</li>
        </ul>
      </div>
    </div>

    <hr class="s-divider">

    <!-- Key Formulas Summary Table -->
    <div class="s-header">
      <div class="s-icon">üìã</div>
      <h2><span>Master Reference</span>All Key Formulas at a Glance</h2>
    </div>
    <table class="cmp-table">
      <thead><tr><th>Instrument / Concept</th><th>Formula</th><th>Notes</th></tr></thead>
      <tbody>
        <tr><td>Discount bond price</td><td>PV = FV / (1+r)·µó</td><td>r = periodic rate; t = periods to maturity</td></tr>
        <tr><td>Coupon bond price</td><td>PV = Œ£ PMT·µ¢/(1+r)‚Å± + FV/(1+r)·¥∫</td><td>Use semiannual r and N for semiannual bonds</td></tr>
        <tr><td>Perpetual bond / Preferred stock</td><td>PV = PMT / r</td><td>Valid only when r &gt; 0</td></tr>
        <tr><td>Annuity payment</td><td>A = r¬∑PV / [1‚àí(1+r)‚Åª·µó]</td><td>Each payment includes interest + principal repayment</td></tr>
        <tr><td>Constant dividend stock</td><td>PV = D / r</td><td>Identical to perpetuity formula</td></tr>
        <tr><td>Gordon Growth Model</td><td>PV = D‚Çú‚Çä‚ÇÅ / (r‚àíg)</td><td>r &gt; g required; use NEXT period dividend</td></tr>
        <tr><td>Two-stage dividend model</td><td>PV = Œ£·µ¢‚Çå‚ÇÅ‚Åø [D‚Çú(1+g‚Çõ)‚Å±/(1+r)‚Å±] + E(S‚Çô)/(1+r)‚Åø</td><td>Terminal value: E(S‚Çô) = D‚Çô‚Çä‚ÇÅ/(r‚àíg‚Çó)</td></tr>
        <tr><td>Implied return ‚Äî discount bond</td><td>r = (FV/PV)^(1/t) ‚àí 1</td><td>Same as geometric mean of price relative</td></tr>
        <tr><td>Equity implied return</td><td>r = D‚Çú‚Çä‚ÇÅ/PV‚Çú + g</td><td>Dividend yield + constant growth rate</td></tr>
        <tr><td>Equity implied growth</td><td>g = r ‚àí D‚Çú‚Çä‚ÇÅ/PV‚Çú</td><td>Required return minus dividend yield</td></tr>
        <tr><td>Forward P/E</td><td>PV/E‚Çú‚Çä‚ÇÅ = Payout ratio / (r‚àíg)</td><td>Higher g or lower r ‚Üí higher P/E</td></tr>
        <tr><td>Implied forward rate</td><td>F‚ÇÅ,‚ÇÅ = (1+r‚ÇÇ)¬≤/(1+r‚ÇÅ) ‚àí 1</td><td>Breakeven 1-year rate starting in 1 year</td></tr>
        <tr><td>Forward FX (continuous)</td><td>F‚ÇÄ = S‚ÇÄ √ó e^(r_d ‚àí r_f)T</td><td>Higher r_d ‚Üí domestic currency forward depreciation</td></tr>
      </tbody>
    </table>

    <hr class="s-divider">

    <!-- Common Exam Pitfalls -->
    <div class="s-header">
      <div class="s-icon">‚ö°</div>
      <h2><span>Common Pitfalls</span>Exam Traps to Avoid</h2>
    </div>
    <div class="src-grid">
      <div class="src-card"><div class="src-card-hd">‚ùå Semiannual Bond Compounding</div><ul class="src-items"><li>Always halve the annual coupon AND the annual YTM for semiannual bonds</li><li>Double the number of periods (20-year semiannual = 40 periods)</li><li>Using 20 annual periods with semiannual rate gives a wrong (lower) PV</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Gordon Growth: Use Next Dividend</div><ul class="src-items"><li>PV = D‚Çú‚Çä‚ÇÅ/(r‚àíg) ‚Äî use the NEXT expected dividend, not the most recent</li><li>If given D‚Çú (last paid), multiply by (1+g) to get D‚Çú‚Çä‚ÇÅ</li><li>Using last dividend instead of next dividend understates PV</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Forward Rate vs Spot Rate</div><ul class="src-items"><li>F‚ÇÅ,‚ÇÅ is not the expected future spot rate ‚Äî it is the breakeven rate implied by current spot rates</li><li>In a rising-rate environment, F‚ÇÅ,‚ÇÅ &gt; r‚ÇÇ &gt; r‚ÇÅ</li><li>If F‚ÇÅ,‚ÇÅ ‚â† breakeven, an arbitrage opportunity exists</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå YTM Reinvestment Assumption</div><ul class="src-items"><li>YTM assumes coupon cash flows are reinvested at the same YTM ‚Äî often unrealistic</li><li>If reinvestment rates are lower than YTM, actual return earned is less than YTM</li><li>This assumption is a key limitation of YTM as a return measure</li></ul></div>
    </div>

    <div class="takeaway">
      <h3>Core Mindset for TVM in Finance</h3>
      <p>Every financial asset price is simply the <strong>present value of its expected future cash flows</strong> discounted at an appropriate risk-adjusted rate. The same TVM framework applies whether you're pricing a zero-coupon government bond, a dividend-growing stock, or a complex option ‚Äî only the cash flow pattern and the discount rate change. <strong>Cash flow additivity</strong> ties everything together: identical future cash flows must have identical prices today, or a riskless arbitrage profit is available. Mastering the link between <em>price, cash flows, and discount rate</em> ‚Äî and being able to solve for any one given the other two ‚Äî is the single most tested skill in this reading.</p>
    </div>

  </div><!-- /.sum-body -->
  </div><!-- /#sum-qm-2 -->


  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       QM ¬∑ READING 3 ‚Äî STATISTICAL MEASURES OF ASSET RETURNS
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="sum-qm-3" class="sum-chapter" style="display:none">
  <div class="sum-hero">
    <div class="sum-hero-label">2026 CFA¬Æ Program ¬∑ Level I ¬∑ QM Reading 3</div>
    <h1>Statistical Measures of <em>Asset Returns</em></h1>
    <div class="sum-hero-tags">
      <span class="sum-hero-tag">4 Learning Outcomes</span>
      <span class="sum-hero-tag">Central Tendency</span>
      <span class="sum-hero-tag">Dispersion</span>
      <span class="sum-hero-tag">Skewness &amp; Kurtosis</span>
      <span class="sum-hero-tag">Correlation</span>
      <span class="sum-hero-tag">Quantiles</span>
    </div>
  </div>

  <div class="sum-body">

    <!-- Learning Outcomes -->
    <div class="s-header">
      <div class="s-icon">üéØ</div>
      <h2><span>Learning Outcomes</span>What You Need to Master</h2>
    </div>
    <div class="lo-list">
      <div class="lo-item"><span class="lo-pill">LO 1</span><span class="lo-text">Calculate, interpret, and evaluate <strong>measures of central tendency and location</strong> to address an investment problem</span></div>
      <div class="lo-item"><span class="lo-pill">LO 2</span><span class="lo-text">Calculate, interpret, and evaluate <strong>measures of dispersion</strong> to address an investment problem</span></div>
      <div class="lo-item"><span class="lo-pill">LO 3</span><span class="lo-text">Interpret and evaluate <strong>measures of skewness and kurtosis</strong> to address an investment problem</span></div>
      <div class="lo-item"><span class="lo-pill">LO 4</span><span class="lo-text">Interpret <strong>correlation between two variables</strong> to address an investment problem</span></div>
    </div>

    <hr class="s-divider">

    <!-- Central Tendency -->
    <div class="s-header">
      <div class="s-icon">üìç</div>
      <h2><span>Section 1 ‚Äî LO 1</span>Measures of Central Tendency</h2>
    </div>
    <div class="phases-table">
      <div class="phase-row"><div class="phase-n">1</div><div class="phase-body"><div class="phase-title">Arithmetic Mean <span style="font-weight:400;font-size:.85em">( XÃÑ = Œ£ X·µ¢ / n )</span></div><div class="phase-desc">Sum of all observations divided by the number of observations. Most common measure; used as default. <strong>Sensitive to outliers</strong> ‚Äî a single extreme value pulls the mean significantly.</div><span class="phase-out">‚Üí Best for symmetric distributions without extreme outliers</span></div></div>
      <div class="phase-row"><div class="phase-n">2</div><div class="phase-body"><div class="phase-title">Median</div><div class="phase-desc">Middle value when data are sorted. For odd n: value at position (n+1)/2. For even n: average of values at positions n/2 and (n+2)/2. <strong>Not affected by outliers</strong> ‚Äî preferred for skewed distributions.</div><span class="phase-out">‚Üí Preferred when outliers or skewness are present</span></div></div>
      <div class="phase-row"><div class="phase-n">3</div><div class="phase-body"><div class="phase-title">Mode</div><div class="phase-desc">Most frequently occurring value. A dataset can be unimodal (one mode), bimodal, trimodal, or have no mode. The only measure usable with nominal/categorical data.</div><span class="phase-out">‚Üí Histogram bar with highest frequency = modal interval</span></div></div>
      <div class="phase-row"><div class="phase-n">4</div><div class="phase-body"><div class="phase-title">Trimmed Mean</div><div class="phase-desc">Arithmetic mean computed after removing a stated percentage of the extreme high and low values (e.g., 5% trimmed mean removes the bottom 2.5% and top 2.5% of values). Reduces the influence of outliers.</div><span class="phase-out">‚Üí Used in sports scoring and robust return estimation</span></div></div>
      <div class="phase-row"><div class="phase-n">5</div><div class="phase-body"><div class="phase-title">Winsorized Mean</div><div class="phase-desc">Extreme values are replaced (not removed) by a specified percentile boundary. A 95% winsorized mean substitutes the 2.5th percentile value for all observations below it and the 97.5th percentile value for all above.</div><span class="phase-out">‚Üí Preserves sample size; reduces distortion from extremes</span></div></div>
    </div>
    <div class="info-note gold"><strong>Skewness and means:</strong> In a positively skewed distribution: Mode &lt; Median &lt; Mean. In a negatively skewed distribution: Mean &lt; Median &lt; Mode. In a symmetric distribution all three are equal.</div>

    <hr class="s-divider">

    <!-- Quantiles -->
    <div class="s-header">
      <div class="s-icon">üìä</div>
      <h2><span>Section 1 ‚Äî LO 1</span>Quantiles and Location Measures</h2>
    </div>
    <table class="cmp-table">
      <thead><tr><th>Quantile Type</th><th>Divides Into</th><th>Key Points</th></tr></thead>
      <tbody>
        <tr><td><strong>Percentiles</strong></td><td>100 equal parts</td><td>90th percentile = value at/below which 90% of data falls. Location: L·µß = (n+1) √ó (y/100)</td></tr>
        <tr><td><strong>Deciles</strong></td><td>10 equal parts</td><td>Each decile = 10% of data. Used to rank companies by size (e.g., market cap deciles)</td></tr>
        <tr><td><strong>Quintiles</strong></td><td>5 equal parts</td><td>Each quintile = 20% of data. 4th quintile = 80th percentile</td></tr>
        <tr><td><strong>Quartiles</strong></td><td>4 equal parts</td><td>Q1 = 25th pct; Q2 = 50th pct (median); Q3 = 75th pct</td></tr>
        <tr><td><strong>IQR</strong></td><td>‚Äî</td><td>IQR = Q3 ‚àí Q1. Middle 50% of data. Box in a box-and-whisker plot</td></tr>
      </tbody>
    </table>
    <div class="info-note blue" style="margin-top:12px"><strong>Box &amp; Whisker Plot:</strong> The box spans Q1 to Q3 (= IQR). Whisker fences are often set at Q1 ‚àí 1.5√óIQR (lower) and Q3 + 1.5√óIQR (upper). Data points beyond the fences are plotted individually as <strong>outliers</strong>. The median and arithmetic mean are marked within the box.</div>

    <hr class="s-divider">

    <!-- Measures of Dispersion -->
    <div class="s-header">
      <div class="s-icon">üìè</div>
      <h2><span>Section 2 ‚Äî LO 2</span>Measures of Dispersion</h2>
    </div>
    <div class="audit-list">
      <div class="audit-item"><div class="audit-dot" style="background:#1a3a8f"></div><div><h4>Range</h4><p>Maximum value ‚àí Minimum value. Simple but uses only two observations; highly sensitive to outliers. Limited informational value about the shape of the distribution.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b98a1c"></div><div><h4>Mean Absolute Deviation (MAD)</h4><p>MAD = Œ£|X·µ¢ ‚àí XÃÑ| / n. Average of the absolute deviations from the mean. Uses all observations. Technically harder to manipulate mathematically than variance.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b91c1c"></div><div><h4>Sample Variance (s¬≤)</h4><p>s¬≤ = Œ£(X·µ¢ ‚àí XÃÑ)¬≤ / (n‚àí1). Squared deviations from the mean, averaged using n‚àí1 (degrees of freedom). The divisor n‚àí1 makes s¬≤ an unbiased estimator of population variance. Units are squared.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#1a7a4a"></div><div><h4>Sample Standard Deviation (s)</h4><p>s = ‚àö[Œ£(X·µ¢ ‚àí XÃÑ)¬≤ / (n‚àí1)]. Square root of the variance; same units as the data. Most widely used dispersion measure. Always reported alongside the arithmetic mean.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#6b3a8f"></div><div><h4>Target Downside Deviation (Semideviation)</h4><p>S_Target = ‚àö[Œ£(X·µ¢ ‚àí B)¬≤ / (n‚àí1)] for all X·µ¢ ‚â§ B. Only counts observations <em>below</em> the target B. Higher target ‚Üí more observations included ‚Üí larger semideviation. Captures downside risk only.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#3a7a8f"></div><div><h4>Coefficient of Variation (CV)</h4><p>CV = s / XÃÑ. Risk per unit of mean return. Scale-free ‚Äî allows comparison across datasets with different means or units. Higher CV = more risk per unit of reward. Meaningless if XÃÑ is negative.</p></div></div>
    </div>
    <div class="info-note gold" style="margin-top:16px"><strong>Key relationship:</strong> For any distribution, Geometric Mean ‚â§ Arithmetic Mean. The greater the dispersion (higher variance), the larger the gap between them. This is why Portfolio B with higher standard deviation has a lower geometric mean than Portfolio A despite equal arithmetic means.</div>

    <hr class="s-divider">

    <!-- Key Formulas -->
    <div class="s-header">
      <div class="s-icon">üìã</div>
      <h2><span>Master Reference</span>All Key Formulas at a Glance</h2>
    </div>
    <table class="cmp-table">
      <thead><tr><th>Measure</th><th>Formula</th><th>Notes</th></tr></thead>
      <tbody>
        <tr><td>Sample Mean</td><td>XÃÑ = Œ£ X·µ¢ / n</td><td>Equal weight to all observations</td></tr>
        <tr><td>MAD</td><td>Œ£|X·µ¢ ‚àí XÃÑ| / n</td><td>Uses absolute value; avoids sign cancellation</td></tr>
        <tr><td>Sample Variance</td><td>s¬≤ = Œ£(X·µ¢ ‚àí XÃÑ)¬≤ / (n‚àí1)</td><td>Divide by n‚àí1, not n</td></tr>
        <tr><td>Sample Std Dev</td><td>s = ‚àö[Œ£(X·µ¢ ‚àí XÃÑ)¬≤ / (n‚àí1)]</td><td>Same units as original data</td></tr>
        <tr><td>Target Semideviation</td><td>‚àö[Œ£(X·µ¢‚àíB)¬≤ / (n‚àí1)], X·µ¢ ‚â§ B</td><td>n = total sample size (not just below-target obs)</td></tr>
        <tr><td>Coefficient of Variation</td><td>CV = s / XÃÑ</td><td>Higher = riskier per unit of return</td></tr>
        <tr><td>Skewness (approx.)</td><td>(1/n) Œ£[(X·µ¢ ‚àí XÃÑ)¬≥ / s¬≥]</td><td>Positive = right tail; Negative = left tail</td></tr>
        <tr><td>Excess Kurtosis</td><td>(1/n) Œ£[(X·µ¢ ‚àí XÃÑ)‚Å¥ / s‚Å¥] ‚àí 3</td><td>Normal = 0; Fat-tailed &gt; 0; Thin-tailed &lt; 0</td></tr>
        <tr><td>Sample Covariance</td><td>sXY = Œ£(X·µ¢‚àíXÃÑ)(Y·µ¢‚àí»≤) / (n‚àí1)</td><td>Positive: move together; Negative: move oppositely</td></tr>
        <tr><td>Correlation Coefficient</td><td>r = sXY / (sX √ó sY)</td><td>Range: ‚àí1 to +1; 0 = no linear relationship</td></tr>
        <tr><td>IQR</td><td>Q3 ‚àí Q1</td><td>Middle 50% of data; box height in box plot</td></tr>
        <tr><td>Percentile Location</td><td>L·µß = (n+1) √ó (y/100)</td><td>Interpolate between adjacent values if non-integer</td></tr>
      </tbody>
    </table>

    <hr class="s-divider">

    <!-- Skewness & Kurtosis -->
    <div class="s-header">
      <div class="s-icon">üìê</div>
      <h2><span>Section 3 ‚Äî LO 3</span>Skewness and Kurtosis</h2>
    </div>
    <div class="phases-table">
      <div class="phase-row"><div class="phase-n">+</div><div class="phase-body"><div class="phase-title">Positive Skewness (Right-Skewed)</div><div class="phase-desc">Long tail on the right. Frequent small losses, occasional large gains. Mode &lt; Median &lt; Mean. Investors generally <em>prefer</em> positive skew ‚Äî upside is less frequent but larger.</div><span class="phase-out">‚Üí Mean is pulled upward by extreme positive values</span></div></div>
      <div class="phase-row"><div class="phase-n">‚àí</div><div class="phase-body"><div class="phase-title">Negative Skewness (Left-Skewed)</div><div class="phase-desc">Long tail on the left. Frequent small gains, occasional large losses. Mean &lt; Median &lt; Mode. Most equity index daily returns exhibit negative skewness ‚Äî catastrophic drawdowns are possible.</div><span class="phase-out">‚Üí Mean is pulled downward by extreme negative values</span></div></div>
      <div class="phase-row"><div class="phase-n">0</div><div class="phase-body"><div class="phase-title">Zero Skewness (Symmetric)</div><div class="phase-desc">Mirror-image distribution around the mean. Mean = Median = Mode. The normal distribution is the classic example.</div><span class="phase-out">‚Üí Equal probability of equivalent positive and negative deviations</span></div></div>
    </div>
    <table class="cmp-table" style="margin-top:24px">
      <thead><tr><th>Kurtosis Type</th><th>Excess Kurtosis</th><th>Kurtosis Value</th><th>Tail Shape</th><th>Investment Implication</th></tr></thead>
      <tbody>
        <tr><td><strong>Leptokurtic</strong> (fat-tailed)</td><td>&gt; 0</td><td>&gt; 3</td><td>Fatter than normal</td><td>More frequent extreme events ‚Äî <strong>underestimates tail risk</strong> if normal assumed</td></tr>
        <tr><td><strong>Mesokurtic</strong> (normal)</td><td>= 0</td><td>= 3</td><td>Normal</td><td>Standard benchmark; normal distribution</td></tr>
        <tr><td><strong>Platykurtic</strong> (thin-tailed)</td><td>&lt; 0</td><td>&lt; 3</td><td>Thinner than normal</td><td>Fewer extreme outcomes than normal distribution</td></tr>
      </tbody>
    </table>
    <div class="info-note blue" style="margin-top:12px"><strong>Practical note:</strong> Most equity return distributions are fat-tailed (leptokurtic) with negative skewness. Using a normal distribution model for such returns <strong>underestimates</strong> the probability of both very bad outcomes (crashes) and very good outcomes (rallies). This is a key limitation of mean‚Äìvariance analysis.</div>

    <hr class="s-divider">

    <!-- Correlation -->
    <div class="s-header">
      <div class="s-icon">üîó</div>
      <h2><span>Section 4 ‚Äî LO 4</span>Correlation Between Two Variables</h2>
    </div>
    <div class="audit-list">
      <div class="audit-item"><div class="audit-dot" style="background:#1a3a8f"></div><div><h4>Correlation = +1 (Perfect Positive)</h4><p>All scatter plot points lie on a positively sloped straight line. Every unit increase in X is associated with a fixed increase in Y. No diversification benefit.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#1a7a4a"></div><div><h4>Correlation near +1 (Strong Positive)</h4><p>Variables move together most of the time. Tightly clustered scatter around an upward-sloping line. Example: IT sector vs. S&amp;P 500 returns.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b98a1c"></div><div><h4>Correlation = 0 (Uncorrelated)</h4><p>No linear relationship. Knowing X tells you nothing about Y. Points scatter randomly. Example: utilities sector vs. S&amp;P 500 in some periods.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b91c1c"></div><div><h4>Correlation = ‚àí1 (Perfect Negative / Inverse)</h4><p>All points on a negatively sloped straight line. Every increase in X is associated with a fixed decrease in Y. Maximum diversification benefit.</p></div></div>
    </div>
    <div class="info-note gold" style="margin-top:16px">
      <strong>Key limitations of correlation:</strong>
      <ul style="margin-top:8px;padding-left:18px;line-height:1.9">
        <li><strong>Outliers</strong> ‚Äî a single extreme observation can dramatically change the correlation coefficient.</li>
        <li><strong>Non-linear relationships</strong> ‚Äî correlation measures only <em>linear</em> association; two variables perfectly associated in a non-linear way can have r ‚âà 0.</li>
        <li><strong>Spurious correlation</strong> ‚Äî high correlation may arise by chance, from dividing by a shared variable, or from a common third-variable driver. Correlation does not imply causation.</li>
        <li><strong>Anscombe's Quartet</strong> ‚Äî four very different datasets can share identical means, standard deviations, and correlations. Always visualize data with a scatter plot before interpreting r.</li>
      </ul>
    </div>

    <hr class="s-divider">

    <!-- Common Exam Pitfalls -->
    <div class="s-header">
      <div class="s-icon">‚ö°</div>
      <h2><span>Common Pitfalls</span>Exam Traps to Avoid</h2>
    </div>
    <div class="src-grid">
      <div class="src-card"><div class="src-card-hd">‚ùå Variance Divisor: n vs n‚àí1</div><ul class="src-items"><li>Sample variance and standard deviation use n‚àí1 (degrees of freedom), not n</li><li>Using n gives a biased (lower) estimate of population variance</li><li>Sample covariance also uses n‚àí1 in the denominator</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Target Semideviation: Wrong n</div><ul class="src-items"><li>Denominator is n‚àí1 where n = <em>total</em> sample observations, not just observations below the target</li><li>Only the squared deviations are restricted to below-target observations in the numerator</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Skewness Signs and Tail Direction</div><ul class="src-items"><li>Positive skew ‚Üí right/upper tail is longer; mean &gt; median &gt; mode</li><li>Negative skew ‚Üí left/lower tail is longer; mean &lt; median &lt; mode</li><li>Don't confuse skewness sign with which side investors prefer</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Excess Kurtosis vs Kurtosis</div><ul class="src-items"><li>Normal distribution kurtosis = 3; excess kurtosis = 0</li><li>Statistical packages often report excess kurtosis labelled simply as "kurtosis"</li><li>Fat-tailed: excess kurtosis &gt; 0; Thin-tailed: excess kurtosis &lt; 0</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Correlation ‚â† Causation</div><ul class="src-items"><li>A high correlation does not imply one variable causes the other</li><li>Always suspect spurious correlation when the relationship has no logical basis</li><li>Correlation is only valid for <em>linear</em> relationships</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Percentile Location Formula</div><ul class="src-items"><li>Use L·µß = (n+1) √ó (y/100) to find the position, then interpolate if non-integer</li><li>The 4th quintile = 80th percentile, NOT the top 20% group</li><li>Interpolation: P·µß = X_floor + (L·µß ‚àí floor) √ó (X_ceil ‚àí X_floor)</li></ul></div>
    </div>

    <div class="takeaway">
      <h3>Core Mindset for Statistical Measures of Asset Returns</h3>
      <p>Return distributions almost never follow a perfect normal distribution. Real asset returns tend to be <strong>negatively skewed</strong> (catastrophic crashes are more likely than equivalent windfalls) and <strong>fat-tailed</strong> (extreme events occur more often than the normal curve predicts). This means that using only the mean and standard deviation to describe returns <em>systematically underestimates tail risk</em>. A complete picture requires examining skewness, kurtosis, downside semideviation, and visual tools like histograms and box plots. Similarly, when evaluating relationships between two assets, correlation summarizes only the <strong>linear</strong> part of the story ‚Äî always supplement with a scatter plot and be alert to outliers and spurious correlations before drawing investment conclusions.</p>
    </div>

  </div><!-- /.sum-body -->
  </div><!-- /#sum-qm-3 -->


  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       QM ¬∑ READING 4 ‚Äî PROBABILITY TREES AND CONDITIONAL EXPECTATIONS
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="sum-qm-4" class="sum-chapter" style="display:none">
  <div class="sum-hero">
    <div class="sum-hero-label">2026 CFA¬Æ Program ¬∑ Level I ¬∑ QM Reading 4</div>
    <h1>Probability Trees and <em>Conditional Expectations</em></h1>
    <div class="sum-hero-tags">
      <span class="sum-hero-tag">3 Learning Outcomes</span>
      <span class="sum-hero-tag">Expected Value &amp; Variance</span>
      <span class="sum-hero-tag">Probability Trees</span>
      <span class="sum-hero-tag">Total Probability Rule</span>
      <span class="sum-hero-tag">Bayes' Formula</span>
      <span class="sum-hero-tag">Posterior Probabilities</span>
    </div>
  </div>

  <div class="sum-body">

    <!-- Learning Outcomes -->
    <div class="s-header">
      <div class="s-icon">üéØ</div>
      <h2><span>Learning Outcomes</span>What You Need to Master</h2>
    </div>
    <div class="lo-list">
      <div class="lo-item"><span class="lo-pill">LO 1</span><span class="lo-text">Calculate <strong>expected values, variances, and standard deviations</strong> and demonstrate their application to investment problems</span></div>
      <div class="lo-item"><span class="lo-pill">LO 2</span><span class="lo-text">Formulate an investment problem as a <strong>probability tree</strong> and explain the use of <strong>conditional expectations</strong> in investment applications</span></div>
      <div class="lo-item"><span class="lo-pill">LO 3</span><span class="lo-text">Calculate and interpret an <strong>updated probability</strong> in an investment setting using <strong>Bayes' formula</strong></span></div>
    </div>

    <hr class="s-divider">

    <!-- Expected Value & Variance -->
    <div class="s-header">
      <div class="s-icon">üìê</div>
      <h2><span>Section 1 ‚Äî LO 1</span>Expected Value, Variance &amp; Standard Deviation</h2>
    </div>
    <div class="phases-table">
      <div class="phase-row"><div class="phase-n">1</div><div class="phase-body"><div class="phase-title">Expected Value ‚Äî E(X)</div><div class="phase-desc">The probability-weighted average of all possible outcomes of a random variable. It is a forward-looking <em>forecast</em> ‚Äî not the same as a historical sample mean, which is an equally weighted average of past observations.</div><span class="phase-out">E(X) = P(X‚ÇÅ)X‚ÇÅ + P(X‚ÇÇ)X‚ÇÇ + ‚Ä¶ + P(X‚Çô)X‚Çô = Œ£ P(X·µ¢)X·µ¢</span></div></div>
      <div class="phase-row"><div class="phase-n">2</div><div class="phase-body"><div class="phase-title">Variance ‚Äî œÉ¬≤(X)</div><div class="phase-desc">The probability-weighted average of squared deviations from the expected value. Always ‚â• 0. Variance = 0 means certainty (no risk). Variance is measured in <em>squared</em> units of X (e.g., percent¬≤).</div><span class="phase-out">œÉ¬≤(X) = Œ£ P(X·µ¢)[X·µ¢ ‚àí E(X)]¬≤</span></div></div>
      <div class="phase-row"><div class="phase-n">3</div><div class="phase-body"><div class="phase-title">Standard Deviation ‚Äî œÉ(X)</div><div class="phase-desc">The positive square root of variance. Measured in the <em>same units</em> as X (e.g., percent), making it directly interpretable as a risk measure. Always reported alongside expected value.</div><span class="phase-out">œÉ(X) = ‚àö[Œ£ P(X·µ¢)(X·µ¢ ‚àí E(X))¬≤]</span></div></div>
    </div>
    <div class="info-note gold"><strong>Calculation order is always:</strong> (1) Expected Value ‚Üí (2) Variance ‚Üí (3) Standard Deviation. You must have E(X) before you can compute variance.</div>

    <hr class="s-divider">

    <!-- Key Formulas -->
    <div class="s-header">
      <div class="s-icon">üìã</div>
      <h2><span>Master Reference</span>All Key Formulas at a Glance</h2>
    </div>
    <table class="cmp-table">
      <thead><tr><th>Concept</th><th>Formula</th><th>Notes</th></tr></thead>
      <tbody>
        <tr><td>Expected Value</td><td>E(X) = Œ£ P(X·µ¢) ¬∑ X·µ¢</td><td>Probability-weighted average of outcomes</td></tr>
        <tr><td>Variance</td><td>œÉ¬≤(X) = Œ£ P(X·µ¢)[X·µ¢ ‚àí E(X)]¬≤</td><td>Always ‚â• 0; units are squared</td></tr>
        <tr><td>Standard Deviation</td><td>œÉ(X) = ‚àöœÉ¬≤(X)</td><td>Same units as X; more interpretable than variance</td></tr>
        <tr><td>Conditional Expected Value</td><td>E(X | S) = Œ£ P(X·µ¢ | S) ¬∑ X·µ¢</td><td>Expected value given scenario S has occurred</td></tr>
        <tr><td>Total Probability Rule (2 scenarios)</td><td>E(X) = E(X|S)¬∑P(S) + E(X|S·∂ú)¬∑P(S·∂ú)</td><td>S·∂ú = complement of S (S does not occur)</td></tr>
        <tr><td>Total Probability Rule (n scenarios)</td><td>E(X) = Œ£ E(X|S·µ¢)¬∑P(S·µ¢)</td><td>Scenarios must be mutually exclusive &amp; exhaustive</td></tr>
        <tr><td>Conditional Probability</td><td>P(A|B) = P(AB) / P(B)</td><td>Probability of A given B; P(B) ‚â† 0</td></tr>
        <tr><td>Joint Probability</td><td>P(AB) = P(A|B) ¬∑ P(B)</td><td>Rearrangement of conditional probability definition</td></tr>
        <tr><td>Bayes' Formula</td><td>P(Event|Info) = [P(Info|Event) / P(Info)] ¬∑ P(Event)</td><td>Updates prior using new information</td></tr>
        <tr><td>Unconditional Probability (denominator)</td><td>P(Info) = Œ£ P(Info|E·µ¢) ¬∑ P(E·µ¢)</td><td>Required denominator in Bayes' formula</td></tr>
      </tbody>
    </table>

    <hr class="s-divider">

    <!-- Probability Trees -->
    <div class="s-header">
      <div class="s-icon">üå≥</div>
      <h2><span>Section 2 ‚Äî LO 2</span>Probability Trees &amp; Conditional Expectations</h2>
    </div>
    <div class="phases-table">
      <div class="phase-row"><div class="phase-n">1</div><div class="phase-body"><div class="phase-title">Structure of a Probability Tree</div><div class="phase-desc">A probability tree has a root node (starting point), branches leading to scenario nodes (e.g., high growth / low growth), and terminal nodes showing final outcomes with their probabilities. The probability of any terminal node = product of all probabilities along its branch path.</div><span class="phase-out">‚Üí Terminal node probability = P(scenario) √ó P(outcome | scenario)</span></div></div>
      <div class="phase-row"><div class="phase-n">2</div><div class="phase-body"><div class="phase-title">Conditional Expected Value</div><div class="phase-desc">The expected value of X computed using only the probabilities and outcomes applicable within a specific scenario S, written E(X | S). Each scenario produces its own conditional expected value and conditional variance, enabling scenario-specific risk assessment.</div><span class="phase-out">‚Üí E(X | S) = Œ£ P(X·µ¢ | S) ¬∑ X·µ¢, summing only within scenario S</span></div></div>
      <div class="phase-row"><div class="phase-n">3</div><div class="phase-body"><div class="phase-title">Total Probability Rule for E(X)</div><div class="phase-desc">The unconditional expected value equals the probability-weighted sum of all conditional expected values. Conditional and unconditional expectations must be internally consistent ‚Äî inconsistency creates arbitrage opportunities for other investors.</div><span class="phase-out">‚Üí E(X) = E(X|S‚ÇÅ)¬∑P(S‚ÇÅ) + E(X|S‚ÇÇ)¬∑P(S‚ÇÇ) + ‚Ä¶ + E(X|S‚Çô)¬∑P(S‚Çô)</span></div></div>
      <div class="phase-row"><div class="phase-n">4</div><div class="phase-body"><div class="phase-title">Conditional Variance</div><div class="phase-desc">œÉ¬≤(X | S) measures the dispersion of outcomes within a specific scenario. It uses E(X | S) ‚Äî not the overall E(X) ‚Äî as the reference mean. Useful for stress-testing: "What is my risk if the economy enters recession?"</div><span class="phase-out">‚Üí œÉ¬≤(X|S) = Œ£ P(X·µ¢|S)[X·µ¢ ‚àí E(X|S)]¬≤</span></div></div>
    </div>
    <div class="info-note blue"><strong>Investment application:</strong> Probability trees break a complex forecast (e.g., EPS, operating costs) into stages driven by underlying factors (e.g., interest rate environment, growth rate). Work <em>left to right</em> to assign probabilities at each branch; work <em>right to left</em> to aggregate conditional expected values into a single unconditional forecast at the root.</div>

    <hr class="s-divider">

    <!-- Bayes' Formula -->
    <div class="s-header">
      <div class="s-icon">üîÑ</div>
      <h2><span>Section 3 ‚Äî LO 3</span>Bayes' Formula ‚Äî Updating Probabilities</h2>
    </div>
    <div class="phases-table">
      <div class="phase-row"><div class="phase-n">1</div><div class="phase-body"><div class="phase-title">Prior Probability</div><div class="phase-desc">The probability of an event based on existing knowledge <em>before</em> receiving new information. Reflects the analyst's current belief or base rate. All prior probabilities across the mutually exclusive and exhaustive event list must sum to 1.</div><span class="phase-out">‚Üí Starting point; based on research and historical data</span></div></div>
      <div class="phase-row"><div class="phase-n">2</div><div class="phase-body"><div class="phase-title">Likelihood: P(Information | Event)</div><div class="phase-desc">The conditional probability of observing the new information, given that a specific event occurred. Must be assessed for <em>every</em> event in the list. This is the key input that reflects how strongly the new information points toward each possible event.</div><span class="phase-out">‚Üí "How likely is this announcement if EPS already beat consensus?"</span></div></div>
      <div class="phase-row"><div class="phase-n">3</div><div class="phase-body"><div class="phase-title">Unconditional Probability of the Information: P(Info)</div><div class="phase-desc">Computed via the total probability rule: P(Info) = Œ£ P(Info | Event·µ¢) ¬∑ P(Event·µ¢). This is the normalising denominator in Bayes' formula. It represents the overall chance of observing the new information, averaged across all possible events.</div><span class="phase-out">‚Üí Must be calculated before applying Bayes' formula</span></div></div>
      <div class="phase-row"><div class="phase-n">4</div><div class="phase-body"><div class="phase-title">Posterior Probability</div><div class="phase-desc">The updated probability of the event after incorporating the new information. The ratio P(Info|Event) / P(Info) is the Bayes' multiplier ‚Äî if greater than 1, the information raises the probability of that event; if less than 1, it lowers it. All posterior probabilities must sum to 1.</div><span class="phase-out">‚Üí Posterior = [P(Info|Event) / P(Info)] √ó Prior</span></div></div>
    </div>

    <div class="info-note gold" style="margin-top:16px">
      <strong>Step-by-step Bayes' process:</strong>
      <ol style="margin-top:8px;padding-left:18px;line-height:2">
        <li>List all <strong>mutually exclusive and exhaustive</strong> events ‚Äî prior probabilities must sum to 1</li>
        <li>Assess the <strong>likelihood</strong> P(Information | Event) for each event</li>
        <li>Compute <strong>P(Information)</strong> via the total probability rule: Œ£ P(Info|E·µ¢)¬∑P(E·µ¢)</li>
        <li>Apply Bayes' formula to each event: <strong>Posterior = [Likelihood / P(Info)] √ó Prior</strong></li>
        <li><strong>Verify</strong>: all posterior probabilities must sum to 1</li>
      </ol>
    </div>

    <hr class="s-divider">

    <!-- Diffuse Priors & Multiplier Table -->
    <div class="s-header">
      <div class="s-icon">‚öñÔ∏è</div>
      <h2><span>Section 3 ‚Äî LO 3</span>How the Bayes' Multiplier Works</h2>
    </div>
    <table class="cmp-table">
      <thead><tr><th>Condition</th><th>Bayes' Multiplier = P(Info|Event) / P(Info)</th><th>Effect on Prior</th></tr></thead>
      <tbody>
        <tr><td>Information is <strong>much more likely</strong> given this event</td><td>&gt; 1</td><td>Posterior &gt; Prior ‚Äî probability <strong>increases</strong></td></tr>
        <tr><td>Information is <strong>equally likely</strong> regardless of event</td><td>= 1</td><td>Posterior = Prior ‚Äî information is <strong>irrelevant</strong></td></tr>
        <tr><td>Information is <strong>much less likely</strong> given this event</td><td>&lt; 1</td><td>Posterior &lt; Prior ‚Äî probability <strong>decreases</strong></td></tr>
        <tr><td><strong>Diffuse (equal) priors</strong> across all events</td><td>Simplifies to P(Info|Event)</td><td>Posterior = Likelihood; prior beliefs have no influence</td></tr>
      </tbody>
    </table>
    <div class="info-note blue" style="margin-top:12px"><strong>Diffuse priors special case:</strong> When all prior probabilities are equal (e.g., 1/3 each for three events), P(Information) = average of the likelihoods, and the posterior probability of each event equals its likelihood P(Info | Event). The new information alone drives the result.</div>

    <hr class="s-divider">

    <!-- Common Exam Pitfalls -->
    <div class="s-header">
      <div class="s-icon">‚ö°</div>
      <h2><span>Common Pitfalls</span>Exam Traps to Avoid</h2>
    </div>
    <div class="src-grid">
      <div class="src-card"><div class="src-card-hd">‚ùå Confusing E(X) with Sample Mean</div><ul class="src-items"><li>E(X) is a forward-looking probability-weighted forecast (population concept)</li><li>Sample mean is an equally weighted average of past observations (historical)</li><li>Do not substitute the sample mean for E(X) in variance calculations</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Terminal Node Probability Errors</div><ul class="src-items"><li>Terminal probability = P(scenario) √ó P(outcome | scenario)</li><li>Do not use the conditional probability alone as the terminal probability</li><li>All terminal node probabilities must sum to 1 ‚Äî use this as a check</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Skipping P(Information) Calculation</div><ul class="src-items"><li>Bayes' requires P(Information) as the normalising denominator</li><li>It must be calculated via the total probability rule across all scenarios</li><li>This is the most commonly missed step in Bayes' exam questions</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Non-Exhaustive Event Lists</div><ul class="src-items"><li>All events must be mutually exclusive AND exhaustive</li><li>If prior probabilities don't sum to 1, the problem setup is incorrect</li><li>Posterior probabilities must also sum to 1 ‚Äî always verify at the end</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Reversing P(A|B) and P(B|A)</div><ul class="src-items"><li>P(EPS beats | expands) ‚â† P(expands | EPS beats) ‚Äî order matters critically</li><li>Bayes' formula reverses the conditioning: it converts likelihoods into posteriors</li><li>The entire purpose of Bayes' is this "inverse probability" interpretation</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Conditional Variance Uses Wrong Mean</div><ul class="src-items"><li>œÉ¬≤(X|S) must use E(X|S) ‚Äî not overall E(X) ‚Äî as the deviation reference</li><li>The unconditional variance is NOT simply the weighted average of conditional variances</li><li>The full law of total variance is a more advanced topic beyond this reading</li></ul></div>
    </div>

    <div class="takeaway">
      <h3>Core Mindset for Probability Trees and Conditional Expectations</h3>
      <p>The two key ideas in this reading are deeply connected. <strong>Probability trees</strong> are a structured way to compute unconditional expected values by decomposing a problem into conditional scenarios ‚Äî work left to right to assign probabilities at each branch, then right to left to aggregate conditional expected values into a single unconditional forecast at the root. <strong>Bayes' formula</strong> is the mathematically rigorous mechanism for updating beliefs when new information arrives: multiply the prior probability by the ratio of how likely the observed information is under that specific event versus overall. The two tools complement each other perfectly ‚Äî trees visualize the forward-looking structure of a problem, while Bayes' provides the engine for backward inference from observation to cause. On the exam, set up the mutually exclusive and exhaustive event list carefully, verify that prior probabilities sum to 1, compute P(Information) via the total probability rule, apply the formula, and always confirm that posteriors sum to 1 as a final check.</p>
    </div>

  </div><!-- /.sum-body -->
  </div><!-- /#sum-qm-4 -->


  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       QM ¬∑ READING 5 ‚Äî PORTFOLIO MATHEMATICS
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="sum-qm-5" class="sum-chapter" style="display:none">
  <div class="sum-hero">
    <div class="sum-hero-label">2026 CFA¬Æ Program ¬∑ Level I ¬∑ QM Reading 5</div>
    <h1>Portfolio <em>Mathematics</em></h1>
    <div class="sum-hero-tags">
      <span class="sum-hero-tag">3 Learning Outcomes</span>
      <span class="sum-hero-tag">Portfolio Expected Return</span>
      <span class="sum-hero-tag">Portfolio Variance</span>
      <span class="sum-hero-tag">Covariance &amp; Correlation</span>
      <span class="sum-hero-tag">Joint Probability Function</span>
      <span class="sum-hero-tag">Safety-First Ratio</span>
      <span class="sum-hero-tag">Roy's Criterion</span>
    </div>
  </div>

  <div class="sum-body">

    <!-- Learning Outcomes -->
    <div class="s-header">
      <div class="s-icon">üéØ</div>
      <h2><span>Learning Outcomes</span>What You Need to Master</h2>
    </div>
    <div class="lo-list">
      <div class="lo-item"><span class="lo-pill">LO 1</span><span class="lo-text">Calculate and interpret the <strong>expected value, variance, standard deviation, covariances, and correlations</strong> of portfolio returns</span></div>
      <div class="lo-item"><span class="lo-pill">LO 2</span><span class="lo-text">Calculate and interpret the <strong>covariance and correlation of portfolio returns</strong> using a joint probability function for returns</span></div>
      <div class="lo-item"><span class="lo-pill">LO 3</span><span class="lo-text">Define <strong>shortfall risk</strong>, calculate the <strong>safety-first ratio</strong>, and identify an optimal portfolio using <strong>Roy's safety-first criterion</strong></span></div>
    </div>

    <hr class="s-divider">

    <!-- Portfolio Expected Return -->
    <div class="s-header">
      <div class="s-icon">üìà</div>
      <h2><span>Section 1 ‚Äî LO 1</span>Portfolio Expected Return</h2>
    </div>
    <div class="info-note gold"><strong>Core formula:</strong> E(Rp) = w‚ÇÅE(R‚ÇÅ) + w‚ÇÇE(R‚ÇÇ) + ‚Ä¶ + w‚ÇôE(R‚Çô) = Œ£ w·µ¢E(R·µ¢). Portfolio expected return is simply the <strong>weighted average</strong> of individual asset expected returns. The weights w·µ¢ are the proportions of the portfolio invested in each asset and must sum to 1.</div>
    <div class="audit-list" style="margin-top:16px">
      <div class="audit-item"><div class="audit-dot" style="background:#1a3a8f"></div><div><h4>Two-Asset Portfolio</h4><p>E(Rp) = w‚ÇÅE(R‚ÇÅ) + (1 ‚àí w‚ÇÅ)E(R‚ÇÇ). As w‚ÇÅ increases from 0 to 1, expected return moves linearly between E(R‚ÇÇ) and E(R‚ÇÅ). No need for covariance to compute expected return.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b98a1c"></div><div><h4>n-Asset Portfolio</h4><p>E(Rp) = Œ£ w·µ¢E(R·µ¢). Weights can be positive (long positions) or negative (short positions). The formula holds exactly regardless of the number of assets or correlations between them.</p></div></div>
    </div>

    <hr class="s-divider">

    <!-- Covariance and Correlation -->
    <div class="s-header">
      <div class="s-icon">üîó</div>
      <h2><span>Section 1 ‚Äî LO 1</span>Covariance and Correlation</h2>
    </div>
    <div class="phases-table">
      <div class="phase-row"><div class="phase-n">1</div><div class="phase-body"><div class="phase-title">Covariance ‚Äî Cov(R·µ¢, R‚±º)</div><div class="phase-desc">The probability-weighted average of cross-products of deviations from expected values. Measures the direction of co-movement between two returns. Can be negative (inverse), zero (unrelated), or positive (moves together). Units are returns squared. Own covariance = variance: Cov(R,R) = œÉ¬≤(R).</div><span class="phase-out">Cov(R·µ¢,R‚±º) = E[(R·µ¢ ‚àí E(R·µ¢))(R‚±º ‚àí E(R‚±º))]</span></div></div>
      <div class="phase-row"><div class="phase-n">2</div><div class="phase-body"><div class="phase-title">Correlation ‚Äî œÅ(R·µ¢, R‚±º)</div><div class="phase-desc">Covariance standardised by the product of standard deviations. Ranges from ‚àí1 (perfect inverse) to +1 (perfect positive). Scale-free ‚Äî allows comparison across different asset pairs. Key relationship: Cov(R·µ¢,R‚±º) = œÅ(R·µ¢,R‚±º) ¬∑ œÉ(R·µ¢) ¬∑ œÉ(R‚±º). This rearrangement is essential for computing covariance from correlation inputs.</div><span class="phase-out">œÅ(R·µ¢,R‚±º) = Cov(R·µ¢,R‚±º) / [œÉ(R·µ¢) ¬∑ œÉ(R‚±º)] ‚Üí range: [‚àí1, +1]</span></div></div>
      <div class="phase-row"><div class="phase-n">3</div><div class="phase-body"><div class="phase-title">Covariance Matrix</div><div class="phase-desc">An n √ó n matrix where diagonal entries are variances (œÉ¬≤) and off-diagonal entries are covariances. The matrix is symmetric: Cov(R·µ¢,R‚±º) = Cov(R‚±º,R·µ¢). For n assets: n variance terms + n(n‚àí1)/2 unique covariances. As n grows, covariance terms vastly outnumber variance terms (e.g., 20 assets ‚Üí 20 variances but 190 unique covariances).</div><span class="phase-out">‚Üí n¬≤ total entries; n diagonal (variances); n(n‚àí1)/2 unique off-diagonal covariances</span></div></div>
    </div>
    <div class="info-note blue"><strong>Key insight on diversification:</strong> As correlations between assets decrease toward ‚àí1, portfolio variance decreases while expected return is unchanged. This is the fundamental benefit of diversification ‚Äî the same reward at lower risk. When œÅ = +1, there is no diversification benefit.</div>

    <hr class="s-divider">

    <!-- Portfolio Variance -->
    <div class="s-header">
      <div class="s-icon">üìê</div>
      <h2><span>Section 1 ‚Äî LO 1</span>Portfolio Variance</h2>
    </div>
    <div class="info-note gold" style="margin-bottom:16px"><strong>General formula (n assets):</strong> œÉ¬≤(Rp) = Œ£·µ¢ Œ£‚±º w·µ¢ w‚±º Cov(R·µ¢,R‚±º). Every pair of assets (including each asset with itself) contributes. Diagonal pairs (i = j) contribute the variance terms w¬≤·µ¢ œÉ¬≤·µ¢; off-diagonal pairs contribute 2 w·µ¢ w‚±º Cov(R·µ¢,R‚±º) (the factor of 2 comes from symmetry).</div>
    <table class="cmp-table">
      <thead><tr><th>Portfolio Size</th><th>Expanded Formula</th><th>Unique Covariance Terms</th></tr></thead>
      <tbody>
        <tr><td><strong>2 Assets</strong></td><td>w‚ÇÅ¬≤œÉ‚ÇÅ¬≤ + w‚ÇÇ¬≤œÉ‚ÇÇ¬≤ + 2w‚ÇÅw‚ÇÇCov(R‚ÇÅ,R‚ÇÇ)</td><td>1</td></tr>
        <tr><td><strong>3 Assets</strong></td><td>w‚ÇÅ¬≤œÉ‚ÇÅ¬≤ + w‚ÇÇ¬≤œÉ‚ÇÇ¬≤ + w‚ÇÉ¬≤œÉ‚ÇÉ¬≤ + 2w‚ÇÅw‚ÇÇCov‚ÇÅ‚ÇÇ + 2w‚ÇÅw‚ÇÉCov‚ÇÅ‚ÇÉ + 2w‚ÇÇw‚ÇÉCov‚ÇÇ‚ÇÉ</td><td>3</td></tr>
        <tr><td><strong>n Assets</strong></td><td>Œ£·µ¢ Œ£‚±º w·µ¢w‚±ºCov(R·µ¢,R‚±º)</td><td>n(n‚àí1)/2</td></tr>
      </tbody>
    </table>
    <div class="info-note blue" style="margin-top:12px"><strong>Correlation substitute:</strong> Since Cov(R·µ¢,R‚±º) = œÅ·µ¢‚±º ¬∑ œÉ·µ¢ ¬∑ œÉ‚±º, the two-asset portfolio variance can be written as: œÉ¬≤(Rp) = w‚ÇÅ¬≤œÉ‚ÇÅ¬≤ + w‚ÇÇ¬≤œÉ‚ÇÇ¬≤ + 2w‚ÇÅw‚ÇÇœÅ‚ÇÅ‚ÇÇœÉ‚ÇÅœÉ‚ÇÇ. This form is commonly used in exam questions that give correlation instead of covariance.</div>

    <hr class="s-divider">

    <!-- Joint Probability Function -->
    <div class="s-header">
      <div class="s-icon">üé≤</div>
      <h2><span>Section 2 ‚Äî LO 2</span>Covariance via Joint Probability Function</h2>
    </div>
    <div class="phases-table">
      <div class="phase-row"><div class="phase-n">1</div><div class="phase-body"><div class="phase-title">Joint Probability Function P(X, Y)</div><div class="phase-desc">Gives the probability of simultaneously observing specific values of two random variables. For example, P(R‚Çê = 25%, R_b = 20%) = 0.20 means there is a 20% probability that asset A returns 25% AND asset B returns 20% in the same period. All joint probabilities must sum to 1.</div><span class="phase-out">‚Üí Used when historical data is unavailable and scenarios are modelled directly</span></div></div>
      <div class="phase-row"><div class="phase-n">2</div><div class="phase-body"><div class="phase-title">Computing Covariance from Joint Probabilities</div><div class="phase-desc">First compute E(R‚Çê) and E(R_b) using the marginal probabilities. Then, for each joint outcome, compute the product of deviations from expected values, weight by the joint probability, and sum all terms. This approach is especially useful for stress-testing under discrete scenarios.</div><span class="phase-out">Cov(R‚Çê,R_b) = Œ£·µ¢ Œ£‚±º P(R‚Çê·µ¢, R_b‚±º) ¬∑ (R‚Çê·µ¢ ‚àí E(R‚Çê)) ¬∑ (R_b‚±º ‚àí E(R_b))</span></div></div>
      <div class="phase-row"><div class="phase-n">3</div><div class="phase-body"><div class="phase-title">Independent Random Variables</div><div class="phase-desc">Two variables X and Y are independent if and only if P(X,Y) = P(X) ¬∑ P(Y) for all values. Independence implies zero correlation, but zero correlation does NOT imply independence (independence is the stronger condition ‚Äî it rules out all relationships, not just linear ones). For uncorrelated variables: E(XY) = E(X) ¬∑ E(Y).</div><span class="phase-out">‚Üí Independence ‚Üí Uncorrelated, but Uncorrelated ‚â† Independent</span></div></div>
    </div>

    <hr class="s-divider">

    <!-- Safety-First -->
    <div class="s-header">
      <div class="s-icon">üõ°Ô∏è</div>
      <h2><span>Section 3 ‚Äî LO 3</span>Shortfall Risk &amp; Roy's Safety-First Criterion</h2>
    </div>
    <div class="phases-table">
      <div class="phase-row"><div class="phase-n">1</div><div class="phase-body"><div class="phase-title">Shortfall Risk</div><div class="phase-desc">The risk that portfolio return (or value) falls below a minimum acceptable threshold level R_L over some time horizon. Examples include a pension fund's assets falling below liabilities, or a client needing to preserve capital while making a withdrawal. It is a one-sided (downside-only) risk measure.</div><span class="phase-out">‚Üí R_L is determined by the client's specific liability or capital preservation need</span></div></div>
      <div class="phase-row"><div class="phase-n">2</div><div class="phase-body"><div class="phase-title">Safety-First Ratio (SFRatio)</div><div class="phase-desc">Measures how many standard deviations separate the expected portfolio return from the shortfall level. The higher the SFRatio, the lower the probability of falling below R_L (assuming normally distributed returns). When R_L = R·∂† (risk-free rate), SFRatio = Sharpe Ratio.</div><span class="phase-out">SFRatio = [E(Rp) ‚àí R_L] / œÉp</span></div></div>
      <div class="phase-row"><div class="phase-n">3</div><div class="phase-body"><div class="phase-title">Roy's Safety-First Criterion (Optimal Portfolio Selection)</div><div class="phase-desc">The safety-first optimal portfolio is the one that <em>minimises</em> the probability of falling below R_L, which is equivalent to <em>maximising</em> the SFRatio. Under normality, P(Rp &lt; R_L) = N(‚àíSFRatio). The portfolio with the highest SFRatio has the smallest left-tail probability below R_L.</div><span class="phase-out">‚Üí Step 1: Calculate SFRatio for each portfolio. Step 2: Select the portfolio with the highest SFRatio.</span></div></div>
    </div>
    <div class="info-note gold" style="margin-top:16px"><strong>Computing shortfall level R_L from a cash need:</strong> If a client with a portfolio of value V needs to withdraw amount W at year-end without invading principal, then R_L = W / V. For example, a GBP1,350,000 portfolio needing GBP50,000: R_L = 50,000 / 1,350,000 = 3.7%.</div>

    <hr class="s-divider">

    <!-- Key Formulas -->
    <div class="s-header">
      <div class="s-icon">üìã</div>
      <h2><span>Master Reference</span>All Key Formulas at a Glance</h2>
    </div>
    <table class="cmp-table">
      <thead><tr><th>Concept</th><th>Formula</th><th>Notes</th></tr></thead>
      <tbody>
        <tr><td>Portfolio Expected Return</td><td>E(Rp) = Œ£ w·µ¢ E(R·µ¢)</td><td>Weighted average; weights must sum to 1</td></tr>
        <tr><td>Covariance (population)</td><td>Cov(R·µ¢,R‚±º) = E[(R·µ¢‚àíE(R·µ¢))(R‚±º‚àíE(R‚±º))]</td><td>Forward-looking; can be negative, zero, or positive</td></tr>
        <tr><td>Covariance (sample)</td><td>Cov(R·µ¢,R‚±º) = Œ£(R·µ¢,‚Çú‚àíRÃÑ·µ¢)(R‚±º,‚Çú‚àíRÃÑ‚±º) / (n‚àí1)</td><td>Historical estimate; uses n‚àí1 divisor</td></tr>
        <tr><td>Covariance from correlation</td><td>Cov(R·µ¢,R‚±º) = œÅ·µ¢‚±º ¬∑ œÉ·µ¢ ¬∑ œÉ‚±º</td><td>Key rearrangement used in most exam questions</td></tr>
        <tr><td>Correlation</td><td>œÅ(R·µ¢,R‚±º) = Cov(R·µ¢,R‚±º) / [œÉ(R·µ¢)¬∑œÉ(R‚±º)]</td><td>Range: [‚àí1, +1]; scale-free</td></tr>
        <tr><td>Unique covariances (n assets)</td><td>n(n‚àí1)/2</td><td>e.g., 5 assets ‚Üí 10; 20 assets ‚Üí 190</td></tr>
        <tr><td>2-Asset Portfolio Variance</td><td>w‚ÇÅ¬≤œÉ‚ÇÅ¬≤ + w‚ÇÇ¬≤œÉ‚ÇÇ¬≤ + 2w‚ÇÅw‚ÇÇœÅ‚ÇÅ‚ÇÇœÉ‚ÇÅœÉ‚ÇÇ</td><td>Substitute Cov = œÅœÉ‚ÇÅœÉ‚ÇÇ for the covariance term</td></tr>
        <tr><td>3-Asset Portfolio Variance</td><td>Œ£w·µ¢¬≤œÉ·µ¢¬≤ + 2Œ£w·µ¢w‚±º Cov(R·µ¢,R‚±º) for i&lt;j</td><td>3 variance terms + 3 covariance cross-products</td></tr>
        <tr><td>n-Asset Portfolio Variance</td><td>œÉ¬≤(Rp) = Œ£·µ¢ Œ£‚±º w·µ¢w‚±º Cov(R·µ¢,R‚±º)</td><td>Most general form; diagonal terms are variances</td></tr>
        <tr><td>Covariance via Joint Prob.</td><td>Cov(R‚Çê,R_b) = Œ£·µ¢ Œ£‚±º P(R‚Çê·µ¢,R_b‚±º)(R‚Çê·µ¢‚àíE(R‚Çê))(R_b‚±º‚àíE(R_b))</td><td>Used when scenarios and joint probabilities are given</td></tr>
        <tr><td>Shortfall Level</td><td>R_L = Cash need / Portfolio value</td><td>Minimum return to avoid invading principal</td></tr>
        <tr><td>Safety-First Ratio</td><td>SFRatio = [E(Rp) ‚àí R_L] / œÉp</td><td>Higher SFRatio ‚Üí lower probability of shortfall</td></tr>
        <tr><td>Shortfall Probability</td><td>P(Rp &lt; R_L) = N(‚àíSFRatio)</td><td>Assumes normally distributed portfolio returns</td></tr>
        <tr><td>SFRatio = Sharpe Ratio when</td><td>R_L = R·∂† (risk-free rate)</td><td>Sharpe ratio minimises P(Rp &lt; R·∂†)</td></tr>
      </tbody>
    </table>

    <hr class="s-divider">

    <!-- Diversification insight -->
    <div class="s-header">
      <div class="s-icon">üí°</div>
      <h2><span>Key Insight</span>Diversification and the Role of Correlation</h2>
    </div>
    <table class="cmp-table">
      <thead><tr><th>Correlation œÅ</th><th>Portfolio Variance Effect</th><th>Diversification Benefit</th></tr></thead>
      <tbody>
        <tr><td>œÅ = +1 (perfect positive)</td><td>œÉp = w‚ÇÅœÉ‚ÇÅ + w‚ÇÇœÉ‚ÇÇ (weighted average of std devs)</td><td>None ‚Äî portfolio risk = weighted average of individual risks</td></tr>
        <tr><td>0 &lt; œÅ &lt; +1</td><td>œÉp &lt; w‚ÇÅœÉ‚ÇÅ + w‚ÇÇœÉ‚ÇÇ</td><td>Partial ‚Äî some risk reduction from combining assets</td></tr>
        <tr><td>œÅ = 0 (uncorrelated)</td><td>œÉp¬≤ = w‚ÇÅ¬≤œÉ‚ÇÅ¬≤ + w‚ÇÇ¬≤œÉ‚ÇÇ¬≤</td><td>Significant ‚Äî covariance terms drop out entirely</td></tr>
        <tr><td>‚àí1 &lt; œÅ &lt; 0</td><td>œÉp further reduced</td><td>Large ‚Äî negative co-movements cancel out risk</td></tr>
        <tr><td>œÅ = ‚àí1 (perfect inverse)</td><td>œÉp can = 0 with right weights</td><td>Maximum ‚Äî portfolio can be made risk-free</td></tr>
      </tbody>
    </table>
    <div class="info-note blue" style="margin-top:12px"><strong>Why covariance dominates with more assets:</strong> For n = 2, there is 1 covariance vs 2 variances. For n = 10, there are 45 covariances vs 10 variances. For n = 100, there are 4,950 covariances vs 100 variances. As the portfolio grows, the average covariance between assets becomes the dominant driver of portfolio risk ‚Äî not individual asset variances.</div>

    <hr class="s-divider">

    <!-- Common Exam Pitfalls -->
    <div class="s-header">
      <div class="s-icon">‚ö°</div>
      <h2><span>Common Pitfalls</span>Exam Traps to Avoid</h2>
    </div>
    <div class="src-grid">
      <div class="src-card"><div class="src-card-hd">‚ùå Missing the Factor of 2 in Variance</div><ul class="src-items"><li>For two assets: œÉ¬≤(Rp) = w‚ÇÅ¬≤œÉ‚ÇÅ¬≤ + w‚ÇÇ¬≤œÉ‚ÇÇ¬≤ + <strong>2</strong>w‚ÇÅw‚ÇÇCov(R‚ÇÅ,R‚ÇÇ)</li><li>The double-counting arises because Cov(R‚ÇÅ,R‚ÇÇ) = Cov(R‚ÇÇ,R‚ÇÅ) ‚Äî each off-diagonal pair appears twice in the full summation</li><li>Forgetting the factor of 2 understates portfolio variance</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Confusing Covariance and Variance Inputs</div><ul class="src-items"><li>Covariance matrix diagonal = <strong>variances</strong> (œÉ¬≤), not standard deviations</li><li>To get œÉ from the diagonal: take the square root of the diagonal entry</li><li>Off-diagonal entries are already covariances ‚Äî do not square them</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Counting Covariance Terms</div><ul class="src-items"><li>For n assets: n¬≤ total entries, n variances, n(n‚àí1) off-diagonal, n(n‚àí1)/2 unique covariances</li><li>5 stocks ‚Üí 10 unique covariances (NOT 20 or 25)</li><li>Always divide off-diagonal count by 2 to get unique terms</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Safety-First: Wrong R_L or Wrong Sign</div><ul class="src-items"><li>R_L is the minimum return needed ‚Äî compute it as cash need / portfolio value</li><li>SFRatio = [E(Rp) ‚àí R_L] / œÉp ‚Äî higher is better (maximise, not minimise)</li><li>Probability of shortfall = N(‚àíSFRatio), not N(+SFRatio)</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Independence vs Uncorrelated</div><ul class="src-items"><li>Independence implies uncorrelated, but uncorrelated does NOT imply independence</li><li>For uncorrelated (or independent) variables: E(XY) = E(X)¬∑E(Y)</li><li>Two variables can have zero correlation but a strong non-linear relationship</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Expected Return vs Standard Deviation Tradeoff</div><ul class="src-items"><li>A portfolio with the highest expected return is NOT necessarily safety-first optimal</li><li>The SFRatio rewards higher E(Rp) AND lower œÉp relative to R_L ‚Äî both matter</li><li>A lower-return, lower-volatility portfolio can dominate a higher-return one under Roy's criterion</li></ul></div>
    </div>

    <div class="takeaway">
      <h3>Core Mindset for Portfolio Mathematics</h3>
      <p>This reading establishes the quantitative foundation of modern portfolio theory. Two fundamental ideas dominate. First, <strong>portfolio expected return is simply the weighted average of individual asset expected returns</strong> ‚Äî correlations and covariances play no role here. But <strong>portfolio variance is profoundly affected by covariances</strong>: as the portfolio grows, the average pairwise covariance between assets becomes the overwhelming driver of portfolio risk, dwarfing individual asset variances. The practical implication is that diversification ‚Äî adding assets with low or negative correlations ‚Äî reduces risk without sacrificing expected return. Second, <strong>Roy's safety-first criterion</strong> translates this framework into a practical decision rule for investors with minimum return constraints: choose the portfolio that maximises the safety-first ratio, which is simply the number of standard deviations between the expected return and the shortfall threshold. When returns are normally distributed, this portfolio minimises the probability of disaster. Recognising that the Sharpe ratio is a special case of the SFRatio (with the risk-free rate as the threshold) connects these two powerful tools.</p>
    </div>

  </div><!-- /.sum-body -->
  </div><!-- /#sum-qm-5 -->


  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       QM ¬∑ READING 6 ‚Äî SIMULATION METHODS
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="sum-qm-6" class="sum-chapter" style="display:none">
  <div class="sum-hero">
    <div class="sum-hero-label">2026 CFA¬Æ Program ¬∑ Level I ¬∑ QM Reading 6</div>
    <h1>Simulation <em>Methods</em></h1>
    <div class="sum-hero-tags">
      <span class="sum-hero-tag">3 Learning Outcomes</span>
      <span class="sum-hero-tag">Lognormal Distribution</span>
      <span class="sum-hero-tag">Continuously Compounded Returns</span>
      <span class="sum-hero-tag">Monte Carlo Simulation</span>
      <span class="sum-hero-tag">Bootstrap Resampling</span>
      <span class="sum-hero-tag">Volatility Estimation</span>
    </div>
  </div>

  <div class="sum-body">

    <!-- Learning Outcomes -->
    <div class="s-header">
      <div class="s-icon">üéØ</div>
      <h2><span>Learning Outcomes</span>What You Need to Master</h2>
    </div>
    <div class="lo-list">
      <div class="lo-item"><span class="lo-pill">LO 1</span><span class="lo-text">Explain the relationship between <strong>normal and lognormal distributions</strong> and why the lognormal distribution is used to model asset prices when using <strong>continuously compounded asset returns</strong></span></div>
      <div class="lo-item"><span class="lo-pill">LO 2</span><span class="lo-text">Describe <strong>Monte Carlo simulation</strong> and explain how it can be used in investment applications</span></div>
      <div class="lo-item"><span class="lo-pill">LO 3</span><span class="lo-text">Describe the use of <strong>bootstrap resampling</strong> in conducting a simulation based on observed data in investment applications</span></div>
    </div>

    <hr class="s-divider">

    <!-- Lognormal Distribution -->
    <div class="s-header">
      <div class="s-icon">üìä</div>
      <h2><span>Section 1 ‚Äî LO 1</span>The Lognormal Distribution</h2>
    </div>
    <div class="info-note gold"><strong>Definition:</strong> A random variable Y is lognormally distributed if its natural logarithm ln(Y) is normally distributed. Conversely, if X is normal and Y = exp(X), then Y is lognormal. Think of it as: <em>"the log is normal."</em></div>
    <div class="phases-table" style="margin-top:16px">
      <div class="phase-row"><div class="phase-n">1</div><div class="phase-body"><div class="phase-title">Bounded Below by Zero</div><div class="phase-desc">Lognormal random variables cannot take negative values. This is critical for modelling asset prices ‚Äî a stock price can fall toward zero but can never go below it. Normal distributions allow negative values, making them unsuitable as a direct model for prices.</div><span class="phase-out">‚Üí P(Y &lt; 0) = 0 for any lognormal variable Y</span></div></div>
      <div class="phase-row"><div class="phase-n">2</div><div class="phase-body"><div class="phase-title">Right-Skewed (Long Right Tail)</div><div class="phase-desc">Lognormal distributions are skewed to the right. The upside for asset prices is theoretically unlimited (a stock can rise many multiples), but the downside is capped at zero. This asymmetry creates the characteristic long right tail seen in the lognormal distribution and in empirical asset price data.</div><span class="phase-out">‚Üí Skewness &gt; 0; mean &gt; median &gt; mode</span></div></div>
      <div class="phase-row"><div class="phase-n">3</div><div class="phase-body"><div class="phase-title">Two Parameters (from the Underlying Normal)</div><div class="phase-desc">A lognormal distribution is fully described by the mean (Œº) and variance (œÉ¬≤) of its associated normal distribution ‚Äî these are the parameters of ln(Y), not Y itself. Keep track of both sets: the parameters of the normal (Œº, œÉ¬≤) and the mean and variance of the lognormal variable Y.</div><span class="phase-out">‚Üí Mean of Y = exp(Œº + 0.5œÉ¬≤); Variance of Y = exp(2Œº + œÉ¬≤) √ó [exp(œÉ¬≤) ‚àí 1]</span></div></div>
    </div>
    <div class="info-note blue" style="margin-top:12px"><strong>Why is the lognormal mean larger than exp(Œº)?</strong> As œÉ¬≤ increases, the distribution spreads out. Because it is bounded below by 0, it can only spread upward ‚Äî pushing the mean to the right. The lognormal mean exp(Œº + 0.5œÉ¬≤) is always greater than exp(Œº) by a factor of exp(0.5œÉ¬≤) &gt; 1.</div>

    <hr class="s-divider">

    <!-- Lognormal Mean and Variance Formulas -->
    <div class="s-header">
      <div class="s-icon">üìê</div>
      <h2><span>Section 1 ‚Äî LO 1</span>Lognormal Mean &amp; Variance Formulas</h2>
    </div>
    <table class="cmp-table">
      <thead><tr><th>Parameter</th><th>Formula</th><th>Notes</th></tr></thead>
      <tbody>
        <tr><td>Mean of lognormal Y</td><td>Œº<sub>L</sub> = exp(Œº + 0.5œÉ¬≤)</td><td>Œº, œÉ¬≤ are the mean and variance of ln(Y)</td></tr>
        <tr><td>Variance of lognormal Y</td><td>œÉ¬≤<sub>L</sub> = exp(2Œº + œÉ¬≤) √ó [exp(œÉ¬≤) ‚àí 1]</td><td>Increases rapidly as œÉ¬≤ grows</td></tr>
        <tr><td>Future price from return</td><td>P<sub>T</sub> = P<sub>0</sub> ¬∑ exp(r<sub>0,T</sub>)</td><td>r<sub>0,T</sub> is the continuously compounded return</td></tr>
      </tbody>
    </table>

    <hr class="s-divider">

    <!-- Continuously Compounded Returns -->
    <div class="s-header">
      <div class="s-icon">üîÑ</div>
      <h2><span>Section 1 ‚Äî LO 1</span>Continuously Compounded Returns</h2>
    </div>
    <div class="info-note gold"><strong>Core relationship:</strong> If a stock's continuously compounded return r<sub>0,T</sub> is normally distributed, then the future stock price P<sub>T</sub> = P<sub>0</sub> ¬∑ exp(r<sub>0,T</sub>) is lognormally distributed. This is the theoretical foundation for using the lognormal model in finance.</div>
    <div class="audit-list" style="margin-top:16px">
      <div class="audit-item"><div class="audit-dot" style="background:#1a3a8f"></div><div><h4>Multi-Period Return is a Sum</h4><p>The T-period continuously compounded return r<sub>0,T</sub> equals the sum of one-period returns: r<sub>0,T</sub> = r<sub>T‚àí1,T</sub> + r<sub>T‚àí2,T‚àí1</sub> + ‚Ä¶ + r<sub>0,1</sub>. If one-period returns are i.i.d. normal, their sum is also normal, so r<sub>0,T</sub> is normal and P<sub>T</sub> is lognormal.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b98a1c"></div><div><h4>Mean and Variance Scale Linearly with T</h4><p>E(r<sub>0,T</sub>) = ŒºT and œÉ¬≤(r<sub>0,T</sub>) = œÉ¬≤T (from the i.i.d. assumption). Standard deviation scales as œÉ‚àöT ‚Äî the square-root-of-time rule. This is foundational in risk management and options pricing.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#1a7a4a"></div><div><h4>Central Limit Theorem Backup</h4><p>Even if individual period returns are not normally distributed, their sum r<sub>0,T</sub> is approximately normal by the Central Limit Theorem when T is large. This justifies the lognormal model for prices even when returns are not perfectly normal.</p></div></div>
    </div>

    <hr class="s-divider">

    <!-- Volatility Estimation -->
    <div class="s-header">
      <div class="s-icon">üìâ</div>
      <h2><span>Section 1 ‚Äî LO 1</span>Estimating Volatility from Historical Returns</h2>
    </div>
    <div class="info-note gold"><strong>Annualizing volatility:</strong> œÉÃÇ<sub>annual</sub> = œÉÃÇ<sub>daily</sub> √ó ‚àö250. Financial markets typically have ‚âà250 trading days per year. Volatility is the standard deviation of continuously compounded returns, always quoted on an annualised basis.</div>
    <div class="phases-table" style="margin-top:14px">
      <div class="phase-row"><div class="phase-n">1</div><div class="phase-body"><div class="phase-title">Step 1 ‚Äî Compute Daily Continuously Compounded Returns</div><div class="phase-desc">For each day t, calculate r<sub>t</sub> = ln(P<sub>t</sub> / P<sub>t‚àí1</sub>). This converts holding-period price changes into continuously compounded daily returns. Use natural logarithm (ln), not log base 10.</div><span class="phase-out">‚Üí r<sub>t</sub> = ln(P<sub>t</sub> / P<sub>t‚àí1</sub>)</span></div></div>
      <div class="phase-row"><div class="phase-n">2</div><div class="phase-body"><div class="phase-title">Step 2 ‚Äî Compute Sample Standard Deviation</div><div class="phase-desc">Calculate the mean of the daily returns, then the sample standard deviation using divisor (n ‚àí 1). This is œÉÃÇ<sub>daily</sub>, the sample estimate of one-period volatility.</div><span class="phase-out">‚Üí œÉÃÇ<sub>daily</sub> = sample std dev of {r<sub>1</sub>, r<sub>2</sub>, ‚Ä¶, r<sub>n</sub>}</span></div></div>
      <div class="phase-row"><div class="phase-n">3</div><div class="phase-body"><div class="phase-title">Step 3 ‚Äî Annualise Using the Square-Root Rule</div><div class="phase-desc">Multiply daily volatility by ‚àö250 to obtain annualised volatility. For example, if œÉÃÇ<sub>daily</sub> = 0.021261, then annualised volatility = 0.021261 √ó ‚àö250 = 0.3362 = 33.6%. This follows directly from œÉ¬≤(r<sub>0,T</sub>) = œÉ¬≤T.</div><span class="phase-out">‚Üí œÉÃÇ<sub>annual</sub> = œÉÃÇ<sub>daily</sub> √ó ‚àö250 ‚âà œÉÃÇ<sub>daily</sub> √ó 15.81</span></div></div>
    </div>
    <div class="info-note blue" style="margin-top:12px"><strong>Key exam note:</strong> Always annualise based on <strong>250 trading days</strong>, not 365 calendar days. The mean continuously compounded annual return is estimated as ŒºÃÇ √ó 250 (where ŒºÃÇ is the sample mean of daily returns), but with only a few days of data this estimate is extremely unreliable ‚Äî the variance in daily returns overwhelms the signal in expected return.</div>

    <hr class="s-divider">

    <!-- Monte Carlo Simulation -->
    <div class="s-header">
      <div class="s-icon">üé≤</div>
      <h2><span>Section 2 ‚Äî LO 2</span>Monte Carlo Simulation</h2>
    </div>
    <div class="info-note gold"><strong>Definition:</strong> Monte Carlo simulation generates a large number of random samples from a specified probability distribution (or distributions) to obtain the likelihood of a range of results. It is used when analytical solutions are unavailable or impractical.</div>
    <div class="audit-list" style="margin-top:16px">
      <div class="audit-item"><div class="audit-dot" style="background:#1a3a8f"></div><div><h4>Investment Risk &amp; Return Estimation</h4><p>Simulate portfolio profit and loss over a specified horizon ‚Äî either asset-by-asset or at the aggregate portfolio level. Repeated trials produce a simulated frequency distribution of returns from which performance and risk measures (VaR, CVaR, expected return) are derived.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b98a1c"></div><div><h4>Valuing Complex Securities</h4><p>Monte Carlo is particularly valuable for securities with complex embedded options (e.g., mortgage-backed securities, Asian options, lookback options) where no closed-form analytical pricing formula exists. The analyst controls assumptions and can test model sensitivity.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#8b1a1a"></div><div><h4>Sensitivity &amp; Scenario Analysis</h4><p>Because the analyst specifies all inputs, Monte Carlo is ideal for "what-if" analysis ‚Äî examining how changes in key distributional assumptions (mean, volatility, correlation) affect outcomes. This makes it a powerful complement to analytical models.</p></div></div>
    </div>

    <hr class="s-divider">

    <!-- Monte Carlo Steps -->
    <div class="s-header">
      <div class="s-icon">‚öôÔ∏è</div>
      <h2><span>Section 2 ‚Äî LO 2</span>Six Steps of Monte Carlo Simulation</h2>
    </div>
    <div class="phases-table">
      <div class="phase-row"><div class="phase-n">1</div><div class="phase-body"><div class="phase-title">Specify the Quantity of Interest</div><div class="phase-desc">Define what you are trying to value or estimate (e.g., value of a contingent claim C<sub>iT</sub>) and identify the underlying variables (e.g., stock price). Specify the starting values of all underlying variables.</div><span class="phase-out">‚Üí e.g., Asian option value = max(Final Price ‚àí Average Price, 0)</span></div></div>
      <div class="phase-row"><div class="phase-n">2</div><div class="phase-body"><div class="phase-title">Specify a Time Grid</div><div class="phase-desc">Divide the total horizon into K sub-periods. The time increment Œît = Calendar time / K. For a 1-year option simulated monthly: K = 12, Œît = 1 month. The granularity of the time grid affects accuracy and computation time.</div><span class="phase-out">‚Üí Œît = T / K; e.g., 1 year √∑ 12 months = 1/12 year per step</span></div></div>
      <div class="phase-row"><div class="phase-n">3</div><div class="phase-body"><div class="phase-title">Specify Distributional Assumptions &amp; Draw Random Numbers</div><div class="phase-desc">Choose a model for the key risk factor and its distribution. For stock prices, a standard model is: ŒîStock price = (Œº √ó Prior price √ó Œît) + (œÉ √ó Prior price √ó Z<sub>k</sub>), where Z<sub>k</sub> ~ N(0,1). Draw K random values of Z<sub>k</sub> per simulation trial.</div><span class="phase-out">‚Üí ŒîS = ŒºS¬∑Œît + œÉS¬∑Z<sub>k</sub>; draw K standard normal values per trial</span></div></div>
      <div class="phase-row"><div class="phase-n">4</div><div class="phase-body"><div class="phase-title">Convert Random Numbers to Asset Price Path</div><div class="phase-desc">Use the drawn random numbers and the stock price model to generate a sequence of K stock prices for the trial. Starting from P<sub>0</sub>, apply ŒîStock price at each sub-period to build the full price path.</div><span class="phase-out">‚Üí Produces one simulated price path: P<sub>0</sub>, P<sub>1</sub>, ‚Ä¶, P<sub>K</sub></span></div></div>
      <div class="phase-row"><div class="phase-n">5</div><div class="phase-body"><div class="phase-title">Calculate the Payoff for This Trial</div><div class="phase-desc">For each simulated price path, compute the average stock price and the value of the contingent claim at maturity C<sub>iT</sub>. Then discount to t = 0 to get C<sub>i0</sub>. This completes one simulation trial (one iteration).</div><span class="phase-out">‚Üí C<sub>iT</sub> = max(P<sub>K</sub> ‚àí avg(P<sub>1</sub>‚Ä¶P<sub>K</sub>), 0); C<sub>i0</sub> = PV(C<sub>iT</sub>)</span></div></div>
      <div class="phase-row"><div class="phase-n">6</div><div class="phase-body"><div class="phase-title">Repeat &amp; Compute Summary Statistics</div><div class="phase-desc">Repeat Steps 4‚Äì5 for the required number of trials (e.g., I = 1,000). The Monte Carlo estimate of the security's value is the mean of all C<sub>i0</sub> values across all trials. Other statistics (std dev, percentiles) characterise the distribution of outcomes.</div><span class="phase-out">‚Üí Monte Carlo value = (1/I) √ó Œ£C<sub>i0</sub> over all I trials</span></div></div>
    </div>

    <hr class="s-divider">

    <!-- Strengths and Weaknesses of Monte Carlo -->
    <div class="s-header">
      <div class="s-icon">‚öñÔ∏è</div>
      <h2><span>Section 2 ‚Äî LO 2</span>Monte Carlo: Strengths vs. Weaknesses</h2>
    </div>
    <table class="cmp-table">
      <thead><tr><th>Dimension</th><th>Strengths</th><th>Weaknesses</th></tr></thead>
      <tbody>
        <tr><td>Applicability</td><td>Handles complex securities with no closed-form solution (Asian options, MBS, lookbacks)</td><td>Overkill for simple securities with analytical solutions</td></tr>
        <tr><td>Accuracy</td><td>Can be made very accurate by increasing the number of trials</td><td>Provides only statistical estimates, not exact results</td></tr>
        <tr><td>Insight</td><td>Excellent for sensitivity and scenario analysis ‚Äî analyst controls all inputs</td><td>Cannot independently reveal cause-and-effect relationships (unlike analytical methods)</td></tr>
        <tr><td>Data requirements</td><td>Works with assumed distributions; no historical data required</td><td>Results are only as good as the distributional assumptions made</td></tr>
        <tr><td>Computation</td><td>Scalable to multiple risk factors and complex path dependencies</td><td>Computationally intensive for large numbers of trials or complex models</td></tr>
      </tbody>
    </table>

    <hr class="s-divider">

    <!-- Bootstrap -->
    <div class="s-header">
      <div class="s-icon">üîÅ</div>
      <h2><span>Section 3 ‚Äî LO 3</span>Bootstrap Resampling</h2>
    </div>
    <div class="info-note gold"><strong>Core idea:</strong> Bootstrap mimics the process of drawing random samples from a population by instead sampling (with replacement) from the observed sample, treating it as a proxy for the population. It builds a sampling distribution empirically ‚Äî no distributional assumptions required.</div>
    <div class="phases-table" style="margin-top:16px">
      <div class="phase-row"><div class="phase-n">1</div><div class="phase-body"><div class="phase-title">Sampling With Replacement</div><div class="phase-desc">From an original sample of size n, repeatedly draw a new resample of size n. Crucially, each item drawn is returned before the next draw ‚Äî so the same observation can appear multiple times in one resample, and some observations may not appear at all. This is the defining feature of bootstrapping.</div><span class="phase-out">‚Üí Each bootstrap resample has the same size n as the original sample</span></div></div>
      <div class="phase-row"><div class="phase-n">2</div><div class="phase-body"><div class="phase-title">Empirical Distribution as Population Proxy</div><div class="phase-desc">Instead of specifying a theoretical distribution (as in Monte Carlo), bootstrap uses the observed historical data (e.g., past stock returns) as the empirical distribution. The quality of bootstrap inference depends on how representative the original sample is of the true population.</div><span class="phase-out">‚Üí No need to assume normality or any other parametric form</span></div></div>
      <div class="phase-row"><div class="phase-n">3</div><div class="phase-body"><div class="phase-title">Constructing the Bootstrap Sampling Distribution</div><div class="phase-desc">For each of B resamples, calculate the statistic of interest (mean, variance, skewness, etc.). The distribution of these B estimates forms the bootstrap sampling distribution, which approximates the true sampling distribution. Summary statistics of this distribution (mean, standard error, confidence intervals) are the bootstrap estimates.</div><span class="phase-out">‚Üí B bootstrap estimates ‚Üí sampling distribution ‚Üí population inference</span></div></div>
    </div>

    <hr class="s-divider">

    <!-- Monte Carlo vs Bootstrap Comparison -->
    <div class="s-header">
      <div class="s-icon">üîÑ</div>
      <h2><span>Key Comparison</span>Monte Carlo vs. Bootstrap</h2>
    </div>
    <table class="cmp-table">
      <thead><tr><th>Feature</th><th>Monte Carlo Simulation</th><th>Bootstrap Resampling</th></tr></thead>
      <tbody>
        <tr><td>Data source</td><td>Random draws from a <strong>specified theoretical distribution</strong></td><td>Random draws (with replacement) from <strong>observed historical data</strong></td></tr>
        <tr><td>Distributional assumption</td><td>Analyst specifies Œº, œÉ, distribution type (e.g., normal)</td><td>No parametric assumption ‚Äî uses empirical distribution</td></tr>
        <tr><td>Population knowledge</td><td>Known statistical parameters assumed</td><td>Population unknown; sample treated as population proxy</td></tr>
        <tr><td>Primary use</td><td>Valuing complex securities; risk estimation with assumed distributions</td><td>Estimating sampling distributions; inferring population parameters</td></tr>
        <tr><td>Output</td><td>Statistical estimates of security value or risk measures</td><td>Statistical estimates with empirically derived confidence intervals</td></tr>
        <tr><td>Common ground</td><td colspan="2" style="color:#1a3a8f;font-weight:600">Both rely on repetitive sampling; neither provides exact analytical results; both complement analytical methods</td></tr>
      </tbody>
    </table>
    <div class="info-note blue" style="margin-top:12px"><strong>Key distinction for the exam:</strong> In Monte Carlo, the analyst <em>specifies</em> the probability distribution for risk factors (requires distributional assumptions). In bootstrap, the analyst simply uses the observed historical data as the distribution ‚Äî no specification needed. Bootstrap Step 3 differs from Monte Carlo Step 3 in this exact way.</div>

    <hr class="s-divider">

    <!-- Key Formulas Reference -->
    <div class="s-header">
      <div class="s-icon">üìã</div>
      <h2><span>Master Reference</span>All Key Formulas at a Glance</h2>
    </div>
    <table class="cmp-table">
      <thead><tr><th>Concept</th><th>Formula</th><th>Notes</th></tr></thead>
      <tbody>
        <tr><td>Future stock price (continuous)</td><td>P<sub>T</sub> = P<sub>0</sub> ¬∑ exp(r<sub>0,T</sub>)</td><td>r<sub>0,T</sub> is the total continuously compounded return</td></tr>
        <tr><td>Multi-period return (sum)</td><td>r<sub>0,T</sub> = r<sub>0,1</sub> + r<sub>1,2</sub> + ‚Ä¶ + r<sub>T‚àí1,T</sub></td><td>Holds exactly for continuously compounded returns</td></tr>
        <tr><td>Expected return (i.i.d.)</td><td>E(r<sub>0,T</sub>) = ŒºT</td><td>Scales linearly with horizon T</td></tr>
        <tr><td>Variance of return (i.i.d.)</td><td>œÉ¬≤(r<sub>0,T</sub>) = œÉ¬≤T</td><td>From independence assumption; std dev scales as œÉ‚àöT</td></tr>
        <tr><td>Continuously compounded daily return</td><td>r<sub>t</sub> = ln(P<sub>t</sub> / P<sub>t‚àí1</sub>)</td><td>Natural log of the price relative</td></tr>
        <tr><td>Annualised volatility</td><td>œÉÃÇ<sub>annual</sub> = œÉÃÇ<sub>daily</sub> √ó ‚àö250</td><td>250 trading days per year convention</td></tr>
        <tr><td>Lognormal mean</td><td>Œº<sub>L</sub> = exp(Œº + 0.5œÉ¬≤)</td><td>Œº, œÉ¬≤ are parameters of the underlying normal</td></tr>
        <tr><td>Lognormal variance</td><td>œÉ¬≤<sub>L</sub> = exp(2Œº + œÉ¬≤) √ó [exp(œÉ¬≤) ‚àí 1]</td><td>Always reference, do not memorise</td></tr>
        <tr><td>Monte Carlo stock price model</td><td>ŒîS = Œº ¬∑ S ¬∑ Œît + œÉ ¬∑ S ¬∑ Z<sub>k</sub></td><td>Z<sub>k</sub> ~ N(0,1); Œº = drift; œÉ = volatility</td></tr>
        <tr><td>Asian option payoff</td><td>max(P<sub>Final</sub> ‚àí P<sub>Average</sub>, 0)</td><td>No analytical solution ‚Üí requires Monte Carlo</td></tr>
        <tr><td>Lookback option payoff</td><td>max(P<sub>Final</sub> ‚àí P<sub>Minimum</sub>, 0)</td><td>Path-dependent; no analytical solution</td></tr>
      </tbody>
    </table>

    <hr class="s-divider">

    <!-- Common Exam Pitfalls -->
    <div class="s-header">
      <div class="s-icon">‚ö°</div>
      <h2><span>Common Pitfalls</span>Exam Traps to Avoid</h2>
    </div>
    <div class="src-grid">
      <div class="src-card"><div class="src-card-hd">‚ùå Confusing Normal vs. Lognormal Model</div><ul class="src-items"><li>Returns ‚âà normal; prices ‚âà lognormal</li><li>Lognormal is used for prices because prices are bounded at 0; normal is used for returns because returns can be negative</li><li>The BSM model assumes lognormally distributed asset prices (not returns)</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Monte Carlo Provides Exact Values</div><ul class="src-items"><li>Monte Carlo gives <strong>statistical estimates</strong>, not exact results</li><li>The estimate improves with more trials but never becomes exact</li><li>Analytical methods (when available) are more precise and reveal cause-and-effect</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Bootstrap Draws From a New Distribution</div><ul class="src-items"><li>Bootstrap draws with replacement from the <strong>original observed sample</strong> ‚Äî it does not generate new data</li><li>It does NOT require specifying a distribution (unlike Monte Carlo)</li><li>Each resample has the same size as the original sample</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Using 365 Instead of 250 for Annualisation</div><ul class="src-items"><li>Financial markets are open ‚âà 250 trading days per year</li><li>Always annualise volatility by multiplying daily œÉ by ‚àö250</li><li>Using 365 overstates annualised volatility</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Multi-Period Continuously Compounded Returns</div><ul class="src-items"><li>r<sub>0,T</sub> is the <strong>sum</strong> of sub-period continuously compounded returns</li><li>This is different from holding-period returns, which compound multiplicatively</li><li>Only continuous returns add; discrete returns do not add directly</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Bootstrap vs. Monte Carlo Key Difference</div><ul class="src-items"><li>The critical difference is the data source: Monte Carlo uses theoretical distributions; bootstrap uses observed historical data</li><li>Exam questions often test whether you can identify which method requires distributional assumptions (Monte Carlo does; bootstrap does not)</li></ul></div>
    </div>

    <div class="takeaway">
      <h3>Core Mindset for Simulation Methods</h3>
      <p>This reading ties together two essential ideas. First, the <strong>lognormal distribution is the natural model for asset prices</strong> because continuously compounded returns are approximately normal (via the CLT and i.i.d. assumptions), and a lognormal variable is simply the exponential of a normal ‚Äî bounded below by zero with a long right tail that matches observed price behaviour. Second, when analytical formulas are unavailable ‚Äî as is the case for path-dependent options or complex structured products ‚Äî <strong>simulation fills the gap</strong>. Monte Carlo builds synthetic price paths from distributional assumptions; bootstrap builds them from historical data without any parametric assumptions. Both produce statistical estimates, not exact answers, and both complement rather than replace analytical methods when those methods exist.</p>
    </div>

  </div><!-- /.sum-body -->
  </div><!-- /#sum-qm-6 -->


  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       QM ¬∑ READING 7 ‚Äî ESTIMATION AND INFERENCE
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="sum-qm-7" class="sum-chapter" style="display:none">
  <div class="sum-hero">
    <div class="sum-hero-label">2026 CFA¬Æ Program ¬∑ Level I ¬∑ QM Reading 7</div>
    <h1>Estimation and <em>Inference</em></h1>
    <div class="sum-hero-tags">
      <span class="sum-hero-tag">3 Learning Outcomes</span>
      <span class="sum-hero-tag">Sampling Methods</span>
      <span class="sum-hero-tag">Sampling Error</span>
      <span class="sum-hero-tag">Central Limit Theorem</span>
      <span class="sum-hero-tag">Standard Error</span>
      <span class="sum-hero-tag">Bootstrap Resampling</span>
      <span class="sum-hero-tag">Jackknife</span>
    </div>
  </div>

  <div class="sum-body">

    <!-- Learning Outcomes -->
    <div class="s-header">
      <div class="s-icon">üéØ</div>
      <h2><span>Learning Outcomes</span>What You Need to Master</h2>
    </div>
    <div class="lo-list">
      <div class="lo-item"><span class="lo-pill">LO 1</span><span class="lo-text">Compare and contrast <strong>simple random, stratified random, cluster, convenience, and judgmental sampling</strong> and their implications for sampling error in an investment problem</span></div>
      <div class="lo-item"><span class="lo-pill">LO 2</span><span class="lo-text">Explain the <strong>central limit theorem</strong> and its importance for the distribution and standard error of the sample mean</span></div>
      <div class="lo-item"><span class="lo-pill">LO 3</span><span class="lo-text">Describe the use of <strong>resampling (bootstrap, jackknife)</strong> to estimate the sampling distribution of a statistic</span></div>
    </div>

    <hr class="s-divider">

    <!-- Sampling Overview -->
    <div class="s-header">
      <div class="s-icon">üìä</div>
      <h2><span>Section 1 ‚Äî LO 1</span>Why We Sample</h2>
    </div>
    <div class="info-note gold"><strong>Purpose of sampling:</strong> We sample either because it is impossible to examine every member of a population, or because doing so would not be economically efficient. The analyst trades time and money for sampling error.</div>
    <div class="phases-table" style="margin-top:14px">
      <div class="phase-row"><div class="phase-n">1</div><div class="phase-body"><div class="phase-title">Probability Sampling</div><div class="phase-desc">Every member of the population has an equal chance of being selected. Creates a representative sample and supports statistically valid inferences about population parameters. Generally yields higher accuracy and reliability than non-probability sampling.</div><span class="phase-out">‚Üí Includes: simple random, stratified random, cluster, systematic</span></div></div>
      <div class="phase-row"><div class="phase-n">2</div><div class="phase-body"><div class="phase-title">Non-Probability Sampling</div><div class="phase-desc">Selection depends on factors other than probability ‚Äî researcher judgment or data accessibility. Significant risk of producing a non-representative sample. Faster and cheaper, but less statistically rigorous. Suitable for pilot studies, time-constrained research, or when expert judgment is essential.</div><span class="phase-out">‚Üí Includes: convenience sampling, judgmental sampling</span></div></div>
      <div class="phase-row"><div class="phase-n">3</div><div class="phase-body"><div class="phase-title">Sampling Error</div><div class="phase-desc">The difference between the observed value of a statistic (e.g., sample mean) and the quantity it is intended to estimate (population mean), arising because only a subset of the population is observed. Sampling error decreases as sample size increases. Cannot be eliminated, only minimised.</div><span class="phase-out">‚Üí Sampling error = statistic ‚àí parameter; reduced by larger n</span></div></div>
    </div>

    <hr class="s-divider">

    <!-- Sampling Methods Detail -->
    <div class="s-header">
      <div class="s-icon">üóÇÔ∏è</div>
      <h2><span>Section 1 ‚Äî LO 1</span>Five Sampling Methods Compared</h2>
    </div>
    <table class="cmp-table">
      <thead><tr><th>Method</th><th>How It Works</th><th>Key Advantage</th><th>Key Limitation</th><th>Investment Example</th></tr></thead>
      <tbody>
        <tr><td><strong>Simple Random</strong></td><td>Each element has an equal probability of selection; drawn randomly from full population</td><td>Unbiased; statistically rigorous; easy to implement for homogeneous populations</td><td>May under-represent important subgroups; less efficient for heterogeneous populations</td><td>Survey of wireless equipment customers to estimate average capex spending</td></tr>
        <tr><td><strong>Stratified Random</strong></td><td>Population divided into strata by key characteristic; random samples drawn from each stratum proportional to its size</td><td>Guarantees representation of all subgroups; lower variance / greater precision than simple random</td><td>Requires knowledge of relevant strata in advance; more complex to implement</td><td>Bond index replication ‚Äî strata by duration, sector, credit quality, coupon level</td></tr>
        <tr><td><strong>Cluster</strong></td><td>Population divided into clusters (mini-representations of population); whole clusters randomly selected (one-stage) or subsampled (two-stage)</td><td>Most cost-efficient and time-efficient for large, geographically dispersed populations</td><td>Lower accuracy than other probability methods for the same sample size ‚Äî cluster sample may be less representative</td><td>Survey of individual investor sentiment across US states (clusters = states)</td></tr>
        <tr><td><strong>Systematic</strong></td><td>Select every kth member of the population until desired size is reached; starting point typically random</td><td>Simple to implement when population cannot be fully enumerated; approximates random sampling</td><td>Risk of periodicity bias if population has a regular pattern at interval k</td><td>Select every 5th pharmaceutical company from a commercial database</td></tr>
        <tr><td><strong>Convenience</strong></td><td>Elements selected based on accessibility or ease of collection for the researcher</td><td>Very fast and cheap; useful for preliminary/pilot research</td><td>High risk of non-representative sample; may introduce significant bias</td><td>Using an in-house database of a few dozen researched stocks as the sample</td></tr>
        <tr><td><strong>Judgmental</strong></td><td>Researcher handpicks elements based on expertise and professional knowledge</td><td>Leverages domain expertise; efficient when target population requires specialist knowledge to identify</td><td>Subject to researcher bias; results may not represent the full population</td><td>Auditor selecting transactions most likely to reveal material misstatement</td></tr>
      </tbody>
    </table>
    <div class="info-note blue" style="margin-top:12px"><strong>Cluster vs. Stratified ‚Äî critical distinction:</strong> In <strong>cluster sampling</strong>, a whole cluster is the sampling unit and only selected clusters are included. In <strong>stratified sampling</strong>, <em>all</em> strata are included and individual elements within each stratum are sampled. Cluster excludes some groups entirely; stratified includes all groups.</div>

    <hr class="s-divider">

    <!-- Sampling from Different Distributions -->
    <div class="s-header">
      <div class="s-icon">‚ö†Ô∏è</div>
      <h2><span>Section 1 ‚Äî LO 1</span>Sampling from Different Distributions</h2>
    </div>
    <div class="info-note gold"><strong>Key principle:</strong> Samples must be drawn from a single, homogeneous population. Combining data from two different distributions (e.g., different investment strategies across time) creates a sample that represents no actual population ‚Äî any conclusions drawn are invalid.</div>
    <div class="audit-list" style="margin-top:14px">
      <div class="audit-item"><div class="audit-dot" style="background:#8b1a1a"></div><div><h4>The Sharpe Ratio Trap</h4><p>If a manager uses a low-risk strategy in Year 1 and a high-risk strategy in Year 2, pooling eight quarters of returns mixes two different distributions. The combined Sharpe ratio will differ from ‚Äî and can be lower than ‚Äî the separate yearly Sharpe ratios, producing misleading conclusions about performance.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#1a3a8f"></div><div><h4>Larger is Not Always Better</h4><p>A larger sample is only superior when it remains representative of a single homogeneous population. When the underlying distribution changes over time (e.g., regime change, strategy shift), a smaller, more recent sample may be more informative than a larger pooled one.</p></div></div>
    </div>

    <hr class="s-divider">

    <!-- Central Limit Theorem -->
    <div class="s-header">
      <div class="s-icon">üìà</div>
      <h2><span>Section 2 ‚Äî LO 2</span>The Central Limit Theorem (CLT)</h2>
    </div>
    <div class="info-note gold"><strong>Formal statement:</strong> Given a population with mean Œº and finite variance œÉ¬≤, the sampling distribution of the sample mean XÃÑ, computed from random samples of size n, will be approximately normal with mean Œº and variance œÉ¬≤/n when sample size n is large (generally n ‚â• 30).</div>
    <div class="phases-table" style="margin-top:14px">
      <div class="phase-row"><div class="phase-n">1</div><div class="phase-body"><div class="phase-title">Property 1 ‚Äî Approximate Normality</div><div class="phase-desc">The sampling distribution of XÃÑ will be approximately normally distributed regardless of the shape of the underlying population distribution, provided the population has finite variance and the sample size is large (n ‚â• 30 as a rule of thumb). Highly non-normal populations may require n well above 30.</div><span class="phase-out">‚Üí CLT holds for any distribution with finite variance ‚Äî normal, skewed, uniform, etc.</span></div></div>
      <div class="phase-row"><div class="phase-n">2</div><div class="phase-body"><div class="phase-title">Property 2 ‚Äî Mean of XÃÑ Equals Population Mean</div><div class="phase-desc">The mean of the sampling distribution of XÃÑ equals the population mean Œº. The sample mean is an unbiased estimator of the population mean ‚Äî on average across many samples, it hits the target.</div><span class="phase-out">‚Üí E(XÃÑ) = Œº</span></div></div>
      <div class="phase-row"><div class="phase-n">3</div><div class="phase-body"><div class="phase-title">Property 3 ‚Äî Variance of XÃÑ Equals œÉ¬≤/n</div><div class="phase-desc">The variance of the sampling distribution is the population variance divided by sample size. As n increases, œÉ¬≤/n decreases ‚Äî the distribution of XÃÑ concentrates more tightly around Œº. This is why larger samples give more precise estimates of the population mean.</div><span class="phase-out">‚Üí Var(XÃÑ) = œÉ¬≤/n; as n ‚Üí ‚àû, Var(XÃÑ) ‚Üí 0</span></div></div>
    </div>
    <div class="info-note blue" style="margin-top:12px"><strong>Why the CLT matters:</strong> It allows analysts to make precise probability statements about the population mean using the sample mean ‚Äî and to construct confidence intervals and conduct hypothesis tests ‚Äî even when the population distribution is unknown, as long as the sample is large enough.</div>

    <hr class="s-divider">

    <!-- Standard Error -->
    <div class="s-header">
      <div class="s-icon">üìê</div>
      <h2><span>Section 2 ‚Äî LO 2</span>Standard Error of the Sample Mean</h2>
    </div>
    <div class="info-note gold"><strong>Definition:</strong> The standard error of the sample mean (œÉ<sub>XÃÑ</sub>) is the standard deviation of the sampling distribution of XÃÑ. It measures how precise the sample mean is as an estimate of the population mean ‚Äî smaller standard error = more precise estimate.</div>
    <table class="cmp-table" style="margin-top:14px">
      <thead><tr><th>Situation</th><th>Formula</th><th>When to Use</th></tr></thead>
      <tbody>
        <tr><td>Population œÉ known</td><td>œÉ<sub>XÃÑ</sub> = œÉ / ‚àön</td><td>Rarely in practice; used for theoretical examples</td></tr>
        <tr><td>Population œÉ unknown (typical)</td><td>s<sub>XÃÑ</sub> = s / ‚àön</td><td>Almost always in practice; s is the sample standard deviation</td></tr>
        <tr><td>Sample variance</td><td>s¬≤ = Œ£(X<sub>i</sub> ‚àí XÃÑ)¬≤ / (n ‚àí 1)</td><td>Use n ‚àí 1 divisor (Bessel's correction) for unbiased estimate</td></tr>
      </tbody>
    </table>
    <div class="audit-list" style="margin-top:14px">
      <div class="audit-item"><div class="audit-dot" style="background:#1a3a8f"></div><div><h4>Standard Deviation vs. Standard Error ‚Äî Key Distinction</h4><p><strong>Standard deviation</strong> measures the dispersion of individual data points around the mean ‚Äî it describes the spread of the data. <strong>Standard error</strong> measures the precision of the sample mean as an estimate of the population mean ‚Äî it describes inferential accuracy. They are not interchangeable concepts.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b98a1c"></div><div><h4>Effect of Sample Size on Standard Error</h4><p>Standard error falls with ‚àön: doubling the sample size reduces standard error by a factor of ‚àö2 ‚âà 1.41. To halve the standard error, you must quadruple the sample size. This diminishing return means there is a point beyond which adding more observations yields little additional precision.</p></div></div>
    </div>

    <hr class="s-divider">

    <!-- Key Formulas -->
    <div class="s-header">
      <div class="s-icon">üìã</div>
      <h2><span>Section 2 ‚Äî LO 2</span>Key Formulas</h2>
    </div>
    <table class="cmp-table">
      <thead><tr><th>Concept</th><th>Formula</th><th>Notes</th></tr></thead>
      <tbody>
        <tr><td>Standard error (œÉ known)</td><td>œÉ<sub>XÃÑ</sub> = œÉ / ‚àön</td><td>Theoretical; population œÉ rarely known</td></tr>
        <tr><td>Standard error (œÉ unknown)</td><td>s<sub>XÃÑ</sub> = s / ‚àön</td><td>Practical formula; most exam questions use this</td></tr>
        <tr><td>Sample variance</td><td>s¬≤ = Œ£(X<sub>i</sub> ‚àí XÃÑ)¬≤ / (n ‚àí 1)</td><td>Divisor n ‚àí 1 gives unbiased estimate of œÉ¬≤</td></tr>
        <tr><td>Required n for target SE</td><td>n = (œÉ / œÉ<sub>XÃÑ</sub>)¬≤</td><td>Rearrange œÉ<sub>XÃÑ</sub> = œÉ / ‚àön ‚Üí ‚àön = œÉ / œÉ<sub>XÃÑ</sub> ‚Üí square both sides</td></tr>
        <tr><td>Bootstrap SE estimate</td><td>s<sub>XÃÑ</sub> = ‚àö[ (1/(B‚àí1)) ¬∑ Œ£(Œ∏ÃÇ<sub>b</sub> ‚àí Œ∏ÃÑ)¬≤ ]</td><td>B = number of resamples; Œ∏ÃÇ<sub>b</sub> = mean of resample b; Œ∏ÃÑ = mean of all resample means</td></tr>
      </tbody>
    </table>

    <hr class="s-divider">

    <!-- Resampling Methods -->
    <div class="s-header">
      <div class="s-icon">üîÅ</div>
      <h2><span>Section 3 ‚Äî LO 3</span>Resampling: Bootstrap and Jackknife</h2>
    </div>
    <div class="info-note gold"><strong>What is resampling?</strong> Resampling repeatedly draws samples from the original observed data to perform statistical inference about population parameters ‚Äî without relying on analytical formulas (z-statistics, t-statistics). It is particularly powerful when no closed-form formula exists for the statistic of interest (e.g., the median).</div>
    <div class="phases-table" style="margin-top:14px">
      <div class="phase-row"><div class="phase-n">1</div><div class="phase-body"><div class="phase-title">Bootstrap ‚Äî With Replacement</div><div class="phase-desc">Draw B resamples from the original sample, each of size n, <em>with replacement</em>. The same observation can appear multiple times in one resample; some observations may not appear at all. Compute the statistic of interest (e.g., mean, median) for each resample. The distribution of these B estimates approximates the true sampling distribution. Often called model-free or non-parametric resampling.</div><span class="phase-out">‚Üí Each resample has same size n as original; with replacement; B determined by analyst</span></div></div>
      <div class="phase-row"><div class="phase-n">2</div><div class="phase-body"><div class="phase-title">Jackknife ‚Äî Leave-One-Out</div><div class="phase-desc">For a sample of size n, create n sub-samples, each formed by leaving out one different observation at a time (without replacement). Compute the statistic for each sub-sample. Jackknife is deterministic ‚Äî it always produces the same results for the same dataset. Primarily used to reduce estimator bias and to estimate standard errors and confidence intervals.</div><span class="phase-out">‚Üí Exactly n repetitions for sample of size n; without replacement; deterministic</span></div></div>
    </div>

    <hr class="s-divider">

    <!-- Bootstrap vs Jackknife Comparison -->
    <div class="s-header">
      <div class="s-icon">‚öñÔ∏è</div>
      <h2><span>Section 3 ‚Äî LO 3</span>Bootstrap vs. Jackknife</h2>
    </div>
    <table class="cmp-table">
      <thead><tr><th>Feature</th><th>Bootstrap</th><th>Jackknife</th></tr></thead>
      <tbody>
        <tr><td>Sampling mechanism</td><td>With replacement from original sample</td><td>Leave one out at a time, without replacement</td></tr>
        <tr><td>Number of repetitions</td><td>Analyst-determined (B); typically hundreds to thousands</td><td>Always exactly n (sample size)</td></tr>
        <tr><td>Reproducibility</td><td>Gives different results each run (random draws)</td><td>Gives identical results every run (deterministic)</td></tr>
        <tr><td>Primary uses</td><td>Standard error of any estimator; confidence intervals; historical simulation in finance; strategy performance vs. benchmark</td><td>Bias reduction of an estimator; standard error and confidence interval estimation</td></tr>
        <tr><td>Flexibility</td><td>Works for virtually any statistic (mean, median, Sharpe ratio, etc.)</td><td>More specialised; best for bias correction</td></tr>
        <tr><td>Common ground</td><td colspan="2" style="color:#1a3a8f;font-weight:600">Both are non-parametric resampling methods that build empirical sampling distributions from observed data without assuming a theoretical distribution</td></tr>
      </tbody>
    </table>

    <hr class="s-divider">

    <!-- Bootstrap Step-by-Step -->
    <div class="s-header">
      <div class="s-icon">‚öôÔ∏è</div>
      <h2><span>Section 3 ‚Äî LO 3</span>Bootstrap Standard Error ‚Äî Step by Step</h2>
    </div>
    <div class="phases-table">
      <div class="phase-row"><div class="phase-n">1</div><div class="phase-body"><div class="phase-title">Draw B resamples with replacement</div><div class="phase-desc">From the original sample of size n, draw B random samples (each of size n) with replacement. B is chosen by the analyst ‚Äî larger B gives a more stable estimate of the sampling distribution. Typical values range from 500 to 10,000+.</div><span class="phase-out">‚Üí Each resample is independently drawn; same n as original</span></div></div>
      <div class="phase-row"><div class="phase-n">2</div><div class="phase-body"><div class="phase-title">Compute the statistic for each resample</div><div class="phase-desc">Calculate the statistic of interest (e.g., mean Œ∏ÃÇ<sub>b</sub>) for each of the B resamples. These B values form the bootstrap sampling distribution ‚Äî the empirical approximation of the true sampling distribution of the statistic.</div><span class="phase-out">‚Üí Obtain Œ∏ÃÇ<sub>1</sub>, Œ∏ÃÇ<sub>2</sub>, ‚Ä¶, Œ∏ÃÇ<sub>B</sub></span></div></div>
      <div class="phase-row"><div class="phase-n">3</div><div class="phase-body"><div class="phase-title">Compute the mean of all resample statistics</div><div class="phase-desc">Calculate Œ∏ÃÑ = (1/B) √ó Œ£Œ∏ÃÇ<sub>b</sub> ‚Äî the mean across all B resample means. This is the centre of the bootstrap sampling distribution.</div><span class="phase-out">‚Üí Œ∏ÃÑ = average of all B resample statistics</span></div></div>
      <div class="phase-row"><div class="phase-n">4</div><div class="phase-body"><div class="phase-title">Calculate the bootstrap standard error</div><div class="phase-desc">Apply the formula: s<sub>XÃÑ</sub> = ‚àö[ (1/(B‚àí1)) ¬∑ Œ£(Œ∏ÃÇ<sub>b</sub> ‚àí Œ∏ÃÑ)¬≤ ]. This is the standard deviation of the bootstrap sampling distribution, which approximates the standard error of the statistic. Note the divisor is B ‚àí 1, not B (analogous to sample standard deviation).</div><span class="phase-out">‚Üí s<sub>XÃÑ</sub> = ‚àö[ (1/(B‚àí1)) ¬∑ Œ£(Œ∏ÃÇ<sub>b</sub> ‚àí Œ∏ÃÑ)¬≤ ]</span></div></div>
    </div>
    <div class="info-note blue" style="margin-top:12px"><strong>Bootstrap advantage:</strong> The formula s / ‚àön only works for the sample mean. Bootstrap works for <em>any</em> statistic ‚Äî including the median, Sharpe ratio, or other complex estimators ‚Äî without requiring an analytical formula.</div>

    <hr class="s-divider">

    <!-- Common Exam Pitfalls -->
    <div class="s-header">
      <div class="s-icon">‚ö°</div>
      <h2><span>Common Pitfalls</span>Exam Traps to Avoid</h2>
    </div>
    <div class="src-grid">
      <div class="src-card"><div class="src-card-hd">‚ùå Cluster vs. Stratified Confusion</div><ul class="src-items"><li>Stratified: <strong>all</strong> strata included; elements sampled within each stratum</li><li>Cluster: <strong>only selected</strong> clusters included; all (or sampled) elements within chosen clusters</li><li>Cluster excludes some groups entirely; stratified never excludes a group</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Misidentifying Sampling Methods</div><ul class="src-items"><li>Convenience = using whatever is easy to access (internal database)</li><li>Judgmental = expert hand-picks based on knowledge (auditor selecting transactions)</li><li>Systematic = every kth element from a list (every 5th company)</li><li>These are frequently tested ‚Äî know each definition precisely</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå CLT ‚Äî Population Must Be Normal</div><ul class="src-items"><li>FALSE: CLT applies to <strong>any</strong> distribution with finite variance</li><li>The population can be skewed, bimodal, uniform ‚Äî CLT still works for large n</li><li>Exception: if population is very non-normal, n may need to be much larger than 30</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Standard Error vs. Standard Deviation</div><ul class="src-items"><li><strong>Standard deviation</strong>: spread of individual data points (data description)</li><li><strong>Standard error</strong>: precision of the sample mean as an estimate (inference)</li><li>SE = œÉ/‚àön; SD = œÉ. They are <em>not</em> interchangeable ‚Äî a common exam trap</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Bootstrap vs. Jackknife Repetitions</div><ul class="src-items"><li>Jackknife: always <strong>exactly n repetitions</strong> for a sample of size n</li><li>Bootstrap: analyst <strong>determines B</strong> ‚Äî not fixed at n</li><li>Bootstrap gives different results each run; jackknife is deterministic (same result every time)</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Larger Sample Always Better</div><ul class="src-items"><li>Only true when the additional data come from the <strong>same population</strong></li><li>Pooling data from different regimes/strategies mixes distributions ‚Üí invalid inference</li><li>A smaller, homogeneous sample can be more informative than a larger mixed one</li></ul></div>
    </div>

    <div class="takeaway">
      <h3>Core Mindset for Estimation and Inference</h3>
      <p>This reading builds the statistical bridge between samples and populations. The key insight is that every sample statistic is itself a random variable with a probability distribution ‚Äî the sampling distribution. The <strong>central limit theorem</strong> is the engine that makes inference tractable: regardless of how the underlying population is distributed (so long as it has finite variance), the distribution of the sample mean becomes approximately normal as sample size grows, with mean equal to the population mean and variance equal to œÉ¬≤/n. This single result underpins confidence intervals and hypothesis testing. Sampling method choice matters too: <strong>stratified sampling</strong> improves precision over simple random by ensuring all subgroups are represented ‚Äî critical in fixed-income indexing. And when no analytical formula exists for a statistic's standard error, <strong>bootstrap resampling</strong> provides a model-free solution that works for any estimator, from the mean to the median to the Sharpe ratio.</p>
    </div>

  </div><!-- /.sum-body -->
  </div><!-- /#sum-qm-7 -->


  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       QM ¬∑ READING 8 ‚Äî HYPOTHESIS TESTING
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="sum-qm-8" class="sum-chapter" style="display:none">
  <div class="sum-hero">
    <div class="sum-hero-label">2026 CFA¬Æ Program ¬∑ Level I ¬∑ QM Reading 8</div>
    <h1>Hypothesis <em>Testing</em></h1>
    <div class="sum-hero-tags">
      <span class="sum-hero-tag">3 Learning Outcomes</span>
      <span class="sum-hero-tag">6-Step Process</span>
      <span class="sum-hero-tag">Type I &amp; II Errors</span>
      <span class="sum-hero-tag">t / chi¬≤ / F Tests</span>
      <span class="sum-hero-tag">Power of a Test</span>
      <span class="sum-hero-tag">Parametric vs. Nonparametric</span>
    </div>
  </div>

  <div class="sum-body">

    <!-- Learning Outcomes -->
    <div class="s-header">
      <div class="s-icon">üéØ</div>
      <h2><span>Learning Outcomes</span>What You Need to Master</h2>
    </div>
    <div class="lo-list">
      <div class="lo-item"><span class="lo-pill">LO 1</span><span class="lo-text">Explain hypothesis testing and its components, including <strong>statistical significance, Type I and Type II errors, and the power of a test</strong></span></div>
      <div class="lo-item"><span class="lo-pill">LO 2</span><span class="lo-text">Construct hypothesis tests and determine their <strong>statistical significance, associated errors, and power</strong> given a significance level</span></div>
      <div class="lo-item"><span class="lo-pill">LO 3</span><span class="lo-text">Compare and contrast <strong>parametric and nonparametric tests</strong> and describe situations where each is the more appropriate type of test</span></div>
    </div>

    <hr class="s-divider">

    <!-- Six-Step Process -->
    <div class="s-header">
      <div class="s-icon">‚öôÔ∏è</div>
      <h2><span>Section 1 ‚Äî LO 1</span>The Six-Step Hypothesis Testing Process</h2>
    </div>
    <div class="phases-table">
      <div class="phase-row"><div class="phase-n">1</div><div class="phase-body"><div class="phase-title">State the Hypotheses</div><div class="phase-desc">State both H&#8320; (null) and H&#7491; (alternative) in terms of <strong>population parameters</strong>. H&#8320; is what we want to reject; H&#7491; is the "suspected" or "hoped for" condition. Both must be mutually exclusive and collectively exhaustive. H&#8320; always includes an equality sign (=, ‚â§, or ‚â•).</div><span class="phase-out">‚Üí The alternative is typically what the analyst is trying to establish</span></div></div>
      <div class="phase-row"><div class="phase-n">2</div><div class="phase-body"><div class="phase-title">Identify the Appropriate Test Statistic</div><div class="phase-desc">Choose the test statistic and its probability distribution based on what is being tested (mean, variance, correlation) and available information (known vs. unknown population variance). The distribution drives the critical values used in Step 4.</div><span class="phase-out">‚Üí See the master reference table below</span></div></div>
      <div class="phase-row"><div class="phase-n">3</div><div class="phase-body"><div class="phase-title">Specify the Level of Significance</div><div class="phase-desc">Choose Œ± ‚Äî the probability of a Type I error. Common values: 1%, 5%, 10%. Confidence level = 1 ‚àí Œ±. A smaller Œ± reduces Type I error probability but increases Type II error probability. The only way to reduce both simultaneously is to <strong>increase sample size n</strong>.</div><span class="phase-out">‚Üí Œ± = 5% corresponds to a 95% confidence level</span></div></div>
      <div class="phase-row"><div class="phase-n">4</div><div class="phase-body"><div class="phase-title">State the Decision Rule</div><div class="phase-desc">Determine critical value(s) from Œ± and the test distribution. Reject H&#8320; if the calculated statistic exceeds the critical value(s). P-value approach: reject H&#8320; if p-value &lt; Œ±. The p-value is the smallest Œ± at which H&#8320; can be rejected.</div><span class="phase-out">‚Üí One-tailed: one critical value. Two-tailed: two critical values (¬±)</span></div></div>
      <div class="phase-row"><div class="phase-n">5</div><div class="phase-body"><div class="phase-title">Collect Data and Calculate the Test Statistic</div><div class="phase-desc">Use sample data to compute the numerical value of the test statistic using the appropriate formula from Step 2.</div><span class="phase-out">‚Üí Compared to critical values in Step 6</span></div></div>
      <div class="phase-row"><div class="phase-n">6</div><div class="phase-body"><div class="phase-title">Make a Decision</div><div class="phase-desc">If calculated statistic falls in the rejection region ‚Üí reject H&#8320; (statistically significant). Otherwise ‚Üí <strong>fail to reject</strong> H&#8320;. Note: we never "accept" H&#8320;. A confidence interval approach also works: if the hypothesised value falls within the interval, fail to reject H&#8320;.</div><span class="phase-out">‚Üí "Fail to reject" does not mean H&#8320; is proven true</span></div></div>
    </div>

    <hr class="s-divider">

    <!-- Errors and Power -->
    <div class="s-header">
      <div class="s-icon">‚ö†Ô∏è</div>
      <h2><span>Section 1 ‚Äî LO 1</span>Type I &amp; II Errors and the Power of a Test</h2>
    </div>
    <div class="info-note gold" style="margin-bottom:16px"><strong>Key insight:</strong> Type I and Type II errors are mutually exclusive ‚Äî you can only commit one per decision. Reducing one increases the other. The only way to reduce both simultaneously is to increase n.</div>
    <table class="cmp-table">
      <thead><tr><th>Decision</th><th>H&#8320; is True</th><th>H&#8320; is False</th></tr></thead>
      <tbody>
        <tr><td><strong>Fail to reject H&#8320;</strong></td><td>Correct (probability = 1 ‚àí Œ±)</td><td><strong>Type II error</strong> ‚Äî False negative (probability = Œ≤)</td></tr>
        <tr><td><strong>Reject H&#8320;</strong></td><td><strong>Type I error</strong> ‚Äî False positive (probability = Œ±)</td><td>Correct ‚Äî <strong>Power of the test</strong> (probability = 1 ‚àí Œ≤)</td></tr>
      </tbody>
    </table>
    <div class="kn-grid" style="margin-top:14px">
      <div class="kn-box"><div class="kn-num" style="font-size:.9rem">Œ±</div><div class="kn-label">Level of significance = P(Type I error) = P(reject true H&#8320;)</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:.9rem">Œ≤</div><div class="kn-label">P(Type II error) = P(fail to reject false H&#8320;)</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:.9rem">1 ‚àí Œ±</div><div class="kn-label">Confidence level = P(correctly fail to reject true H&#8320;)</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:.9rem">1 ‚àí Œ≤</div><div class="kn-label">Power of the test = P(correctly reject false H&#8320;)</div></div>
    </div>

    <hr class="s-divider">

    <!-- Master Test Statistic Table -->
    <div class="s-header">
      <div class="s-icon">üìê</div>
      <h2><span>Section 2 ‚Äî LO 2</span>Test Statistics: Master Reference Table</h2>
    </div>
    <table class="cmp-table">
      <thead><tr><th>What You're Testing</th><th>Formula</th><th>Distribution</th><th>df</th></tr></thead>
      <tbody>
        <tr><td><strong>Single mean</strong> (œÉ unknown)</td><td>t = (X&#772; ‚àí Œº&#8320;) / (s/‚àön)</td><td>t</td><td>n ‚àí 1</td></tr>
        <tr><td><strong>Difference in means</strong> ‚Äî independent, equal variance</td><td>t = (X&#772;&#8321; ‚àí X&#772;&#8322;) / ‚àö(sp¬≤/n‚ÇÅ + sp¬≤/n‚ÇÇ); sp¬≤ pools both samples</td><td>t</td><td>n‚ÇÅ + n‚ÇÇ ‚àí 2</td></tr>
        <tr><td><strong>Mean of differences</strong> ‚Äî paired/dependent</td><td>t = (d&#772; ‚àí Œºd&#8320;) / sd&#772;</td><td>t</td><td>n ‚àí 1</td></tr>
        <tr><td><strong>Single variance</strong></td><td>œá¬≤ = (n ‚àí 1)s¬≤ / œÉ&#8320;¬≤</td><td>Chi-square</td><td>n ‚àí 1</td></tr>
        <tr><td><strong>Equality of two variances</strong></td><td>F = s&#8321;¬≤ / s&#8322;¬≤ (larger variance in numerator)</td><td>F</td><td>n‚ÇÅ ‚àí 1, n‚ÇÇ ‚àí 1</td></tr>
        <tr><td><strong>Correlation</strong></td><td>t = r‚àö(n ‚àí 2) / ‚àö(1 ‚àí r¬≤)</td><td>t</td><td>n ‚àí 2</td></tr>
        <tr><td><strong>Independence (categorical)</strong></td><td>œá¬≤ = Œ£(O·µ¢‚±º ‚àí E·µ¢‚±º)¬≤ / E·µ¢‚±º</td><td>Chi-square</td><td>(r ‚àí 1)(c ‚àí 1)</td></tr>
      </tbody>
    </table>
    <div class="info-note blue" style="margin-top:12px"><strong>Independent vs. Paired:</strong> If the two samples share a common element (same time periods, same companies) ‚Üí use paired comparisons (mean of differences, df = n ‚àí 1). If unrelated ‚Üí use difference in means with pooled variance (df = n‚ÇÅ + n‚ÇÇ ‚àí 2). Paired tests are more powerful because they eliminate variation unrelated to what is being tested.</div>

    <hr class="s-divider">

    <!-- Key Test Details -->
    <div class="s-header">
      <div class="s-icon">üî¨</div>
      <h2><span>Section 2 ‚Äî LO 2</span>Key Tests in Detail</h2>
    </div>
    <div class="audit-list">
      <div class="audit-item"><div class="audit-dot" style="background:#1a3a8f"></div><div><h4>t-Test for a Single Mean</h4><p>Assumptions: approximately normal population, unknown variance (the standard case in practice). Formula: t = (X&#772; ‚àí Œº‚ÇÄ) / (s/‚àön), df = n ‚àí 1. Two-tailed: reject if |t| &gt; t_critical. Confidence interval alternative: reject H‚ÇÄ if Œº‚ÇÄ falls outside X&#772; ¬± t_crit √ó (s/‚àön).</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b98a1c"></div><div><h4>Chi-Square Test for Single Variance</h4><p>Assumptions: normally distributed population. Formula: œá¬≤ = (n‚àí1)s¬≤ / œÉ‚ÇÄ¬≤, df = n ‚àí 1. Chi-square distribution is always positive and asymmetric. For left-tailed tests (H&#7491;: œÉ¬≤ &lt; œÉ‚ÇÄ¬≤), reject H‚ÇÄ if œá¬≤ falls to the left of the lower critical value (e.g., 13.09 for df = 23 at Œ± = 5%).</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b91c1c"></div><div><h4>F-Test for Equality of Two Variances</h4><p>Assumptions: two independent random samples from normally distributed populations. Place the larger sample variance in the numerator. F is always positive. Two-tailed: use Œ±/2 critical values at each tail. Reject H‚ÇÄ if F &gt; upper critical value or F &lt; lower critical value. Can also compute as the reciprocal and compare to the same boundaries.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#1a7a4a"></div><div><h4>One-Tailed vs. Two-Tailed Tests</h4><p>Two-tailed (‚â†): critical region split equally across both tails; absolute critical value is larger ‚Äî harder to reject in any specific direction. One-tailed (&gt; or &lt;): entire rejection region in one tail; smaller absolute critical value ‚Äî easier to reject in the hypothesised direction. One-tailed tests more strongly reflect the analyst's directional belief.</p></div></div>
    </div>

    <hr class="s-divider">

    <!-- Parametric vs Nonparametric -->
    <div class="s-header">
      <div class="s-icon">‚öñÔ∏è</div>
      <h2><span>Section 3 ‚Äî LO 3</span>Parametric vs. Nonparametric Tests</h2>
    </div>
    <table class="cmp-table">
      <thead><tr><th>Feature</th><th>Parametric</th><th>Nonparametric</th></tr></thead>
      <tbody>
        <tr><td>Concerned with parameters?</td><td>Yes ‚Äî tests about Œº, œÉ¬≤, œÅ</td><td>Not necessarily ‚Äî may test ranks, signs, or randomness</td></tr>
        <tr><td>Distributional assumptions</td><td>Specific (e.g., normality required)</td><td>Minimal or none</td></tr>
        <tr><td>Data requirements</td><td>Interval/ratio scale</td><td>Works with ranked (ordinal) data too</td></tr>
        <tr><td>Preferred when?</td><td>Assumptions satisfied; large enough sample</td><td>Assumptions violated, data ranked, outliers present, or hypothesis non-parametric</td></tr>
        <tr><td>Statistical power</td><td>Higher when assumptions hold</td><td>Lower ‚Äî uses less information from the data</td></tr>
      </tbody>
    </table>

    <div class="filing-grid" style="margin-top:16px">
      <div class="filing-card"><h3>üìä Wilcoxon Signed-Rank Test</h3><p>Nonparametric alternative to the t-test for a single mean and for paired comparisons. Works on ranked absolute differences. Use when the population is non-normal or the sample is small.</p></div>
      <div class="filing-card"><h3>üî¢ Mann‚ÄìWhitney U Test</h3><p>Nonparametric alternative for testing the difference between two independent group means (also known as Wilcoxon rank sum test). Use when normality fails or samples are small and non-normal.</p></div>
      <div class="filing-card"><h3>‚ûï Sign Test</h3><p>Nonparametric paired comparisons alternative. Uses only the sign (+/‚àí) of differences, not their magnitude. Simplest nonparametric test but the lowest power of the three.</p></div>
      <div class="filing-card"><h3>üîÄ Runs Test</h3><p>Tests whether a data series is random. Used to test the random walk hypothesis for stock prices ‚Äî whether past price changes predict future changes. Purely nonparametric (no parameter involved).</p></div>
    </div>
    <div class="info-note gold" style="margin-top:16px"><strong>Four situations calling for nonparametric tests:</strong> (1) Data don't meet distributional assumptions; (2) Outliers distort parametric statistics; (3) Data given in ranks or ordinal scale; (4) Hypothesis doesn't concern a parameter (e.g., testing randomness). When parametric assumptions hold, parametric tests are preferred because they have greater power.</div>

    <hr class="s-divider">

    <!-- Exam Pitfalls -->
    <div class="s-header">
      <div class="s-icon">‚ö°</div>
      <h2><span>Common Pitfalls</span>Exam Traps to Avoid</h2>
    </div>
    <div class="src-grid">
      <div class="src-card"><div class="src-card-hd">‚ùå Null Hypothesis Direction</div><ul class="src-items"><li>H‚ÇÄ must always contain an equality sign (=, ‚â§, or ‚â•)</li><li>The "suspected" condition goes in H&#7491;, not H‚ÇÄ</li><li>A "less than" alternative ‚Üí left-tailed test with H‚ÇÄ: Œº ‚â• value</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Error Trade-Off Direction</div><ul class="src-items"><li>Smaller Œ± ‚Üí fewer Type I errors but more Type II errors</li><li>Larger Œ± ‚Üí more Type I errors but fewer Type II errors</li><li>Only increasing n reduces both error types simultaneously</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå One-Tailed Critical Values</div><ul class="src-items"><li>One-tailed tests have SMALLER absolute critical values than two-tailed at the same Œ±</li><li>Two-tailed at 5%: ¬±1.984; one-tailed at 5%: 1.679 (large df)</li><li>One-tailed is easier to reject H‚ÇÄ in the hypothesised direction</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Independent vs. Paired Samples</div><ul class="src-items"><li>Same companies/periods ‚Üí dependent ‚Üí use paired test (df = n‚àí1)</li><li>Unrelated samples ‚Üí independent ‚Üí use pooled variance t-test (df = n‚ÇÅ+n‚ÇÇ‚àí2)</li><li>Paired comparisons are more powerful than independent sample tests</li></ul></div>
    </div>

    <div class="takeaway">
      <h3>Core Mindset for Hypothesis Testing</h3>
      <p>Hypothesis testing is the bridge between data and decisions. The <strong>six-step process</strong> is universal ‚Äî apply it consistently to any test and it will never lead you astray. The two error types reflect an unavoidable trade-off: reducing a false positive always increases the risk of a false negative. <strong>Power</strong> ‚Äî catching a real effect when it exists ‚Äî is the goal, and it rises with sample size, effect magnitude, and a higher Œ±. Match your test statistic to the question: <strong>t for means</strong>, <strong>chi-square for a single variance</strong>, <strong>F for comparing two variances</strong>. And when the parametric assumptions break down ‚Äî small samples, ranked data, non-normal populations, outliers ‚Äî don't force it: use <strong>nonparametric alternatives</strong> designed for exactly those situations.</p>
    </div>

  </div><!-- /.sum-body -->
  </div><!-- /#sum-qm-8 -->

  <!-- ‚îÄ‚îÄ QM-9 SUMMARY: PARAMETRIC AND NON-PARAMETRIC TESTS OF INDEPENDENCE ‚îÄ‚îÄ -->
  <div id="sum-qm-9" class="sum-chapter" style="display:none">
  <div class="sum-hero">
    <div class="sum-hero-label">2026 CFA¬Æ Program ¬∑ Level I ¬∑ QM Reading 9</div>
    <h1>Tests of <em>Independence</em></h1>
    <div class="sum-hero-tags">
      <span class="sum-hero-tag">2 Learning Outcomes</span>
      <span class="sum-hero-tag">Pearson Correlation</span>
      <span class="sum-hero-tag">Spearman Rank</span>
      <span class="sum-hero-tag">t-Test for œÅ = 0</span>
      <span class="sum-hero-tag">Contingency Tables</span>
      <span class="sum-hero-tag">Chi-Square Test</span>
    </div>
  </div>

  <div class="sum-body">

    <!-- Learning Outcomes -->
    <div class="s-header">
      <div class="s-icon">üéØ</div>
      <h2><span>Learning Outcomes</span>What You Need to Master</h2>
    </div>
    <div class="lo-list">
      <div class="lo-item"><span class="lo-pill">LO 1</span><span class="lo-text">Explain <strong>parametric and nonparametric tests of the hypothesis that the population correlation coefficient equals zero</strong>, and determine whether the hypothesis is rejected at a given level of significance</span></div>
      <div class="lo-item"><span class="lo-pill">LO 2</span><span class="lo-text">Explain <strong>tests of independence based on contingency table data</strong> using the chi-square test statistic</span></div>
    </div>

    <hr class="s-divider">

    <!-- Parametric Correlation Test -->
    <div class="s-header">
      <div class="s-icon">üìê</div>
      <h2><span>Section 1 ‚Äî LO 1</span>Parametric Test: Pearson Correlation</h2>
    </div>
    <div class="info-note gold" style="margin-bottom:16px"><strong>Formula:</strong> r<sub>XY</sub> = s<sub>XY</sub> / (s<sub>X</sub> ¬∑ s<sub>Y</sub>) &nbsp;¬∑&nbsp; Test statistic: <strong>t = r‚àö(n ‚àí 2) / ‚àö(1 ‚àí r¬≤)</strong> &nbsp;¬∑&nbsp; Distribution: t with <strong>n ‚àí 2</strong> degrees of freedom</div>
    <div class="audit-list">
      <div class="audit-item"><div class="audit-dot" style="background:#1a3a8f"></div><div><h4>Hypotheses</h4><p>Two-sided: H‚ÇÄ: œÅ = 0 vs. H&#7491;: œÅ ‚â† 0 &nbsp;|&nbsp; One-sided right: H‚ÇÄ: œÅ ‚â§ 0 vs. H&#7491;: œÅ > 0 &nbsp;|&nbsp; One-sided left: H‚ÇÄ: œÅ ‚â• 0 vs. H&#7491;: œÅ &lt; 0. The most common test asks whether any relationship exists at all, which implies H‚ÇÄ: œÅ = 0.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#1a7a4a"></div><div><h4>Effect of Sample Size on Significance</h4><p>As n increases, the same sample correlation r becomes easier to reject. Two reasons: (1) degrees of freedom increase so the critical t-value decreases; (2) the numerator r‚àö(n‚àí2) grows. E.g., r = 0.35 with n = 12 gives t = 1.182 (not significant at 5%); with n = 32 gives t = 2.046 (just significant). As datasets become ever larger, nearly any correlation becomes statistically significant ‚Äî other analytical tools must be applied.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b98a1c"></div><div><h4>Assumptions</h4><p>The two variables must be <strong>normally distributed</strong> (parametric assumption). The correlation measures the <strong>linear</strong> relationship only. The sign of the correlation is driven by the covariance; each observation is compared to its variable mean.</p></div></div>
    </div>

    <hr class="s-divider">

    <!-- Spearman Rank Correlation -->
    <div class="s-header">
      <div class="s-icon">üî¢</div>
      <h2><span>Section 1 ‚Äî LO 1</span>Nonparametric Test: Spearman Rank Correlation</h2>
    </div>
    <div class="info-note gold" style="margin-bottom:16px"><strong>Formula:</strong> r<sub>S</sub> = 1 ‚àí 6Œ£d¬≤<sub>i</sub> / [n(n¬≤ ‚àí 1)] &nbsp;¬∑&nbsp; Same t-test statistic applies for <strong>n > 30</strong>: t = r<sub>S</sub>‚àö(n ‚àí 2) / ‚àö(1 ‚àí r<sub>S</sub>¬≤), df = n ‚àí 2</div>
    <div class="phases-table">
      <div class="phase-row"><div class="phase-n">1</div><div class="phase-body"><div class="phase-title">Rank Each Variable</div><div class="phase-desc">Rank observations on X from largest (rank 1) to smallest. Repeat for Y. For tied values, assign the average of the tied ranks (e.g., if 3rd and 4th values are tied, both get rank 3.5).</div><span class="phase-out">‚Üí Produces two sets of ranks, one per variable</span></div></div>
      <div class="phase-row"><div class="phase-n">2</div><div class="phase-body"><div class="phase-title">Calculate Rank Differences</div><div class="phase-desc">For each observation i, compute d<sub>i</sub> = Rank(X<sub>i</sub>) ‚àí Rank(Y<sub>i</sub>), then d<sub>i</sub>¬≤. Sum all d<sub>i</sub>¬≤ to get Œ£d¬≤.</div><span class="phase-out">‚Üí Œ£d¬≤ captures the total discrepancy in rankings between the two variables</span></div></div>
      <div class="phase-row"><div class="phase-n">3</div><div class="phase-body"><div class="phase-title">Apply the Formula</div><div class="phase-desc">r<sub>S</sub> = 1 ‚àí 6Œ£d¬≤ / [n(n¬≤ ‚àí 1)]. This is the Pearson correlation applied to ranks rather than raw values. For the large-sample case (n > 30), test significance using the same t-statistic as for Pearson.</div><span class="phase-out">‚Üí Small samples (n ‚â§ 30) require a specialised critical value table</span></div></div>
    </div>
    <div class="filing-grid" style="margin-top:16px">
      <div class="filing-card"><h3>When to Use Spearman</h3><p>Use when the population <strong>departs meaningfully from normality</strong>, when there are outliers, when data are ranked/ordinal, or when assumptions for the Pearson parametric test are not met.</p></div>
      <div class="filing-card"><h3>Spearman vs. Pearson</h3><p>Spearman is calculated on <strong>ranks</strong>, not raw values. It is less sensitive to outliers. When normality holds, Pearson is preferred because it has greater statistical power.</p></div>
      <div class="filing-card"><h3>Large Sample (n > 30)</h3><p>Use the <strong>same t-test</strong> as for Pearson (df = n ‚àí 2). The test statistic formula is identical: t = r<sub>S</sub>‚àö(n ‚àí 2) / ‚àö(1 ‚àí r<sub>S</sub>¬≤).</p></div>
      <div class="filing-card"><h3>Small Sample (n ‚â§ 30)</h3><p>Require a <strong>specialised critical value table</strong> specific to the Spearman rank correlation. The standard t-distribution critical values are not appropriate.</p></div>
    </div>

    <hr class="s-divider">

    <!-- Parametric vs Nonparametric Comparison -->
    <div class="s-header">
      <div class="s-icon">‚öñÔ∏è</div>
      <h2><span>Section 1 ‚Äî LO 1</span>Parametric vs. Nonparametric: Comparison</h2>
    </div>
    <table class="cmp-table">
      <thead><tr><th>Feature</th><th>Parametric (Pearson)</th><th>Nonparametric (Spearman)</th></tr></thead>
      <tbody>
        <tr><td>Data used</td><td>Raw values</td><td>Ranks of values</td></tr>
        <tr><td>Distributional assumption</td><td>Bivariate normality required</td><td>Minimal ‚Äî no normality assumed</td></tr>
        <tr><td>Sensitivity to outliers</td><td>High ‚Äî outliers skew covariance</td><td>Low ‚Äî ranks limit outlier influence</td></tr>
        <tr><td>Statistical power</td><td>Higher when assumptions hold</td><td>Lower ‚Äî ranks use less information</td></tr>
        <tr><td>Test statistic (large n)</td><td>t = r‚àö(n‚àí2) / ‚àö(1‚àír¬≤), df = n‚àí2</td><td>Same formula applied to r<sub>S</sub></td></tr>
        <tr><td>When preferred</td><td>Normal populations, no outliers</td><td>Non-normal, ranked data, outliers present</td></tr>
      </tbody>
    </table>

    <hr class="s-divider">

    <!-- Contingency Tables -->
    <div class="s-header">
      <div class="s-icon">üìä</div>
      <h2><span>Section 2 ‚Äî LO 2</span>Tests of Independence: Contingency Tables</h2>
    </div>
    <div class="info-note gold" style="margin-bottom:16px"><strong>Chi-square statistic:</strong> œá¬≤ = Œ£ (O<sub>ij</sub> ‚àí E<sub>ij</sub>)¬≤ / E<sub>ij</sub> &nbsp;¬∑&nbsp; <strong>Expected frequency:</strong> E<sub>ij</sub> = (Row i total √ó Column j total) / Overall total &nbsp;¬∑&nbsp; <strong>df = (r ‚àí 1)(c ‚àí 1)</strong></div>
    <div class="audit-list">
      <div class="audit-item"><div class="audit-dot" style="background:#1a3a8f"></div><div><h4>When to Use a Contingency Table Test</h4><p>Use when data are <strong>categorical or discrete</strong> ‚Äî correlation methods cannot be applied. A contingency table (two-way table) cross-classifies observations on two categorical dimensions. Example: 1,594 ETFs classified by size (small/medium/large) AND investment type (value/growth/blend).</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#1a7a4a"></div><div><h4>Hypotheses</h4><p>H‚ÇÄ: The two categorical variables are <strong>independent</strong> (no relationship). H&#7491;: The two categorical variables are <strong>dependent</strong> (a relationship exists). This is always a <strong>one-sided (right-tail only)</strong> test because the chi-square statistic is always non-negative ‚Äî observed equals expected gives œá¬≤ = 0; any deviation gives œá¬≤ > 0.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b98a1c"></div><div><h4>Degrees of Freedom</h4><p>df = (r ‚àí 1)(c ‚àí 1), where r = number of rows (categories of variable 1) and c = number of columns (categories of variable 2). Example: 3 √ó 3 table ‚Üí df = (3‚àí1)(3‚àí1) = 4. Critical value at 5% significance with df = 4 is 9.4877.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b91c1c"></div><div><h4>Decision Rule</h4><p>Reject H‚ÇÄ if calculated œá¬≤ > critical œá¬≤. There is <strong>only one rejection region</strong> (right tail). The test is nonparametric ‚Äî it makes no distributional assumptions about the underlying populations.</p></div></div>
    </div>

    <hr class="s-divider">

    <!-- Chi-Square Step-by-Step -->
    <div class="s-header">
      <div class="s-icon">üîÑ</div>
      <h2><span>Section 2 ‚Äî LO 2</span>Chi-Square Test: Step-by-Step</h2>
    </div>
    <div class="phases-table">
      <div class="phase-row"><div class="phase-n">1</div><div class="phase-body"><div class="phase-title">State the Hypotheses</div><div class="phase-desc">H‚ÇÄ: The two classifications are independent. H&#7491;: The two classifications are not independent (dependent).</div><span class="phase-out">‚Üí Independence means knowing one category tells you nothing about the other</span></div></div>
      <div class="phase-row"><div class="phase-n">2</div><div class="phase-body"><div class="phase-title">Calculate Expected Frequencies</div><div class="phase-desc">For each cell (i, j): E<sub>ij</sub> = (Row i total √ó Column j total) / Overall total. This is the count you would expect in that cell if the two variables were completely independent.</div><span class="phase-out">‚Üí E<sub>ij</sub> = (Row total √ó Column total) / Grand total</span></div></div>
      <div class="phase-row"><div class="phase-n">3</div><div class="phase-body"><div class="phase-title">Calculate Scaled Squared Deviations</div><div class="phase-desc">For each cell: (O<sub>ij</sub> ‚àí E<sub>ij</sub>)¬≤ / E<sub>ij</sub>. This scales each squared difference by the expected count ‚Äî cells with higher expected counts get proportionally less weight per unit deviation.</div><span class="phase-out">‚Üí Each cell contributes one term to the sum</span></div></div>
      <div class="phase-row"><div class="phase-n">4</div><div class="phase-body"><div class="phase-title">Sum to Get œá¬≤</div><div class="phase-desc">œá¬≤ = sum of all (O<sub>ij</sub> ‚àí E<sub>ij</sub>)¬≤ / E<sub>ij</sub> across all m cells, where m = r √ó c. Compare to the chi-square critical value with df = (r‚àí1)(c‚àí1) at the chosen significance level.</div><span class="phase-out">‚Üí Reject H‚ÇÄ if œá¬≤ > critical value (right-tail only)</span></div></div>
    </div>

    <hr class="s-divider">

    <!-- Key Numbers -->
    <div class="s-header">
      <div class="s-icon">üî¢</div>
      <h2><span>Critical Numbers</span>Exam-Tested Values to Memorise</h2>
    </div>
    <div class="kn-grid">
      <div class="kn-box"><div class="kn-num" style="font-size:1rem">n ‚àí 2</div><div class="kn-label">Degrees of freedom for both the Pearson and Spearman t-tests</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:1rem">(r‚àí1)(c‚àí1)</div><div class="kn-label">Degrees of freedom for chi-square test of independence</div></div>
      <div class="kn-box"><div class="kn-num">9.49</div><div class="kn-label">Chi-square critical value at 5% significance with df = 4 (3√ó3 contingency table)</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:1rem">1-tail</div><div class="kn-label">Chi-square test of independence always uses a right-tail rejection region only</div></div>
    </div>

    <hr class="s-divider">

    <!-- Mosaic and Standardised Residuals -->
    <div class="s-header">
      <div class="s-icon">üó∫Ô∏è</div>
      <h2><span>Section 2 ‚Äî LO 2</span>Visualising Results: Mosaics &amp; Standardised Residuals</h2>
    </div>
    <div class="audit-list">
      <div class="audit-item"><div class="audit-dot" style="background:#1a3a8f"></div><div><h4>Mosaic Plot</h4><p>A grid visualisation of the contingency table. Rectangle <strong>width</strong> reflects the proportion of each column category; rectangle <strong>height</strong> reflects the proportion of each row category. Shading shows whether observed counts are above or below expected under independence.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#1a7a4a"></div><div><h4>Standardised Residual (Pearson Residual)</div><p>Formula: (O<sub>ij</sub> ‚àí E<sub>ij</sub>) / ‚àöE<sub>ij</sub>. Positive values ‚Üí more observations than expected. Negative values ‚Üí fewer observations than expected. Example from ETF data: medium-cap growth ETFs had a standardised residual of +3.69 (more than expected); large-cap growth had ‚àí2.72 (fewer than expected).</p></div></div>
    </div>

    <hr class="s-divider">

    <!-- Exam Pitfalls -->
    <div class="s-header">
      <div class="s-icon">‚ö°</div>
      <h2><span>Common Pitfalls</span>Exam Traps to Avoid</h2>
    </div>
    <div class="src-grid">
      <div class="src-card"><div class="src-card-hd">‚ùå One-Tail vs. Two-Tail Confusion</div><ul class="src-items"><li>Correlation t-tests can be one-tailed OR two-tailed depending on the hypothesis</li><li>Chi-square test of independence is ALWAYS one-tailed (right tail only)</li><li>The chi-square statistic is always ‚â• 0, so there is only a right-side rejection region</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Degrees of Freedom</div><ul class="src-items"><li>Correlation t-test: df = n ‚àí 2 (not n ‚àí 1)</li><li>Chi-square independence: df = (r ‚àí 1)(c ‚àí 1) ‚Äî a 3√ó3 table gives df = 4, not 9</li><li>A common trap: confusing m (total cells = r √ó c) with degrees of freedom</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Choosing Pearson vs. Spearman</div><ul class="src-items"><li>If the data depart from normality ‚Üí use Spearman, not Pearson</li><li>If data are already in rank form ‚Üí Spearman is the only option</li><li>Both use the same t-test formula for large samples (n > 30)</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Large Sample Significance</div><ul class="src-items"><li>Very large n ‚Üí almost any correlation becomes statistically significant</li><li>Statistical significance ‚â† economic significance</li><li>With very large datasets, other analytical tools must supplement hypothesis tests</li></ul></div>
    </div>

    <div class="takeaway">
      <h3>Core Mindset for Tests of Independence</h3>
      <p>This reading has two distinct tools for two distinct data types. For <strong>continuous variables</strong>, test correlation using a <strong>t-statistic</strong> ‚Äî Pearson if normality holds, Spearman ranks if it doesn't. Both use the same formula: t = r‚àö(n‚àí2) / ‚àö(1‚àír¬≤), df = n‚àí2. For <strong>categorical variables</strong>, test independence using the <strong>chi-square statistic</strong> on a contingency table ‚Äî always a right-tail test, degrees of freedom = (r‚àí1)(c‚àí1). The key to this reading is knowing which tool to reach for: if the variable type is continuous and roughly normal ‚Üí parametric Pearson; if non-normal or ranked ‚Üí nonparametric Spearman; if categorical ‚Üí chi-square. Never apply correlation methods to categorical data.</p>
    </div>

  </div><!-- /.sum-body -->
  </div><!-- /#sum-qm-9 -->

  <!-- ‚îÄ‚îÄ QM-10 SUMMARY: SIMPLE LINEAR REGRESSION ‚îÄ‚îÄ -->
  <div id="sum-qm-10" class="sum-chapter" style="display:none">
  <div class="sum-hero">
    <div class="sum-hero-label">2026 CFA¬Æ Program ¬∑ Level I ¬∑ QM Reading 10</div>
    <h1>Simple Linear <em>Regression</em></h1>
    <div class="sum-hero-tags">
      <span class="sum-hero-tag">6 Learning Outcomes</span>
      <span class="sum-hero-tag">OLS / Least Squares</span>
      <span class="sum-hero-tag">4 Assumptions (LINE)</span>
      <span class="sum-hero-tag">ANOVA &amp; Goodness of Fit</span>
      <span class="sum-hero-tag">t &amp; F Tests</span>
      <span class="sum-hero-tag">Prediction Intervals</span>
      <span class="sum-hero-tag">Log Transformations</span>
    </div>
  </div>

  <div class="sum-body">

    <!-- Learning Outcomes -->
    <div class="s-header">
      <div class="s-icon">üéØ</div>
      <h2><span>Learning Outcomes</span>What You Need to Master</h2>
    </div>
    <div class="lo-list">
      <div class="lo-item"><span class="lo-pill">LO 1</span><span class="lo-text">Describe a simple linear regression model, how the <strong>least squares criterion</strong> is used to estimate regression coefficients, and the interpretation of these coefficients</span></div>
      <div class="lo-item"><span class="lo-pill">LO 2</span><span class="lo-text">Explain the <strong>four assumptions</strong> underlying the simple linear regression model, and describe how residuals and residual plots indicate if these assumptions may have been violated</span></div>
      <div class="lo-item"><span class="lo-pill">LO 3</span><span class="lo-text">Calculate and interpret <strong>measures of fit</strong> (R¬≤, F-statistic, s<sub>e</sub>) and formulate and evaluate tests of fit and of regression coefficients</span></div>
      <div class="lo-item"><span class="lo-pill">LO 4</span><span class="lo-text">Describe the use of <strong>ANOVA</strong> in regression analysis, interpret ANOVA results, and calculate and interpret the standard error of estimate</span></div>
      <div class="lo-item"><span class="lo-pill">LO 5</span><span class="lo-text">Calculate and interpret the <strong>predicted value</strong> for the dependent variable, and a <strong>prediction interval</strong> for it, given an estimated linear regression model and a value for the independent variable</span></div>
      <div class="lo-item"><span class="lo-pill">LO 6</span><span class="lo-text">Describe different <strong>functional forms</strong> of simple linear regressions (log-lin, lin-log, log-log)</span></div>
    </div>

    <hr class="s-divider">

    <!-- The Model -->
    <div class="s-header">
      <div class="s-icon">üìê</div>
      <h2><span>Section 1 ‚Äî LO 1</span>The Simple Linear Regression Model</h2>
    </div>
    <div class="info-note gold" style="margin-bottom:16px"><strong>Population model:</strong> Y<sub>i</sub> = b<sub>0</sub> + b<sub>1</sub>X<sub>i</sub> + Œµ<sub>i</sub> &nbsp;¬∑&nbsp; <strong>Estimated line:</strong> ≈∂<sub>i</sub> = bÃÇ<sub>0</sub> + bÃÇ<sub>1</sub>X<sub>i</sub> &nbsp;¬∑&nbsp; <strong>Residual:</strong> e<sub>i</sub> = Y<sub>i</sub> ‚àí ≈∂<sub>i</sub></div>
    <div class="audit-list">
      <div class="audit-item"><div class="audit-dot" style="background:#1a3a8f"></div><div><h4>Dependent Variable (Y)</h4><p>The variable whose variation we are trying to explain. Plotted on the vertical axis. Examples: ROA, stock return, revenue growth, inflation rate.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b98a1c"></div><div><h4>Independent Variable (X)</h4><p>The variable used to explain variation in Y. Plotted on the horizontal axis. Must not be random (non-stochastic assumption). Examples: CAPEX, GDP growth, market return.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#1a7a4a"></div><div><h4>Intercept (bÃÇ<sub>0</sub>)</h4><p>Value of Y when X = 0. Calculated as: bÃÇ<sub>0</sub> = »≤ ‚àí bÃÇ<sub>1</sub>XÃÑ. May be meaningless if X = 0 is unrealistic (e.g., zero money supply). In indicator variable regressions, it is the mean of Y when the indicator = 0.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b91c1c"></div><div><h4>Slope (bÃÇ<sub>1</sub>)</h4><p>Change in Y for a one-unit change in X. Formula: bÃÇ<sub>1</sub> = Œ£(Y<sub>i</sub>‚àí»≤)(X<sub>i</sub>‚àíXÃÑ) / Œ£(X<sub>i</sub>‚àíXÃÑ)¬≤ = Cov(X,Y) / Var(X). Same sign as the pairwise correlation. In indicator variable regressions, it is the difference in group means.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#6b3fa0"></div><div><h4>OLS Criterion</h4><p>Ordinary least squares minimises the <strong>sum of squared residuals (SSE)</strong> = Œ£e<sub>i</sub>¬≤. The resulting line is the best-fitting line through the data. By construction: (1) sum of residuals = 0; (2) regression line passes through (XÃÑ, »≤).</p></div></div>
    </div>
    <div class="info-note blue" style="margin-top:12px"><strong>Slope vs. Correlation:</strong> Both share the same sign and same numerator Œ£(Y<sub>i</sub>‚àí»≤)(X<sub>i</sub>‚àíXÃÑ). The difference is the denominator ‚Äî slope uses Var(X) only; correlation uses Std(Y) √ó Std(X). In SLR: r = bÃÇ<sub>1</sub> √ó (s<sub>X</sub>/s<sub>Y</sub>).</div>

    <hr class="s-divider">

    <!-- Slope and Correlation Link -->
    <div class="s-header">
      <div class="s-icon">üîó</div>
      <h2><span>Section 1 ‚Äî LO 1</span>Key Formulas at a Glance</h2>
    </div>
    <div class="kn-grid" style="margin-bottom:16px">
      <div class="kn-box"><div class="kn-num" style="font-size:.85rem">bÃÇ<sub>1</sub></div><div class="kn-label">Œ£(Y·µ¢‚àí»≤)(X·µ¢‚àíXÃÑ) / Œ£(X·µ¢‚àíXÃÑ)¬≤<br>= Cov(Y,X) / Var(X)</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:.85rem">bÃÇ<sub>0</sub></div><div class="kn-label">»≤ ‚àí bÃÇ‚ÇÅXÃÑ<br>Estimated after slope</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:.85rem">e·µ¢</div><div class="kn-label">Y·µ¢ ‚àí ≈∂·µ¢ = actual ‚àí predicted<br>Residual (sample); Œµ = population error</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:.85rem">r</div><div class="kn-label">Cov(X,Y) / (s<sub>X</sub>¬∑s<sub>Y</sub>)<br>Pairwise correlation; r¬≤ = R¬≤</div></div>
    </div>

    <hr class="s-divider">

    <!-- Four Assumptions -->
    <div class="s-header">
      <div class="s-icon">‚öñÔ∏è</div>
      <h2><span>Section 2 ‚Äî LO 2</span>Four Assumptions: LINE</h2>
    </div>
    <div class="info-note gold" style="margin-bottom:16px"><strong>Memory aid:</strong> <strong>L</strong>inearity ¬∑ <strong>I</strong>ndependence ¬∑ <strong>N</strong>ormality ¬∑ <strong>E</strong>qual variance (Homoskedasticity). All four must hold for valid inference.</div>
    <div class="phases-table">
      <div class="phase-row"><div class="phase-n">L</div><div class="phase-body"><div class="phase-title">Linearity</div><div class="phase-desc">The relationship between Y and X is linear. X must be non-stochastic (not random). Violation sign: residuals show a curve or systematic pattern when plotted against X ‚Äî under/overestimating at different ranges. Fix: use a nonlinear functional form (log transformation, etc.).</div><span class="phase-out">‚Üí Residuals must appear random ‚Äî no pattern vs. X</span></div></div>
      <div class="phase-row"><div class="phase-n">I</div><div class="phase-body"><div class="phase-title">Independence</div><div class="phase-desc">Each (X, Y) pair is uncorrelated with other pairs ‚Äî no autocorrelation. Violation sign: residuals show a repeating or seasonal pattern across time (e.g., Q4 revenue spikes). Critical for valid standard errors of bÃÇ<sub>0</sub> and bÃÇ<sub>1</sub>.</div><span class="phase-out">‚Üí Residuals vs. time should look random, not seasonal</span></div></div>
      <div class="phase-row"><div class="phase-n">N</div><div class="phase-body"><div class="phase-title">Normality</div><div class="phase-desc">Residuals (not the raw data) are normally distributed. Outliers in X or Y can distort the fitted line for all other observations. For large samples, the central limit theorem allows relaxing this assumption.</div><span class="phase-out">‚Üí Check histogram/Q-Q plot of residuals; outliers are the main concern</span></div></div>
      <div class="phase-row"><div class="phase-n">E</div><div class="phase-body"><div class="phase-title">Equal Variance (Homoskedasticity)</div><div class="phase-desc">E(Œµ<sub>i</sub>¬≤) = œÉ<sub>Œµ</sub>¬≤ for all i. Variance of residuals is constant across all observations. Violation = heteroskedasticity. Violation sign: residuals cluster into groups with different spread widths (e.g., two regimes with different central bank policy).</div><span class="phase-out">‚Üí Residual band width should be uniform, not widening or narrowing</span></div></div>
    </div>

    <hr class="s-divider">

    <!-- Sum of Squares and Goodness of Fit -->
    <div class="s-header">
      <div class="s-icon">üìä</div>
      <h2><span>Section 3 ‚Äî LO 3</span>Sum of Squares Decomposition &amp; Goodness of Fit</h2>
    </div>
    <div class="info-note gold" style="margin-bottom:16px"><strong>Key identity:</strong> SST = SSR + SSE &nbsp;¬∑&nbsp; Total variation = Explained variation + Unexplained variation</div>
    <table class="cmp-table">
      <thead><tr><th>Component</th><th>Formula</th><th>Meaning</th></tr></thead>
      <tbody>
        <tr><td><strong>SST</strong> ‚Äî Total</td><td>Œ£(Y<sub>i</sub> ‚àí »≤)¬≤</td><td>Total variation of Y to be explained. df = n ‚àí 1</td></tr>
        <tr><td><strong>SSR</strong> ‚Äî Regression</td><td>Œ£(≈∂<sub>i</sub> ‚àí »≤)¬≤</td><td>Variation <em>explained</em> by X. df = k = 1 (simple LR)</td></tr>
        <tr><td><strong>SSE</strong> ‚Äî Error</td><td>Œ£(Y<sub>i</sub> ‚àí ≈∂<sub>i</sub>)¬≤</td><td>Variation <em>unexplained</em> by X. df = n ‚àí 2</td></tr>
        <tr><td><strong>R¬≤</strong></td><td>SSR / SST = r¬≤</td><td>% of Y's variation explained by X. Range: 0‚Äì100%</td></tr>
        <tr><td><strong>MSR</strong></td><td>SSR / k = SSR / 1</td><td>Mean square regression ‚Äî explained variance per df</td></tr>
        <tr><td><strong>MSE</strong></td><td>SSE / (n‚àí2)</td><td>Mean square error ‚Äî unexplained variance per df</td></tr>
        <tr><td><strong>F-statistic</strong></td><td>MSR / MSE</td><td>Tests H<sub>0</sub>: b<sub>1</sub> = 0. One-sided (right tail only). df: 1, n‚àí2</td></tr>
        <tr><td><strong>s<sub>e</sub></strong></td><td>‚àöMSE = ‚àö[SSE/(n‚àí2)]</td><td>Standard error of estimate ‚Äî absolute measure of fit</td></tr>
      </tbody>
    </table>
    <div class="info-note blue" style="margin-top:12px"><strong>Key link:</strong> In SLR, t¬≤ = F. The t-statistic for testing b<sub>1</sub> = 0 squared equals the F-statistic. Also: r¬≤ = R¬≤. Both R¬≤ and F test fit, but R¬≤ is descriptive while F is a statistical test. s<sub>e</sub> is the absolute measure ‚Äî unlike R¬≤ and F, it has units (same units as Y).</div>

    <hr class="s-divider">

    <!-- ANOVA Table -->
    <div class="s-header">
      <div class="s-icon">üìã</div>
      <h2><span>Section 4 ‚Äî LO 4</span>ANOVA Table Structure</h2>
    </div>
    <table class="cmp-table">
      <thead><tr><th>Source</th><th>SS</th><th>df</th><th>MS</th><th>F</th></tr></thead>
      <tbody>
        <tr><td><strong>Regression</strong></td><td>SSR = Œ£(≈∂<sub>i</sub>‚àí»≤)¬≤</td><td>k = 1</td><td>MSR = SSR/1</td><td rowspan="2" style="vertical-align:middle"><strong>F = MSR/MSE</strong><br>df: 1, n‚àí2<br>Right-tail only</td></tr>
        <tr><td><strong>Error</strong></td><td>SSE = Œ£(Y<sub>i</sub>‚àí≈∂<sub>i</sub>)¬≤</td><td>n ‚àí 2</td><td>MSE = SSE/(n‚àí2)</td></tr>
        <tr><td><strong>Total</strong></td><td>SST = Œ£(Y<sub>i</sub>‚àí»≤)¬≤</td><td>n ‚àí 1</td><td>s¬≤<sub>Y</sub> = SST/(n‚àí1)</td><td>‚Äî</td></tr>
      </tbody>
    </table>
    <div class="kn-grid" style="margin-top:14px">
      <div class="kn-box"><div class="kn-num" style="font-size:.85rem">s<sub>e</sub></div><div class="kn-label">‚àöMSE = standard error of estimate<br>Smaller = better fit</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:.85rem">s¬≤<sub>Y</sub></div><div class="kn-label">SST/(n‚àí1) = sample variance of Y<br>From ANOVA total row</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:.85rem">R¬≤</div><div class="kn-label">SSR/SST ‚Äî relative, unitless<br>Compare across same-Y models</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:.85rem">F</div><div class="kn-label">MSR/MSE ‚Äî always right-tail<br>= t¬≤ in simple LR</div></div>
    </div>

    <hr class="s-divider">

    <!-- Hypothesis Tests -->
    <div class="s-header">
      <div class="s-icon">üî¨</div>
      <h2><span>Section 3 ‚Äî LO 3</span>Hypothesis Tests on Regression Coefficients</h2>
    </div>
    <div class="audit-list">
      <div class="audit-item"><div class="audit-dot" style="background:#1a3a8f"></div><div><h4>Test of the Slope (t-test)</h4><p>H<sub>0</sub>: b<sub>1</sub> = B<sub>1</sub> (often 0) vs. H<sub>a</sub>: b<sub>1</sub> ‚â† B<sub>1</sub>. Formula: t = (bÃÇ<sub>1</sub> ‚àí B<sub>1</sub>) / s<sub>bÃÇ‚ÇÅ</sub>, where s<sub>bÃÇ‚ÇÅ</sub> = s<sub>e</sub> / ‚àöŒ£(X<sub>i</sub>‚àíXÃÑ)¬≤. df = n ‚àí 2. Greater variability in X ‚Üí smaller s<sub>bÃÇ‚ÇÅ</sub> ‚Üí larger |t|. In SLR, the t-test for b<sub>1</sub> = 0 and the t-test for œÅ = 0 produce the same statistic.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b98a1c"></div><div><h4>Test of the Intercept (t-test)</h4><p>H<sub>0</sub>: b<sub>0</sub> = B<sub>0</sub> vs. H<sub>a</sub>: b<sub>0</sub> ‚â† B<sub>0</sub>. Formula: t = (bÃÇ<sub>0</sub> ‚àí B<sub>0</sub>) / s<sub>bÃÇ‚ÇÄ</sub>, where s<sub>bÃÇ‚ÇÄ</sub> = s<sub>e</sub>‚àö[1/n + XÃÑ¬≤ / Œ£(X<sub>i</sub>‚àíXÃÑ)¬≤]. df = n ‚àí 2. Intercept test is meaningful only if X = 0 is economically sensible.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#1a7a4a"></div><div><h4>Indicator (Dummy) Variables</h4><p>X takes only values 0 or 1 (e.g., earnings announcement month = 1, otherwise = 0). Intercept = mean of Y when indicator = 0. Slope = difference in means between the two groups. The test of the slope coefficient is equivalent to a two-sample t-test of means.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b91c1c"></div><div><h4>p-Values</h4><p>The p-value is the smallest Œ± at which H<sub>0</sub> can be rejected. Reject H<sub>0</sub> if p-value &lt; Œ±. Most software reports p-values for the test H<sub>0</sub>: parameter = 0. For a one-sided test, divide the two-sided p-value by 2. A very small p-value does not imply economic significance ‚Äî large samples can make trivially small effects significant.</p></div></div>
    </div>

    <hr class="s-divider">

    <!-- Prediction -->
    <div class="s-header">
      <div class="s-icon">üî≠</div>
      <h2><span>Section 5 ‚Äî LO 5</span>Prediction &amp; Prediction Intervals</h2>
    </div>
    <div class="info-note gold" style="margin-bottom:16px"><strong>Point forecast:</strong> ≈∂<sub>f</sub> = bÃÇ<sub>0</sub> + bÃÇ<sub>1</sub>X<sub>f</sub> &nbsp;¬∑&nbsp; <strong>Prediction interval:</strong> ≈∂<sub>f</sub> ¬± t<sub>Œ±/2</sub> √ó s<sub>f</sub> &nbsp;¬∑&nbsp; <strong>Standard error of forecast:</strong> s<sub>f</sub> = s<sub>e</sub>‚àö[1 + 1/n + (X<sub>f</sub>‚àíXÃÑ)¬≤/Œ£(X<sub>i</sub>‚àíXÃÑ)¬≤]</div>
    <div class="phases-table">
      <div class="phase-row"><div class="phase-n">1</div><div class="phase-body"><div class="phase-title">Make the Point Forecast</div><div class="phase-desc">≈∂<sub>f</sub> = bÃÇ<sub>0</sub> + bÃÇ<sub>1</sub>X<sub>f</sub>. Plug the forecasted value of X into the estimated regression equation.</div><span class="phase-out">‚Üí This is the estimated mean of Y at X = X<sub>f</sub></span></div></div>
      <div class="phase-row"><div class="phase-n">2</div><div class="phase-body"><div class="phase-title">Compute s<sub>f</sub></div><div class="phase-desc">s<sub>f</sub> = s<sub>e</sub>‚àö[1 + 1/n + (X<sub>f</sub>‚àíXÃÑ)¬≤/Œ£(X<sub>i</sub>‚àíXÃÑ)¬≤]. Three factors increase s<sub>f</sub>: (1) larger s<sub>e</sub>; (2) smaller n; (3) X<sub>f</sub> further from XÃÑ. The interval is narrowest at X<sub>f</sub> = XÃÑ and widens as you move away.</div><span class="phase-out">‚Üí Forecasting outside the data range (extrapolation) increases uncertainty dramatically</span></div></div>
      <div class="phase-row"><div class="phase-n">3</div><div class="phase-body"><div class="phase-title">Apply the Interval</div><div class="phase-desc">Prediction interval = ≈∂<sub>f</sub> ¬± t<sub>critical Œ±/2</sub> √ó s<sub>f</sub>, with df = n ‚àí 2. This interval accounts for both estimation error in the regression line AND individual observation scatter around the line (hence the "+1" inside the square root).</div><span class="phase-out">‚Üí Wider than a confidence interval for the mean ‚Äî it must capture individual Y values</span></div></div>
    </div>
    <div class="info-note blue" style="margin-top:12px"><strong>Important:</strong> The "1 +" in the s<sub>f</sub> formula captures the fact that we're predicting an individual Y value, not the conditional mean of Y. This makes prediction intervals wider than confidence intervals for the mean.</div>

    <hr class="s-divider">

    <!-- Functional Forms -->
    <div class="s-header">
      <div class="s-icon">üìà</div>
      <h2><span>Section 6 ‚Äî LO 6</span>Functional Forms: Log Transformations</h2>
    </div>
    <div class="info-note gold" style="margin-bottom:16px"><strong>Goal:</strong> Transform non-linear data so that the linear regression model fits well. Choose based on R¬≤, F-statistic, s<sub>e</sub>, and random (pattern-free) residuals.</div>
    <table class="cmp-table">
      <thead><tr><th>Model</th><th>Form</th><th>Slope Interpretation</th><th>Use When</th></tr></thead>
      <tbody>
        <tr><td><strong>Lin-Lin</strong> (standard)</td><td>Y = b<sub>0</sub> + b<sub>1</sub>X</td><td>Absolute Œî in Y for absolute Œî in X</td><td>Both variables are linear</td></tr>
        <tr><td><strong>Log-Lin</strong></td><td>ln Y = b<sub>0</sub> + b<sub>1</sub>X</td><td>Relative (%) Œî in Y for absolute Œî in X</td><td>Y grows exponentially; model constant growth rate</td></tr>
        <tr><td><strong>Lin-Log</strong></td><td>Y = b<sub>0</sub> + b<sub>1</sub>ln X</td><td>Absolute Œî in Y for relative (%) Œî in X</td><td>Diminishing marginal returns in X</td></tr>
        <tr><td><strong>Log-Log</strong></td><td>ln Y = b<sub>0</sub> + b<sub>1</sub>ln X</td><td>Relative (%) Œî in Y for relative (%) Œî in X (= elasticity)</td><td>Elasticity relationships; both variables non-linear</td></tr>
      </tbody>
    </table>
    <div class="filing-grid" style="margin-top:16px">
      <div class="filing-card"><h3>üìä Log-Lin</h3><p>ln Y = b<sub>0</sub> + b<sub>1</sub>X. Used for exponentially growing variables (e.g., revenues growing at a compound rate). To forecast Y: antilog the predicted ln Y ‚Äî i.e., Y = e<sup>predicted ln Y</sup>. Cannot compare R¬≤ directly to a lin-lin model.</p></div>
      <div class="filing-card"><h3>üìâ Lin-Log</h3><p>Y = b<sub>0</sub> + b<sub>1</sub>ln X. Used when X has diminishing marginal impact on Y (e.g., operating margin vs. unit sales). Since Y is unchanged, R¬≤ and s<sub>e</sub> <strong>can</strong> be compared directly with the lin-lin model.</p></div>
      <div class="filing-card"><h3>üî¢ Log-Log</h3><p>ln Y = b<sub>0</sub> + b<sub>1</sub>ln X. The slope is a <strong>constant elasticity</strong>: 1% change in X ‚Üí b<sub>1</sub>% change in Y. Used for revenue‚Äìadvertising, demand models. Cannot compare R¬≤ directly to lin-lin.</p></div>
      <div class="filing-card"><h3>üéØ Model Selection</h3><p>Compare models with the <strong>same dependent variable form</strong> using R¬≤, F, and s<sub>e</sub>. Always examine residuals: random residuals confirm correct functional form. Non-random residuals signal the wrong form.</p></div>
    </div>

    <hr class="s-divider">

    <!-- Key Numbers -->
    <div class="s-header">
      <div class="s-icon">üî¢</div>
      <h2><span>Critical Numbers</span>Exam-Tested Values &amp; Examples</h2>
    </div>
    <div class="kn-grid">
      <div class="kn-box"><div class="kn-num" style="font-size:.85rem">n ‚àí 2</div><div class="kn-label">df for t-tests on slope and intercept; df for MSE and s<sub>e</sub></div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:.85rem">1, n‚àí2</div><div class="kn-label">df for F-statistic in SLR (1 in numerator, n‚àí2 in denominator)</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:.85rem">t¬≤ = F</div><div class="kn-label">In SLR only: squared t-stat for b‚ÇÅ=0 equals the F-stat</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:.85rem">r¬≤ = R¬≤</div><div class="kn-label">Pairwise correlation squared = coefficient of determination (SLR only)</div></div>
    </div>

    <hr class="s-divider">

    <!-- Exam Pitfalls -->
    <div class="s-header">
      <div class="s-icon">‚ö°</div>
      <h2><span>Common Pitfalls</span>Exam Traps to Avoid</h2>
    </div>
    <div class="src-grid">
      <div class="src-card"><div class="src-card-hd">‚ùå Error vs. Residual</div><ul class="src-items"><li>Error term (Œµ) = population; Residual (e) = sample estimate</li><li>Sum of residuals is always zero by construction in OLS</li><li>Residuals are in the same units as Y (not standardised)</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Normality Assumption</div><ul class="src-items"><li>Normality applies to the RESIDUALS, not to Y or X themselves</li><li>Outliers in Y or X can severely distort the fitted line</li><li>Large n ‚Üí CLT allows relaxing normality requirement</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå R¬≤ vs. F vs. s<sub>e</sub></div><ul class="src-items"><li>R¬≤ is descriptive (relative); F is a statistical test (relative); s<sub>e</sub> is absolute (has units)</li><li>Only compare R¬≤ and F across models with the SAME dependent variable form</li><li>Can always compare s<sub>e</sub> if dependent variable is the same</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Prediction Interval Width</div><ul class="src-items"><li>Narrowest at X<sub>f</sub> = XÃÑ; wider as X<sub>f</sub> deviates from XÃÑ</li><li>Extrapolating outside the data range ‚Üí unreliable wide intervals</li><li>Larger n reduces s<sub>f</sub>; better model fit (lower s<sub>e</sub>) also reduces s<sub>f</sub></li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Indicator Variable Interpretation</div><ul class="src-items"><li>Intercept = mean of Y when indicator = 0 (the reference group)</li><li>Slope = DIFFERENCE in means between the two groups (not the mean of group 1)</li><li>t-test on slope ‚â° two-sample pooled-variance t-test</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Log Model Forecasting</div><ul class="src-items"><li>Log-lin forecast: predicted Y = e<sup>predicted ln Y</sup> (take antilog)</li><li>Cannot compare R¬≤ between log-lin and lin-lin (different dependent variable)</li><li>Log-log slope = elasticity: % change in Y per % change in X</li></ul></div>
    </div>

    <div class="takeaway">
      <h3>Core Mindset for Simple Linear Regression</h3>
      <p>Simple linear regression is the CFA's primary tool for <strong>quantifying relationships and making predictions</strong>. Master four things: (1) <strong>OLS mechanics</strong> ‚Äî slope = Cov(Y,X)/Var(X), intercept = »≤ ‚àí bÃÇ<sub>1</sub>XÃÑ, and residuals sum to zero; (2) the <strong>LINE assumptions</strong> ‚Äî violation patterns show up in residual plots; (3) the <strong>ANOVA decomposition</strong> ‚Äî SST = SSR + SSE drives R¬≤, F, and s<sub>e</sub>, with t¬≤ = F in SLR; and (4) the <strong>prediction interval</strong> ‚Äî it's wider than a confidence interval, narrowest at XÃÑ, and widens with extrapolation. For functional forms, always ask: does transforming the variable improve the residual plot and the fit statistics? And remember ‚Äî statistical significance ‚â† economic significance, especially with large samples.</p>
    </div>

  </div><!-- /.sum-body -->
  </div><!-- /#sum-qm-10 -->



  <!-- ‚îÄ‚îÄ QM-11 SUMMARY: INTRODUCTION TO BIG DATA TECHNIQUES ‚îÄ‚îÄ -->
  <div id="sum-qm-11" class="sum-chapter" style="display:none">
  <div class="sum-hero">
    <div class="sum-hero-label">2026 CFA¬Æ Program ¬∑ Level I ¬∑ QM Reading 11</div>
    <h1>Big Data &amp; <em>Fintech</em></h1>
    <div class="sum-hero-tags">
      <span class="sum-hero-tag">3 Learning Outcomes</span>
      <span class="sum-hero-tag">Fintech</span>
      <span class="sum-hero-tag">Big Data &amp; 4 Vs</span>
      <span class="sum-hero-tag">AI &amp; Machine Learning</span>
      <span class="sum-hero-tag">Supervised / Unsupervised</span>
      <span class="sum-hero-tag">NLP &amp; Text Analytics</span>
      <span class="sum-hero-tag">Data Science</span>
    </div>
  </div>

  <div class="sum-body">

    <!-- Learning Outcomes -->
    <div class="s-header">
      <div class="s-icon">üéØ</div>
      <h2><span>Learning Outcomes</span>What You Need to Master</h2>
    </div>
    <div class="lo-list">
      <div class="lo-item"><span class="lo-pill">LO 1</span><span class="lo-text">Describe aspects of <strong>fintech</strong> that are directly relevant for the gathering and analyzing of financial data</span></div>
      <div class="lo-item"><span class="lo-pill">LO 2</span><span class="lo-text">Describe <strong>Big Data, artificial intelligence, and machine learning</strong> ‚Äî including their characteristics, types, and limitations</span></div>
      <div class="lo-item"><span class="lo-pill">LO 3</span><span class="lo-text">Describe applications of <strong>Big Data and Data Science</strong> to investment management, including text analytics, NLP, visualization, and data processing methods</span></div>
    </div>

    <hr class="s-divider">

    <!-- Fintech -->
    <div class="s-header">
      <div class="s-icon">üíª</div>
      <h2><span>Section 1 ‚Äî LO 1</span>Fintech: What It Is and Why It Matters</h2>
    </div>
    <div class="info-note gold" style="margin-bottom:16px"><strong>Definition:</strong> Fintech = technological innovation in the design and delivery of financial services and products. Spans companies, applications, and entire business sectors challenging incumbent providers.</div>
    <div class="phases-table">
      <div class="phase-row"><div class="phase-n">1</div><div class="phase-body"><div class="phase-title">Early Fintech: Automation of Routine Tasks</div><div class="phase-desc">Data processing and rule-based systems that executed decisions according to specified "if‚Äìthen" instructions. Limited learning; purely deterministic.</div><span class="phase-out">‚Üí Still the backbone of many compliance and back-office systems</span></div></div>
      <div class="phase-row"><div class="phase-n">2</div><div class="phase-body"><div class="phase-title">Modern Fintech: Machine-Learning Logic</div><div class="phase-desc">Computer programs that "learn" how to complete tasks over time from data, rather than following explicit rules. By the late 1990s, faster networks and more powerful processors enabled AI deployment in logistics, data mining, financial analysis, and medical diagnosis.</div><span class="phase-out">‚Üí Neural networks used in credit card fraud detection since the 1980s</span></div></div>
      <div class="phase-row"><div class="phase-n">3</div><div class="phase-body"><div class="phase-title">Investment-Relevant Applications Today</div><div class="phase-desc">Analysis of massive traditional and alternative datasets; AI-based identification of complex, non-linear relationships; NLP to parse earnings calls and filings; algorithmic and high-frequency trading; robo-advisers and financial planning tools.</div><span class="phase-out">‚Üí Relevant to both quantitative managers AND fundamental managers (hybrid decision-making)</span></div></div>
    </div>

    <hr class="s-divider">

    <!-- Big Data -->
    <div class="s-header">
      <div class="s-icon">üóÑÔ∏è</div>
      <h2><span>Section 2 ‚Äî LO 2</span>Big Data: The Four Vs</h2>
    </div>
    <div class="info-note gold" style="margin-bottom:16px"><strong>Core definition:</strong> Vast amounts of information generated by industry, governments, individuals, and electronic devices ‚Äî from both <em>traditional</em> and <em>alternative</em> (non-traditional) sources.</div>
    <div class="kn-grid" style="margin-bottom:16px">
      <div class="kn-box"><div class="kn-num" style="font-size:1.4rem">V<sub>1</sub></div><div class="kn-label"><strong>Volume</strong><br>Scale: MB ‚Üí GB ‚Üí TB ‚Üí PB<br>Billions of data points</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:1.4rem">V<sub>2</sub></div><div class="kn-label"><strong>Velocity</strong><br>Speed: Batch ‚Üí Periodic ‚Üí Near Real-Time ‚Üí Real-Time</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:1.4rem">V<sub>3</sub></div><div class="kn-label"><strong>Variety</strong><br>Structured / Semi-structured / Unstructured<br>SQL tables, HTML, video, audio, images</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:1.4rem">V<sub>4</sub></div><div class="kn-label"><strong>Veracity</strong><br>Credibility &amp; reliability of sources<br>Critical when used for inference or prediction</div></div>
    </div>
    <div class="audit-list">
      <div class="audit-item"><div class="audit-dot" style="background:#1a3a8f"></div><div><h4>Structured Data</h4><p>Organised in tables; each field represents the same type of information. Stored in traditional relational databases (SQL). Examples: stock prices, corporate financials, economic data, trade prices and volumes.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b98a1c"></div><div><h4>Unstructured Data</h4><p>Disparate, unorganised data that cannot be represented in tabular form. Requires specialised applications before it is usable. Examples: social media posts, emails, text messages, voice recordings, images, video, satellite feeds, blog content.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#1a7a4a"></div><div><h4>Semi-Structured Data</h4><p>Has attributes of both structured and unstructured data. Partially organised but not fully conforming to a relational model. Examples: HTML code, XML, JSON files, emails with structured metadata but unstructured body text.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b91c1c"></div><div><h4>Veracity: The Critical Fourth V</h4><p>Becomes especially important with Big Data because of the enormous variety of sources and the risk of mixing high-quality and low-quality data. Big Data amplifies the age-old challenge of disentangling quality from quantity. Requires data curation and cleaning before analysis.</p></div></div>
    </div>

    <hr class="s-divider">

    <!-- Alternative Data Sources -->
    <div class="s-header">
      <div class="s-icon">üåê</div>
      <h2><span>Section 2 ‚Äî LO 2</span>Sources of Big Data: Traditional vs. Alternative</h2>
    </div>
    <table class="cmp-table">
      <thead><tr><th>Category</th><th>Source</th><th>Examples</th><th>Data Type</th></tr></thead>
      <tbody>
        <tr><td><strong>Traditional</strong></td><td>Corporate</td><td>Annual reports, regulatory filings, earnings calls, sales &amp; earnings figures</td><td>Structured</td></tr>
        <tr><td><strong>Traditional</strong></td><td>Market</td><td>Trade prices, trade volumes, exchange data</td><td>Structured</td></tr>
        <tr><td><strong>Alternative</strong></td><td>Individuals</td><td>Social media, product reviews, web search logs, emails, time-on-page data</td><td>Mostly Unstructured</td></tr>
        <tr><td><strong>Alternative</strong></td><td>Business Processes</td><td>Credit card data, corporate exhaust, supply chain info, POS scanner data, banking records</td><td>Mostly Structured</td></tr>
        <tr><td><strong>Alternative</strong></td><td>Sensors</td><td>Satellite imagery, RFID chips, geolocation, smart phone data, IoT devices</td><td>Unstructured</td></tr>
      </tbody>
    </table>
    <div class="filing-grid" style="margin-top:14px">
      <div class="filing-card"><h3>üì¶ Corporate Exhaust</h3><p>Information generated as a by-product of normal business operations ‚Äî supply chain data, banking records, POS scanner data. <strong>Leading or real-time indicator</strong> of business performance vs. quarterly/annual corporate metrics (lagging).</p></div>
      <div class="filing-card"><h3>üõ∞Ô∏è IoT</h3><p>Internet of Things: vast network of physical devices, appliances, smart buildings, vehicles, and sensors embedded with electronics and network connections that share data. The largest-volume category of sensor data ‚Äî growing exponentially.</p></div>
      <div class="filing-card"><h3>‚öñÔ∏è Legal &amp; Ethical Issues</h3><p>Web scraping may capture <strong>personal data protected by regulation</strong>. Best practices still evolving across jurisdictions. National regulations may conflict. Investment professionals must consider whether data is in the public domain.</p></div>
      <div class="filing-card"><h3>üéØ Why Alternative Data?</h3><p>Provides additional insights about <strong>consumer behavior, firm performance, and trends</strong> not captured by traditional sources. Used to generate alpha, improve trade execution, identify new pricing factors, and uncover market trends.</p></div>
    </div>

    <hr class="s-divider">

    <!-- AI and ML -->
    <div class="s-header">
      <div class="s-icon">ü§ñ</div>
      <h2><span>Section 2 ‚Äî LO 2</span>Artificial Intelligence &amp; Machine Learning</h2>
    </div>
    <div class="info-note gold" style="margin-bottom:16px"><strong>AI:</strong> Computer systems capable of performing tasks that traditionally required human intelligence at comparable or superior levels. &nbsp;¬∑&nbsp; <strong>ML:</strong> Computer-based techniques that extract knowledge from large data without assumptions about underlying probability distributions. Goal: "find the pattern, apply the pattern."</div>
    <div class="audit-list">
      <div class="audit-item"><div class="audit-dot" style="background:#1a3a8f"></div><div><h4>Expert Systems (Early AI)</h4><p>Simulated human expert knowledge through "if‚Äìthen" rule sets. Deterministic, not learning-based. Limited to pre-programmed knowledge. Used in early fraud detection and decision support systems.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b98a1c"></div><div><h4>ML: The Three-Dataset Split</h4><p><strong>Training set</strong> ‚Äî algorithm identifies input‚Äìoutput relationships from historical data. <strong>Validation set</strong> ‚Äî model is refined and tuned. <strong>Test set</strong> ‚Äî model's predictive power on entirely new data is evaluated. Must pass all three stages before deployment.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b91c1c"></div><div><h4>Overfitting</h4><p>Model learns the training data <em>too precisely</em> ‚Äî treats noise as true signal. Result: performs well on training data but fails on new data. Indicates a model that is <strong>too complex</strong>. The primary risk in ML investment models.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#1a7a4a"></div><div><h4>Underfitting</h4><p>Model treats true signal as noise ‚Äî fails to recognise genuine patterns in the training data. Result: poor performance even on training data. Indicates a model that is <strong>too simplistic</strong>.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#6b3fa0"></div><div><h4>"Black Box" Problem</h4><p>Because ML techniques are not explicitly programmed, the process by which they arrive at outcomes may be opaque and <strong>difficult to explain or interpret</strong>. A significant concern for compliance, regulatory oversight, and investment attribution.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#8b6914"></div><div><h4>Human Judgment Still Required</h4><p>Despite automation, ML still requires human expertise to: understand the underlying data, select appropriate techniques, clean data of biases and spurious points, and ensure sufficient data volume exists for training and validation.</p></div></div>
    </div>

    <hr class="s-divider">

    <!-- Three Types of ML -->
    <div class="s-header">
      <div class="s-icon">üîÄ</div>
      <h2><span>Section 2 ‚Äî LO 2</span>Three Types of Machine Learning</h2>
    </div>
    <div class="phases-table">
      <div class="phase-row"><div class="phase-n">1</div><div class="phase-body"><div class="phase-title">Supervised Learning</div><div class="phase-desc">Inputs AND outputs are labelled (identified) for the algorithm. The algorithm learns how to map inputs to outputs using historical labelled data, then applies that mapping to new datasets. Requires labelled training data ‚Äî the most data-intensive category.</div><span class="phase-out">‚Üí Examples: predicting stock returns from financial variables; classifying market days as up/flat/down; credit scoring</span></div></div>
      <div class="phase-row"><div class="phase-n">2</div><div class="phase-body"><div class="phase-title">Unsupervised Learning</div><div class="phase-desc">Only inputs (data) are provided ‚Äî no labelled outputs. The algorithm identifies the underlying structure, clusters, or patterns within the data entirely on its own. Does not predict a specific output; instead, discovers hidden organisation.</div><span class="phase-out">‚Üí Examples: grouping companies into peer groups based on characteristics (not standard sectors); customer segmentation; anomaly detection</span></div></div>
      <div class="phase-row"><div class="phase-n">3</div><div class="phase-body"><div class="phase-title">Deep Learning (Deep Neural Networks)</div><div class="phase-desc">Uses neural networks with many hidden layers to perform multistage, non-linear data processing. Can use supervised or unsupervised approaches. Develops understanding of simple concepts that informs analysis of more complex ones ‚Äî "layered" intelligence. Neural networks have existed since 1958; modern deep learning algorithms require less computing power and achieve far better performance.</div><span class="phase-out">‚Üí Examples: image recognition (satellite parking lot counts), speech recognition, pattern recognition in market data</span></div></div>
    </div>
    <div class="info-note blue" style="margin-top:12px"><strong>Why now?</strong> Big Data solved the historic data shortage that constrained ML. Growth in Big Data provided the training volumes needed for neural networks to model relationships with sufficient accuracy. Combined with falling storage costs and faster processors, this unlocked broad ML deployment.</div>

    <hr class="s-divider">

    <!-- Data Science Applications -->
    <div class="s-header">
      <div class="s-icon">üî¨</div>
      <h2><span>Section 3 ‚Äî LO 3</span>Data Science: Processing &amp; Visualisation</h2>
    </div>
    <div class="info-note gold" style="margin-bottom:16px"><strong>Data Science:</strong> Interdisciplinary field harnessing computer science (including ML), statistics, and other disciplines to extract information from Big Data for business and investment purposes.</div>
    <div class="filing-grid" style="margin-bottom:16px">
      <div class="filing-card"><h3>üì• Capture</h3><p>How data are collected and transformed into a usable format. <strong>Low-latency systems</strong> communicate high volumes of data with minimal delay ‚Äî essential for <strong>automated/algorithmic trading</strong>. High-latency systems are acceptable for non-real-time research.</p></div>
      <div class="filing-card"><h3>üßπ Curation</h3><p>The data <strong>cleaning</strong> exercise: reviewing all data to detect errors, bad or inaccurate data, and making adjustments for missing data. Critical first step ‚Äî output quality is bounded by input data quality. Particularly difficult with unstructured alternative data.</p></div>
      <div class="filing-card"><h3>üóÑÔ∏è Storage</h3><p>How data are recorded, archived, and accessed. Key considerations: (1) structured vs. unstructured data; (2) whether analytical needs require low-latency solutions. Database type must match data structure (SQL for structured; NoSQL for unstructured).</p></div>
      <div class="filing-card"><h3>üîç Search</h3><p>How to query and locate specific data within very large datasets. Big Data requires <strong>advanced query applications</strong> capable of rapidly scanning massive stores ‚Äî standard database queries become insufficient at Big Data scale.</p></div>
      <div class="filing-card"><h3>üîÑ Transfer</h3><p>How data move from source or storage to the analytical tool. Mechanisms include direct data feeds (e.g., exchange price feeds), APIs, and batch transfers. Latency requirements dictate transfer method.</p></div>
      <div class="filing-card"><h3>üìä Visualisation</h3><p>Formatting and displaying data graphically to identify trends and relationships. Traditional: tables, charts. For Big Data: interactive 3D graphics, heat maps, tree diagrams, network graphs, tag clouds (word frequency), and mind maps (concept relationships).</p></div>
    </div>

    <hr class="s-divider">

    <!-- Text Analytics and NLP -->
    <div class="s-header">
      <div class="s-icon">üìù</div>
      <h2><span>Section 3 ‚Äî LO 3</span>Text Analytics &amp; Natural Language Processing (NLP)</h2>
    </div>
    <div class="audit-list">
      <div class="audit-item"><div class="audit-dot" style="background:#1a3a8f"></div><div><h4>Text Analytics</h4><p>Computer programs that analyse and derive meaning from large, unstructured text or voice-based datasets ‚Äî company filings, earnings calls, social media, email, internet postings, surveys. Includes: automated information retrieval, lexical analysis (word frequency), pattern recognition (key words and phrases), and predictive analysis (identifying leading indicators).</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b98a1c"></div><div><h4>NLP: Natural Language Processing</h4><p>A specific field within text analytics at the intersection of computer science, AI, and linguistics. Focuses on developing programs to analyse and interpret human language. Automated NLP tasks include: translation, speech recognition, text mining, sentiment analysis, and topic analysis. Used in compliance to review communications for adherence to policy, fraud detection, and confidentiality monitoring.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#1a7a4a"></div><div><h4>Sentiment Analysis in Investment Practice</h4><p>NLP assigns sentiment ratings (very negative ‚Üí very positive) to analyst commentary, earnings call transcripts, and news articles. Detects and monitors shifts in sentiment <strong>ahead of explicit recommendation changes</strong> ‚Äî a leading signal. Scales across thousands of companies worldwide, performing work previously done by human analysts.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#b91c1c"></div><div><h4>Central Bank &amp; Policy Maker Analysis</h4><p>NLP analyses transcripts from central banks (Fed, ECB) for subtle signals in topic selection, word choice, and inferred tone ‚Äî covering interest rate policy, output, and inflation expectations. Identifies trending or waning topics of institutional focus before they are made explicit.</p></div></div>
      <div class="audit-item"><div class="audit-dot" style="background:#6b3fa0"></div><div><h4>NLP Application: IPO and Stock Returns</h4><p>Past research has evaluated the predictive power of Twitter sentiment regarding IPO performance and the effect of positive/negative news sentiment on stock returns. Models incorporating NLP provide <strong>non-traditional information about consumer preferences, opinions, and behaviours</strong> to forecast near-term trends.</p></div></div>
    </div>

    <hr class="s-divider">

    <!-- Programming Languages and Databases -->
    <div class="s-header">
      <div class="s-icon">‚å®Ô∏è</div>
      <h2><span>Section 3 ‚Äî LO 3</span>Programming Languages &amp; Databases</h2>
    </div>
    <table class="cmp-table">
      <thead><tr><th>Tool</th><th>Type</th><th>Key Use Case</th></tr></thead>
      <tbody>
        <tr><td><strong>Python</strong></td><td>Language</td><td>General-purpose fintech applications; accessible to non-programmers; basis of most ML/AI tools</td></tr>
        <tr><td><strong>R</strong></td><td>Language</td><td>Statistical analysis, ML, econometrics, financial analysis; open-source with rich mathematical packages</td></tr>
        <tr><td><strong>Java</strong></td><td>Language</td><td>Cross-platform internet applications; underlying many web-based financial services</td></tr>
        <tr><td><strong>C / C++</strong></td><td>Language</td><td>Optimised source code for maximum calculation speed ‚Äî algorithmic and <strong>high-frequency trading</strong></td></tr>
        <tr><td><strong>Excel VBA</strong></td><td>Language/Macro</td><td>Bridges programming and manual data processing; automates reports and queries for non-programmers</td></tr>
        <tr><td><strong>SQL</strong></td><td>Database</td><td><strong>Structured data</strong> stored in tables with rows and columns; server-based; standard for relational data</td></tr>
        <tr><td><strong>SQLite</strong></td><td>Database</td><td>Structured data; embedded in programs (no server needed); most common database for <strong>mobile apps</strong></td></tr>
        <tr><td><strong>NoSQL</strong></td><td>Database</td><td><strong>Unstructured data</strong> that cannot be summarised in tables ‚Äî the Big Data database solution</td></tr>
      </tbody>
    </table>

    <hr class="s-divider">

    <!-- Key Numbers and Facts -->
    <div class="s-header">
      <div class="s-icon">üî¢</div>
      <h2><span>Critical Facts</span>Exam-Tested Details to Know</h2>
    </div>
    <div class="kn-grid">
      <div class="kn-box"><div class="kn-num" style="font-size:1rem">4 Vs</div><div class="kn-label">Volume, Velocity, Variety (the 3 core Vs) + Veracity (4th V ‚Äî for inference/prediction)</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:1rem">3 Alt.</div><div class="kn-label">Three alternative data sources: Individuals ¬∑ Business Processes ¬∑ Sensors</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:1rem">3 ML</div><div class="kn-label">Three ML types: Supervised ¬∑ Unsupervised ¬∑ Deep Learning</div></div>
      <div class="kn-box"><div class="kn-num" style="font-size:1rem">1958</div><div class="kn-label">Year neural networks were first developed ‚Äî history the exam may reference</div></div>
    </div>

    <hr class="s-divider">

    <!-- Exam Pitfalls -->
    <div class="s-header">
      <div class="s-icon">‚ö°</div>
      <h2><span>Common Pitfalls</span>Exam Traps to Avoid</h2>
    </div>
    <div class="src-grid">
      <div class="src-card"><div class="src-card-hd">‚ùå Veracity: When It Applies</div><ul class="src-items"><li>Veracity is the FOURTH V ‚Äî only relevant when Big Data is used for inference or prediction</li><li>Volume, velocity, and variety apply to ALL Big Data; veracity is an additional concern for analysis</li><li>Big Data amplifies the quantity vs. quality challenge ‚Äî more data ‚â† better data</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Supervised vs. Unsupervised</div><ul class="src-items"><li>Supervised: inputs AND outputs are labelled ‚Üí used to predict specific outcomes</li><li>Unsupervised: only inputs ‚Üí discovers structure/clusters with no predetermined output</li><li>Deep learning can use EITHER supervised OR unsupervised approaches</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Overfitting vs. Underfitting</div><ul class="src-items"><li>Overfitting = too complex; learns noise as signal; fails on new data</li><li>Underfitting = too simple; misses true patterns even in training data</li><li>Both produce bad predictions ‚Äî validation and test sets are designed to catch both</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Corporate Exhaust Timing</div><ul class="src-items"><li>Business process data (including corporate exhaust) can be LEADING or real-time indicators</li><li>Traditional corporate metrics (earnings, financials) are LAGGING ‚Äî reported quarterly or annually</li><li>This timing advantage is the key investment value of alternative data</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå Text Analytics vs. NLP</div><ul class="src-items"><li>Text analytics = broader field using computer programs to analyse unstructured text/voice data</li><li>NLP = specific application of text analytics using linguistic insight into human language structure</li><li>NLP is a subset of text analytics, not a synonym</li></ul></div>
      <div class="src-card"><div class="src-card-hd">‚ùå SQL vs. NoSQL</div><ul class="src-items"><li>SQL ‚Üí structured data in tables ‚Üí server-required ‚Üí relational databases</li><li>SQLite ‚Üí structured data ‚Üí embedded in app ‚Üí no server ‚Üí mobile apps</li><li>NoSQL ‚Üí UNSTRUCTURED data ‚Üí cannot be stored in rows/columns</li></ul></div>
    </div>

    <div class="takeaway">
      <h3>Core Mindset for Big Data &amp; Fintech</h3>
      <p>This reading is fundamentally about <strong>how modern technology has transformed the data available to investors and the tools used to analyse it</strong>. The four Vs frame what Big Data is ‚Äî but <strong>veracity</strong> is the examiner's favourite because it separates the "gathering" Vs (volume, velocity, variety) from the "quality" concern that matters most for investment decisions. Machine learning has three types: <strong>supervised</strong> (labelled input‚Äìoutput, prediction), <strong>unsupervised</strong> (no labels, structure discovery), and <strong>deep learning</strong> (neural networks, layered non-linear processing). The two failure modes ‚Äî <strong>overfitting</strong> (model too complex, memorises noise) and <strong>underfitting</strong> (model too simple, misses signal) ‚Äî are tested directly. For applications, the key insight is that alternative data ‚Äî particularly from individuals, business processes, and sensors ‚Äî provides <strong>leading indicators</strong> that traditional lagging financial data cannot. NLP operationalises this by converting unstructured text into investment signals at machine scale.</p>
    </div>

  </div><!-- /.sum-body -->
  </div><!-- /#sum-qm-11 -->


  </div><!-- /#sum-content -->
</div><!-- /.summary-wrap -->
</div><!-- /#tab-summaries -->

</main>

<footer>
  <div class="footer-logo">CFA Level I ¬∑ Practice Hub</div>
  <div class="footer-note">For study purposes only ¬∑ Not affiliated with CFA Institute</div>
</footer>

</div><!-- /#homePanel -->


<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     EXAM PANEL (React)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="examPanel">
  <div id="app"></div>


</div>


<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     SCRIPTS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->


<!-- Questions data (loaded from questions.js) -->
<script src="questions.js"></script>

<!-- Home page JS -->
<script>
const TOPICS = [
  {
    id: 'fsa', label: 'Financial Statement Analysis', code: 'FSA', icon: 'üìä',
    chapters: [
      { id:'fsa-1',  label:'Financial Statement Analysis',         sub:'R¬∑01', count:100, available:true  },
      { id:'fsa-2',  label:'Analyzing Income Statements',           sub:'R¬∑02', count:0,   available:false },
      { id:'fsa-3',  label:'Analyzing Balance Sheets',              sub:'R¬∑03', count:0,   available:false },
      { id:'fsa-4',  label:'Analyzing Cash Flow Statements',        sub:'R¬∑04', count:0,   available:false },
      { id:'fsa-5',  label:'Financial Analysis Techniques',         sub:'R¬∑05', count:0,   available:false },
      { id:'fsa-6',  label:'Inventories',                           sub:'R¬∑06', count:0,   available:false },
      { id:'fsa-7',  label:'Long-Lived Assets',                     sub:'R¬∑07', count:0,   available:false },
      { id:'fsa-8',  label:'Income Taxes',                          sub:'R¬∑08', count:0,   available:false },
      { id:'fsa-9',  label:'Non-Current Liabilities',               sub:'R¬∑09', count:0,   available:false },
      { id:'fsa-10', label:'Financial Reporting Quality',           sub:'R¬∑10', count:0,   available:false },
      { id:'fsa-11', label:'Financial Statement Analysis Applications', sub:'R¬∑11', count:0, available:false },
    ]
  },
  {
    id: 'quant', label: 'Quantitative Methods', code: 'QM', icon: 'üìê',
    chapters: [
      { id:'qm-1',  label:'Rates and Returns',                              sub:'R¬∑01', count:140, available:true  },
      { id:'qm-2',  label:'Time Value of Money',                           sub:'R¬∑02', count:110, available:true  },
      { id:'qm-3',  label:'Statistical Measures of Asset Returns',         sub:'R¬∑03', count:70,  available:true  },
      { id:'qm-4',  label:'Probability Trees and Conditional Expectations', sub:'R¬∑04', count:70,  available:true  },
      { id:'qm-5',  label:'Portfolio Mathematics',                         sub:'R¬∑05', count:100, available:true  },
      { id:'qm-6',  label:'Simulation Methods',                            sub:'R¬∑06', count:40,  available:true  },
      { id:'qm-7',  label:'Estimation and Inference',                      sub:'R¬∑07', count:50,  available:true  },
      { id:'qm-8',  label:'Hypothesis Testing',                            sub:'R¬∑08', count:0,   available:false },
      { id:'qm-9',  label:'Parametric and Non-Parametric Tests of Independence', sub:'R¬∑09', count:0, available:false },
      { id:'qm-10', label:'Simple Linear Regression',               sub:'R¬∑10', count:0,    available:false },
      { id:'qm-11', label:'Introduction to Big Data Techniques',   sub:'R¬∑11', count:0,    available:false },
    ]
  },
  {
    id: 'econ', label: 'Economics', code: 'ECON', icon: 'üåê',
    chapters: [
      { id:'ec-1',  label:'The Firm and Market Structures',         sub:'R¬∑01', count:0,   available:false },
      { id:'ec-2',  label:'Understanding Business Cycles',          sub:'R¬∑02', count:0,   available:false },
      { id:'ec-3',  label:'Fiscal Policy',                          sub:'R¬∑03', count:0,   available:false },
      { id:'ec-4',  label:'Monetary Policy',                        sub:'R¬∑04', count:0,   available:false },
      { id:'ec-5',  label:'Introduction to Geopolitics',            sub:'R¬∑05', count:0,   available:false },
      { id:'ec-6',  label:'International Trade and Capital Flows',  sub:'R¬∑06', count:0,   available:false },
      { id:'ec-7',  label:'Currency Exchange Rates',                sub:'R¬∑07', count:0,   available:false },
    ]
  },
  {
    id: 'corp', label: 'Corporate Issuers', code: 'CI', icon: 'üè¢',
    chapters: [
      { id:'ci-1',  label:'Organizational Forms, Corporate Issuers', sub:'R¬∑01', count:0,  available:false },
      { id:'ci-2',  label:'Investors and Other Stakeholders',        sub:'R¬∑02', count:0,  available:false },
      { id:'ci-3',  label:'Corporate Governance',                    sub:'R¬∑03', count:0,  available:false },
      { id:'ci-4',  label:'Working Capital and Liquidity',           sub:'R¬∑04', count:0,  available:false },
      { id:'ci-5',  label:'Capital Investments',                     sub:'R¬∑05', count:0,  available:false },
      { id:'ci-6',  label:'Capital Structure',                       sub:'R¬∑06', count:0,  available:false },
      { id:'ci-7',  label:'Business Models',                         sub:'R¬∑07', count:0,  available:false },
    ]
  },
  {
    id: 'equity', label: 'Equity Investments', code: 'EI', icon: 'üìà',
    chapters: [
      { id:'ei-1',  label:'Market Organization and Structure',       sub:'R¬∑01', count:0,  available:false },
      { id:'ei-2',  label:'Security Market Indexes',                 sub:'R¬∑02', count:0,  available:false },
      { id:'ei-3',  label:'Market Efficiency',                       sub:'R¬∑03', count:0,  available:false },
      { id:'ei-4',  label:'Overview of Equity Securities',           sub:'R¬∑04', count:0,  available:false },
      { id:'ei-5',  label:'Introduction to Industry and Company Analysis', sub:'R¬∑05', count:0, available:false },
      { id:'ei-6',  label:'Equity Valuation: Concepts and Tools',    sub:'R¬∑06', count:0,  available:false },
      { id:'ei-7',  label:'Industry and Company Analysis in Practice', sub:'R¬∑07', count:0, available:false },
    ]
  },
  {
    id: 'fi', label: 'Fixed Income', code: 'FI', icon: 'üè¶',
    chapters: [
      { id:'fi-1',  label:'Fixed-Income Instrument Features',        sub:'R¬∑01', count:0,  available:false },
      { id:'fi-2',  label:'Fixed-Income Cash Flows and Types',       sub:'R¬∑02', count:0,  available:false },
      { id:'fi-3',  label:'Fixed-Income Issuance and Trading',       sub:'R¬∑03', count:0,  available:false },
      { id:'fi-4',  label:'Fixed-Income Markets for Corporate Issuers', sub:'R¬∑04', count:0, available:false },
      { id:'fi-5',  label:'Fixed-Income Markets for Government Issuers', sub:'R¬∑05', count:0, available:false },
      { id:'fi-6',  label:'Introduction to Fixed-Income Valuation',  sub:'R¬∑06', count:0,  available:false },
      { id:'fi-7',  label:'Yield-Based Bond Duration Measures',      sub:'R¬∑07', count:0,  available:false },
      { id:'fi-8',  label:'Yield-Based Bond Convexity',              sub:'R¬∑08', count:0,  available:false },
      { id:'fi-9',  label:'Curve-Based and Empirical Fixed-Income Risk', sub:'R¬∑09', count:0, available:false },
      { id:'fi-10', label:'Credit Risk',                             sub:'R¬∑10', count:0,  available:false },
      { id:'fi-11', label:'Credit Analysis for Government Issuers',  sub:'R¬∑11', count:0,  available:false },
      { id:'fi-12', label:'Securitization',                          sub:'R¬∑12', count:0,  available:false },
    ]
  },
  {
    id: 'deriv', label: 'Derivatives', code: 'DERIV', icon: 'üîÄ',
    chapters: [
      { id:'dv-1',  label:'Derivative Instrument and Derivative Market Features', sub:'R¬∑01', count:0, available:false },
      { id:'dv-2',  label:'Forward Commitment and Contingent Claim Features', sub:'R¬∑02', count:0, available:false },
      { id:'dv-3',  label:'Derivative Benefits, Risks, and Issuer Uses', sub:'R¬∑03', count:0, available:false },
      { id:'dv-4',  label:'Arbitrage, Replication, and the Cost of Carry', sub:'R¬∑04', count:0, available:false },
      { id:'dv-5',  label:'Pricing and Valuation of Forward Contracts', sub:'R¬∑05', count:0, available:false },
      { id:'dv-6',  label:'Pricing and Valuation of Futures Contracts', sub:'R¬∑06', count:0, available:false },
      { id:'dv-7',  label:'Pricing and Valuation of Interest Rates and Swaps', sub:'R¬∑07', count:0, available:false },
      { id:'dv-8',  label:'Pricing and Valuation of Options',         sub:'R¬∑08', count:0, available:false },
      { id:'dv-9',  label:'Option Replication Using Put-Call Parity', sub:'R¬∑09', count:0, available:false },
    ]
  },
  {
    id: 'alts', label: 'Alternative Investments', code: 'AI', icon: 'üèõÔ∏è',
    chapters: [
      { id:'ai-1',  label:'Alternative Investment Features',          sub:'R¬∑01', count:0,  available:false },
      { id:'ai-2',  label:'Alternative Investment Performance',       sub:'R¬∑02', count:0,  available:false },
      { id:'ai-3',  label:'Investments in Private Capital',           sub:'R¬∑03', count:0,  available:false },
      { id:'ai-4',  label:'Real Estate and Infrastructure',           sub:'R¬∑04', count:0,  available:false },
      { id:'ai-5',  label:'Natural Resources',                        sub:'R¬∑05', count:0,  available:false },
      { id:'ai-6',  label:'Hedge Funds',                              sub:'R¬∑06', count:0,  available:false },
      { id:'ai-7',  label:'Introduction to Digital Assets',           sub:'R¬∑07', count:0,  available:false },
    ]
  },
  {
    id: 'pm', label: 'Portfolio Management', code: 'PM', icon: 'üéØ',
    chapters: [
      { id:'pm-1',  label:'Portfolio Risk and Return: Part I',        sub:'R¬∑01', count:0,  available:false },
      { id:'pm-2',  label:'Portfolio Risk and Return: Part II',       sub:'R¬∑02', count:0,  available:false },
      { id:'pm-3',  label:'Portfolio Management: An Overview',        sub:'R¬∑03', count:0,  available:false },
      { id:'pm-4',  label:'Basics of Portfolio Planning and Construction', sub:'R¬∑04', count:0, available:false },
      { id:'pm-5',  label:'The Behavioral Biases of Individuals',     sub:'R¬∑05', count:0,  available:false },
      { id:'pm-6',  label:'Introduction to Risk Management',          sub:'R¬∑06', count:0,  available:false },
      { id:'pm-7',  label:'Technical Analysis',                       sub:'R¬∑07', count:0,  available:false },
      { id:'pm-8',  label:'Fintech in Investment Management',         sub:'R¬∑08', count:0,  available:false },
    ]
  },
  {
    id: 'ethics', label: 'Ethical & Professional Standards', code: 'EPS', icon: '‚öñÔ∏è',
    chapters: [
      { id:'ep-1',  label:'Ethics and Trust in the Investment Profession', sub:'R¬∑01', count:0, available:false },
      { id:'ep-2',  label:'Code of Ethics and Standards of Professional Conduct', sub:'R¬∑02', count:0, available:false },
      { id:'ep-3',  label:'Guidance for Standards I‚ÄìVII',             sub:'R¬∑03', count:0,  available:false },
      { id:'ep-4',  label:'Introduction to the Global Investment Performance Standards', sub:'R¬∑04', count:0, available:false },
      { id:'ep-5',  label:'Ethics Application',                       sub:'R¬∑05', count:0,  available:false },
    ]
  },
];

// Helper: get all chapters flat
function allChapters() {
  return TOPICS.flatMap(t => t.chapters);
}
// Helper: total available questions
function totalAvailableQuestions() {
  return allChapters().filter(c => c.available).reduce((s, c) => s + c.count, 0);
}

// Expose to React app
window.TOPICS_REF = Object.fromEntries(TOPICS.map(t => [t.id, t.chapters]));
// Map chapter UI ids ‚Üí chapter field values used in questions.json
// FSA questions use chapter:'FSA'; QM questions use chapter:'1','2','3','4','5'
window.CHAPTER_ID_MAP = {
  'fsa-1':'FSA','fsa-2':'FSA-2','fsa-3':'FSA-3','fsa-4':'FSA-4','fsa-5':'FSA-5',
  'fsa-6':'FSA-6','fsa-7':'FSA-7','fsa-8':'FSA-8','fsa-9':'FSA-9','fsa-10':'FSA-10','fsa-11':'FSA-11',
  'qm-1':'1','qm-2':'2','qm-3':'3','qm-4':'4','qm-5':'5',
  'qm-6':'6','qm-7':'7','qm-8':'8','qm-9':'9','qm-10':'10','qm-11':'11','qm-12':'12',
};

let selectedTopic = null;
let selectedChapter = null;
let shuffleOn = false;
let reactMounted = false;

function buildTopicDropdown() {
  const sel = document.getElementById('topicDropdown');
  sel.innerHTML = '<option value="" disabled selected>‚Äî Select a topic ‚Äî</option>';
  const allOpt = document.createElement('option');
  allOpt.value = 'all';
  const totalQ = totalAvailableQuestions();
  allOpt.textContent = 'üìö  All Topics ‚Äî ' + totalQ + ' questions';
  sel.appendChild(allOpt);
  const sep = document.createElement('option');
  sep.disabled = true; sep.textContent = '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ';
  sel.appendChild(sep);
  TOPICS.forEach(t => {
    const opt = document.createElement('option');
    opt.value = t.id;
    const avail = t.chapters.filter(c => c.available).reduce((s,c) => s+c.count, 0);
    opt.textContent = t.icon + '  ' + t.label + (avail > 0 ? '  ‚Äî ' + avail + ' Qs' : '  (Coming Soon)');
    sel.appendChild(opt);
  });
}

function selectTopic(topicId) {
  selectedTopic = topicId || null;
  selectedChapter = null;
  // Reset chapter dropdown
  buildChapterDropdownForTopic(topicId);
  updatePreview();
  updateStartBtn();
}

function buildChapterDropdownForTopic(topicId) {
  const sel = document.getElementById('chapterDropdown');
  sel.innerHTML = '<option value="" disabled selected>‚Äî Select a chapter ‚Äî</option>';
  sel.disabled = !topicId;
  if (!topicId) return;
  if (topicId === 'all') {
    // "All within each topic" option
    const allOpt = document.createElement('option');
    allOpt.value = 'all';
    allOpt.textContent = 'üìö  All Chapters ‚Äî ' + totalAvailableQuestions() + ' questions';
    sel.appendChild(allOpt);
    return;
  }
  const topic = TOPICS.find(t => t.id === topicId);
  if (!topic) return;
  // All chapters in topic
  const topicTotal = topic.chapters.filter(c => c.available).reduce((s,c) => s+c.count, 0);
  if (topicTotal > 0) {
    const allOpt = document.createElement('option');
    allOpt.value = topicId + '-all';
    allOpt.textContent = 'üìö  All ' + topic.label + ' ‚Äî ' + topicTotal + ' Qs';
    sel.appendChild(allOpt);
    const sep = document.createElement('option');
    sep.disabled = true; sep.textContent = '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ';
    sel.appendChild(sep);
  }
  topic.chapters.forEach(ch => {
    const opt = document.createElement('option');
    opt.value = ch.id;
    if (!ch.available) {
      opt.disabled = true;
      opt.textContent = ch.sub + '  ' + ch.label + '  (Coming Soon)';
    } else {
      opt.textContent = ch.sub + '  ' + ch.label + '  ‚Äî ' + ch.count + ' Qs';
    }
    sel.appendChild(opt);
  });
}

function selectChapter(id) {
  selectedChapter = id || null;
  updatePreview();
  updateStartBtn();
}

function toggleShuffle() {
  shuffleOn = !shuffleOn;
  document.getElementById('shuffleToggle').classList.toggle('on', shuffleOn);
  document.getElementById('previewShuffle').textContent = shuffleOn ? 'On ‚úì' : 'Off';
}

function updatePreview() {
  if (!selectedChapter) {
    document.getElementById('previewChapter').textContent = selectedTopic ? (TOPICS.find(t=>t.id===selectedTopic)||{label:'‚Äî'}).label : '‚Äî';
    document.getElementById('previewCount').textContent = '‚Äî';
    document.getElementById('previewTime').textContent = '‚Äî';
    return;
  }
  let label = '‚Äî', count = 0;
  if (selectedChapter === 'all') {
    label = 'All Chapters'; count = totalAvailableQuestions();
  } else if (selectedChapter.endsWith('-all')) {
    const tId = selectedChapter.replace('-all','');
    const t = TOPICS.find(x => x.id === tId);
    if (t) { label = 'All ' + t.label; count = t.chapters.filter(c=>c.available).reduce((s,c)=>s+c.count,0); }
  } else {
    const ch = allChapters().find(c => c.id === selectedChapter);
    if (ch) { label = ch.sub + ' ¬∑ ' + ch.label.split(' ').slice(0,4).join(' ') + (ch.label.split(' ').length > 4 ? '‚Ä¶' : ''); count = ch.count; }
  }
  document.getElementById('previewChapter').textContent = label;
  document.getElementById('previewCount').textContent = count > 0 ? count + ' questions' : '‚Äî';
  document.getElementById('previewTime').textContent = count > 0 ? '~' + Math.round(count * 1.5) + ' min' : '‚Äî';
}

function updateStartBtn() {
  const btn = document.getElementById('startBtn');
  if (!selectedChapter) {
    btn.classList.add('disabled');
    btn.onclick = null;
    return;
  }
  btn.classList.remove('disabled');
  window.EXAM_CONFIG = { chapter: selectedChapter, shuffle: shuffleOn };
  btn.href = '#';
  btn.onclick = function(e) { e.preventDefault(); launchExam(); };
}

function launchExam() {
  // Set config
  window.EXAM_CONFIG = { chapter: selectedChapter, shuffle: shuffleOn };
  // Show exam panel
  document.getElementById('homePanel').classList.add('hidden');
  document.getElementById('examPanel').classList.add('active');
  document.body.style.overflow = 'hidden';
  // Mount React if not yet done
  if (!reactMounted) {
    mountReact();
    reactMounted = true;
  } else {
    // Re-trigger exam start by reloading the React component
    document.getElementById('app').innerHTML = '';
    reactMounted = false;
    setTimeout(() => { mountReact(); reactMounted = true; }, 50);
  }
}

window.goToHome = function() {
  document.getElementById('examPanel').classList.remove('active');
  document.getElementById('homePanel').classList.remove('hidden');
  document.body.style.overflow = '';
  // Reset React for next session
  document.getElementById('app').innerHTML = '';
  reactMounted = false;
};

buildTopicDropdown();
document.getElementById('chapterDropdown').disabled = true;
// Also build summaries topic dropdown
buildSummaryTopicDropdown();
updateStartBtn();

function buildSummaryTopicDropdown() {
  const sel = document.getElementById('summaryTopicDropdown');
  if (!sel) return;
  sel.innerHTML = '<option value="" disabled selected>‚Äî Select a topic ‚Äî</option>';
  TOPICS.forEach(t => {
    const opt = document.createElement('option');
    opt.value = t.id;
    const hasContent = t.chapters.some(c => c.available);
    opt.textContent = t.icon + '  ' + t.label + (hasContent ? '' : '  (Coming Soon)');
    sel.appendChild(opt);
  });
}

function selectSummaryTopic(topicId) {
  const sel = document.getElementById('summaryChapterDropdown');
  sel.innerHTML = '<option value="" disabled selected>‚Äî Select a chapter ‚Äî</option>';
  sel.disabled = false;
  const topic = TOPICS.find(t => t.id === topicId);
  if (!topic) return;

  // Chapters that have a written summary
  const summaryReady = new Set(['fsa-1', 'qm-1', 'qm-2', 'qm-3', 'qm-4', 'qm-5', 'qm-6', 'qm-7', 'qm-8', 'qm-9', 'qm-10', 'qm-11']);

  topic.chapters.forEach(ch => {
    const opt = document.createElement('option');
    opt.value = ch.id;
    if (summaryReady.has(ch.id)) {
      opt.textContent = ch.sub + '  ' + ch.label + '  ‚úì';
    } else {
      opt.disabled = true;
      opt.textContent = ch.sub + '  ' + ch.label + '  (Coming Soon)';
    }
    sel.appendChild(opt);
  });
}

function loadSummary(chapterId) {
  const empty = document.getElementById('sum-empty');
  const content = document.getElementById('sum-content');
  if (!chapterId) {
    empty.style.display = '';
    content.style.display = 'none';
    return;
  }

  // Map of chapter IDs that have summary content available
  const summaryMap = {
    'fsa-1': 'sum-fsa-1',
    'qm-1':  'sum-qm-1',
    'qm-2':  'sum-qm-2',
    'qm-3':  'sum-qm-3',
    'qm-4':  'sum-qm-4',
    'qm-5':  'sum-qm-5',
    'qm-6':  'sum-qm-6',
    'qm-7':  'sum-qm-7',
    'qm-8':  'sum-qm-8',
    'qm-9':  'sum-qm-9',
    'qm-10': 'sum-qm-10',
    'qm-11': 'sum-qm-11',
  };

  const targetId = summaryMap[chapterId];
  if (targetId) {
    // Hide all chapter summary divs
    document.querySelectorAll('.sum-chapter').forEach(el => el.style.display = 'none');
    // Show the right one
    document.getElementById(targetId).style.display = '';
    empty.style.display = 'none';
    content.style.display = '';
    content.scrollIntoView({ behavior: 'smooth', block: 'start' });
  } else {
    // No summary yet for this chapter
    document.querySelectorAll('.sum-chapter').forEach(el => el.style.display = 'none');
    empty.style.display = '';
    content.style.display = 'none';
  }
}

function switchHomeTab(name, btn) {
  document.querySelectorAll('.tab-pane').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.home-tab').forEach(b => b.classList.remove('active'));
  document.getElementById('tab-' + name).classList.add('active');
  btn.classList.add('active');
}
</script>

<!-- React -->
<script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

<script type="text/babel">

        const { useState, useEffect } = React;

        // Questions are loaded from ./questions.json (kept in the same folder as this HTML)
async function fetchQuestions() {
    // Load from window.QUESTIONS_DATA set by questions.js (works with file:// and http://)
    const raw = window.QUESTIONS_DATA;
    if (!Array.isArray(raw) || raw.length === 0) {
        throw new Error('questions.js not loaded. Make sure questions.js is in the same folder as index.html.');
    }
    // Normalise difficulty: "Medium" -> "Moderate" for consistent styling
    return raw.map(q => ({
        ...q,
        difficulty: q.difficulty === 'Medium' ? 'Moderate' : q.difficulty
    }));
}

// Shuffle helper (Fisher‚ÄìYates)
function shuffleArray(array) {
    const shuffled = [...array];
    for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
    }
    return shuffled;
}
function FinanceExamApp() {
            // allQuestions: full bank loaded from questions.json
            // questions: active exam set (after chapter filter / shuffle)
            const [allQuestions, setAllQuestions] = useState([]);
            const [questions, setQuestions] = useState([]);
            const [isLoadingQuestions, setIsLoadingQuestions] = useState(false);
            const [loadError, setLoadError] = useState('');
            const [selectedChapters, setSelectedChapters] = useState(new Set());
            const [chapterSelection, setChapterSelection] = useState('ALL');
            const [shuffleEnabled, setShuffleEnabled] = useState(true);
            const [examStarted, setExamStarted] = useState(false);
            const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
            const [selectedAnswer, setSelectedAnswer] = useState('');
            const [answers, setAnswers] = useState({});
            const [markedForReview, setMarkedForReview] = useState(new Set());
            const [eliminatedOptions, setEliminatedOptions] = useState({});
            const [showResults, setShowResults] = useState(false);
            const [timeElapsed, setTimeElapsed] = useState(0);


            // Load and auto-start from home page config
            useEffect(() => {
                if (allQuestions.length > 0 || isLoadingQuestions) return;
                (async () => {
                    try {
                        setIsLoadingQuestions(true);
                        setLoadError('');
                        const data = await fetchQuestions();
                        setAllQuestions(data);

                        // Auto-start using config from home page
                        const config = window.EXAM_CONFIG || { chapter: 'all', shuffle: false };
                        let filtered = data;

                        if (config.chapter && config.chapter !== 'all') {
                          // Build lookup: chapter UI id -> chapter label (e.g. 'qm-1' -> 'Rates and Returns')
                          const allTopicChapters = Object.values(window.TOPICS_REF || {}).flat();
                          const idToLabel = {};
                          allTopicChapters.forEach(ch => { idToLabel[ch.id] = ch.label; });

                          if (config.chapter.endsWith('-all')) {
                            // All chapters within a topic e.g. 'quant-all'
                            const topicId = config.chapter.replace('-all', '');
                            const topicChapters = (window.TOPICS_REF[topicId] || []);
                            const validLabels = new Set(topicChapters.map(ch => ch.label));
                            filtered = data.filter(q => validLabels.has(q.chapterName));
                          } else {
                            // Single chapter -- match by chapterName label
                            const targetLabel = idToLabel[config.chapter];
                            if (targetLabel) {
                              filtered = data.filter(q => q.chapterName === targetLabel);
                            } else {
                              filtered = data.filter(q => String(q.chapter) === String(config.chapter));
                            }
                          }
                        }

                        if (filtered.length === 0) {
                          setLoadError('No questions found for the selected chapter. Please go back and choose a different selection.');
                          setIsLoadingQuestions(false);
                          return;
                        }

                        const active = config.shuffle ? shuffleArray(filtered) : filtered;
                        setQuestions(active);
                        setExamStarted(true);
                        setCurrentQuestionIndex(0);
                        setSelectedAnswer('');
                        setAnswers({});
                        setMarkedForReview(new Set());
                        setEliminatedOptions({});
                        setShowResults(false);
                        setTimeElapsed(0);

                        const chapters = new Set(data.map(q => String(q.chapter)));
                        setSelectedChapters(chapters);
                        setChapterSelection('ALL');
                    } catch (e) {
                        console.error(e);
                        setLoadError(e?.message || 'Failed to load questions');
                    } finally {
                        setIsLoadingQuestions(false);
                    }
                })();
            }, []);

            // Timer
            useEffect(() => {
                if (examStarted && !showResults) {
                    const timer = setInterval(() => {
                        setTimeElapsed(prev => prev + 1);
                    }, 1000);
                    return () => clearInterval(timer);
                }
            }, [examStarted, showResults]);

            const formatTime = (seconds) => {
                const hrs = Math.floor(seconds / 3600);
                const mins = Math.floor((seconds % 3600) / 60);
                const secs = seconds % 60;
                return `${hrs.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            };

            const currentQuestion = questions[currentQuestionIndex];
            const totalQuestions = questions.length;
            const progress = ((currentQuestionIndex + 1) / totalQuestions) * 100;
            const answeredCount = Object.keys(answers).length;

            const handleAnswerSelect = (option) => {
                setSelectedAnswer(option);
            };

            const handleConfirm = () => {
                if (selectedAnswer) {
                    const newAnswers = {
                        ...answers,
                        [currentQuestion.id]: {
                            selected: selectedAnswer,
                            timeSpent: timeElapsed
                        }
                    };
                    setAnswers(newAnswers);
                    
                    // Auto-advance
                    if (currentQuestionIndex < totalQuestions - 1) {
                        setTimeout(() => {
                            setCurrentQuestionIndex(currentQuestionIndex + 1);
                            setSelectedAnswer('');
                        }, 200);
                    }
                }
            };

            const handlePrevious = () => {
                if (currentQuestionIndex > 0) {
                    setCurrentQuestionIndex(currentQuestionIndex - 1);
                    const prevAnswer = answers[questions[currentQuestionIndex - 1].id];
                    setSelectedAnswer(prevAnswer?.selected || '');
                }
            };

            const handleNext = () => {
                if (currentQuestionIndex < totalQuestions - 1) {
                    setCurrentQuestionIndex(currentQuestionIndex + 1);
                    const nextAnswer = answers[questions[currentQuestionIndex + 1].id];
                    setSelectedAnswer(nextAnswer?.selected || '');
                }
            };

            const toggleEliminate = (questionId, option) => {
                const key = `${questionId}-${option}`;
                setEliminatedOptions({
                    ...eliminatedOptions,
                    [key]: !eliminatedOptions[key]
                });
            };

            const toggleRevisit = () => {
                const newMarked = new Set(markedForReview);
                if (newMarked.has(currentQuestion.id)) {
                    newMarked.delete(currentQuestion.id);
                } else {
                    newMarked.add(currentQuestion.id);
                }
                setMarkedForReview(newMarked);
            };

            const markedCount = markedForReview.size;

            const goToNextMarked = () => {
                if (markedForReview.size === 0) return;
                // Find next marked question after current index (wrap around)
                const n = questions.length;
                for (let step = 1; step <= n; step++) {
                    const j = (currentQuestionIndex + step) % n;
                    if (markedForReview.has(questions[j].id)) {
                        setCurrentQuestionIndex(j);
                        setSelectedAnswer('');
                        return;
                    }
                }
            };

            const clearAllMarked = () => {
                if (markedForReview.size === 0) return;
                const ok = window.confirm("Clear all review marks?");
                if (!ok) return;
                setMarkedForReview(new Set());
            };


            const calculateScore = () => {
                let correct = 0;
                let total = 0;
                
                questions.forEach(q => {
                    if (answers[q.id]) {
                        total++;
                        if (answers[q.id].selected === q.correctAnswer) {
                            correct++;
                        }
                    }
                });
                
                return { 
                    correct, 
                    total, 
                    percentage: total > 0 ? ((correct / total) * 100).toFixed(1) : 0,
                    unanswered: questions.length - total
                };
            };

            const getAnalysisByDifficulty = () => {
                const byDifficulty = { 
                    Easy: { correct: 0, total: 0 }, 
                    Moderate: { correct: 0, total: 0 }, 
                    Difficult: { correct: 0, total: 0 } 
                };
                
                questions.forEach(q => {
                    if (answers[q.id]) {
                        byDifficulty[q.difficulty].total++;
                        if (answers[q.id].selected === q.correctAnswer) {
                            byDifficulty[q.difficulty].correct++;
                        }
                    }
                });
                
                return byDifficulty;
            };

            const getAnalysisByChapter = () => {
                const byChapter = {};
                
                questions.forEach(q => {
                    if (!byChapter[q.chapter]) {
                        byChapter[q.chapter] = { 
                            name: q.chapterName, 
                            correct: 0, 
                            total: 0 
                        };
                    }
                    if (answers[q.id]) {
                        byChapter[q.chapter].total++;
                        if (answers[q.id].selected === q.correctAnswer) {
                            byChapter[q.chapter].correct++;
                        }
                    }
                });
                
                return byChapter;
            };


            // Chapter list for chapter-wise practice mode
            const chapterOptions = (() => {
                const map = new Map();
                allQuestions.forEach(q => {
                    const key = String(q.chapter);
                    const name = q.chapterName ? String(q.chapterName) : `Chapter ${key}`;
                    if (!map.has(key)) map.set(key, name);
                });
                return Array.from(map.entries())
                    .map(([chapter, chapterName]) => ({ chapter, chapterName }))
                    .sort((a, b) => Number(a.chapter) - Number(b.chapter));
            })();

            
const handleChapterSelection = (value) => {
    setChapterSelection(value);
    if (value === 'ALL') {
        setSelectedChapters(new Set(chapterOptions.map(c => c.chapter)));
    } else {
        setSelectedChapters(new Set([value]));
    }
};

            const startExamWithSettings = () => {
                // Build filtered set
                const filtered = (allQuestions.length ? allQuestions : []).filter(q => selectedChapters.has(String(q.chapter)));
                if (filtered.length === 0) {
                    setLoadError('Please select at least one chapter to start.');
                    return;
                }

                const active = shuffleEnabled ? shuffleArray(filtered) : filtered;

                // Reset exam state
                setQuestions(active);
                setExamStarted(true);
                setCurrentQuestionIndex(0);
                setSelectedAnswer('');
                setAnswers({});
                setMarkedForReview(new Set());
                setEliminatedOptions({});
                setShowResults(false);
                setTimeElapsed(0);
                setLoadError('');
            };

            const exitExam = () => {
                const ok = window.confirm("Submit and view your results?");
                if (!ok) return;
                setShowResults(true);
            };

            // Auto-start from home page config (no internal start screen)
            if (!examStarted) {
                if (loadError) {
                    return (
                        <div style={{ minHeight:'100vh', background:'#faf8f3', fontFamily:"'DM Sans',sans-serif", display:'flex', alignItems:'center', justifyContent:'center', padding:24 }}>
                            <div style={{ maxWidth:480, width:'100%', background:'#fff', border:'1px solid #ddd8cc', borderRadius:20, padding:'48px 40px', boxShadow:'0 6px 28px rgba(15,30,60,.12)', textAlign:'center' }}>
                                <div style={{ width:56, height:56, background:'#fdecea', borderRadius:'50%', display:'flex', alignItems:'center', justifyContent:'center', margin:'0 auto 20px', fontSize:'1.5rem' }}>‚ö†Ô∏è</div>
                                <h2 style={{ fontFamily:"'Cormorant Garamond',serif", fontSize:'1.6rem', fontWeight:700, color:'#0f1e3c', marginBottom:12 }}>No Questions Found</h2>
                                <p style={{ fontSize:'.88rem', color:'#7a7a9a', lineHeight:1.6, marginBottom:28 }}>{loadError}</p>
                                <button
                                    onClick={() => window.goToHome && window.goToHome()}
                                    style={{ display:'inline-flex', alignItems:'center', gap:8, padding:'13px 32px', background:'linear-gradient(135deg,#0f1e3c,#243a6b)', color:'#e8c97a', border:'none', borderRadius:10, fontFamily:"'DM Sans',sans-serif", fontSize:'.9rem', fontWeight:700, cursor:'pointer', boxShadow:'0 4px 16px rgba(15,30,60,.2)' }}
                                >
                                    ‚Üê Back to Home Page
                                </button>
                            </div>
                        </div>
                    );
                }
                return (
                    <div className="min-h-screen gradient-bg flex items-center justify-center">
                        <div className="text-white text-center">
                            <div className="text-6xl mb-6">üìö</div>
                            <p className="text-xl font-medium opacity-75">Loading exam‚Ä¶</p>
                        </div>
                    </div>
                );
            }
            if (false && !examStarted) {
                return (
                    <div className="min-h-screen gradient-bg flex items-center justify-center p-4">
                        <div className="bg-white rounded-3xl card-shadow p-12 max-w-3xl w-full">
                            <div className="text-center">
                                <div className="w-24 h-24 bg-slate-50 rounded-3xl flex items-center justify-center mx-auto mb-6 transform rotate-12">
                                    <svg className="w-12 h-12 text-white transform -rotate-12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2.5} d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                                    </svg>
                                </div>
                                <h1 className="text-3xl font-bold text-gray-800 mb-3">Practice Session</h1>
                                <p className="text-lg text-gray-600 mb-10">Test Your Knowledge</p>
                                
                                <div className="bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl p-8 mb-10">
                                    <div className="grid grid-cols-2 gap-8">
                                        <div className="text-left">
                                            <p className="text-sm text-gray-600 mb-2 font-medium">Questions</p>
                                            <p className="text-4xl font-bold text-emerald-600">{allQuestions.length ? allQuestions.filter(q => selectedChapters.has(String(q.chapter))).length : '‚Äî'}</p>
                                        </div>
                                        <div className="text-left">
                                            <p className="text-sm text-gray-600 mb-2 font-medium">Time Limit</p>
                                            <p className="text-4xl font-bold text-emerald-600">None</p>
                                        </div>
                                        <div className="col-span-2 text-left">
                                            <p className="text-sm text-gray-600 mb-3 font-medium">Topics Covered</p>
                                            <div className="flex flex-wrap gap-2">
                                                <span className="bg-white px-4 py-2 rounded-full text-sm font-semibold text-emerald-700 shadow-sm">Quantitative Methods</span>
                                                                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div className="text-left bg-gray-50 rounded-2xl p-6 mb-10">
                                    <h3 className="font-bold text-gray-800 mb-4 text-lg">How it works:</h3>
                                    <ul className="space-y-3 text-gray-700">
                                        <li className="flex items-start">
                                            <span className="text-2xl mr-3">‚úì</span>
                                            <span>Select your answer and click <strong>Submit</strong> to move forward</span>
                                        </li>
                                        <li className="flex items-start">
                                            <span className="text-2xl mr-3">‚úì</span>
                                            <span>Use navigation arrows to review previous questions</span>
                                        </li>
                                        <li className="flex items-start">
                                            <span className="text-2xl mr-3">‚úì</span>
                                            <span>Mark tricky questions to revisit later</span>
                                        </li>
                                        <li className="flex items-start">
                                            <span className="text-2xl mr-3">‚úì</span>
                                            <span>Get detailed results and explanations at the end</span>
                                        </li>
                                    </ul>
                                </div>
                                

                                {/* Practice settings */}
                                <div className="text-left bg-white border border-gray-200 rounded-2xl p-6 mb-8">
                                    <h3 className="font-bold text-gray-800 mb-4 text-lg">Practice settings</h3>

                                    <label className="flex items-center space-x-3 mb-5 cursor-pointer select-none">
                                        <input
                                            type="checkbox"
                                            checked={shuffleEnabled}
                                            onChange={(e) => setShuffleEnabled(e.target.checked)}
                                            className="h-5 w-5"
                                        />
                                        <span className="text-gray-700 font-medium">Shuffle questions</span>
                                    </label>

                                    
<div className="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-4">
    <div className="flex-1">
        <div className="font-semibold text-gray-800 mb-2">Chapter</div>
        <p className="text-sm text-gray-600">Pick one chapter (or All). Your exam will load questions from that selection.</p>
    </div>

    <div className="sm:w-80">
        <select
            value={chapterSelection}
            onChange={(e) => handleChapterSelection(e.target.value)}
            className="w-full border border-gray-300 rounded-xl px-4 py-3 bg-white focus:outline-none focus:ring-2 focus:ring-purple-300"
        >
            <option value="ALL">All chapters</option>
            {chapterOptions.map(c => (
                <option key={c.chapter} value={c.chapter}>
                    {`Ch ${c.chapter}: ${c.chapterName}`}
                </option>
            ))}
        </select>

        <div className="mt-2 text-xs text-gray-500">
            Questions in selection: <strong>{allQuestions.length ? allQuestions.filter(q => selectedChapters.has(String(q.chapter))).length : '‚Äî'}</strong>
        </div>
    </div>
</div>

<div className="mt-4 text-xs text-gray-500">

                                        Tip: If chapters don‚Äôt show, make sure you opened this page via <strong>http://localhost:8001/...</strong> and <strong>questions.json</strong> is in the same folder.
                                    </div>
                                </div>

                                <button 
                                    disabled={isLoadingQuestions || allQuestions.length === 0}
                                    onClick={startExamWithSettings}
                                    className="gradient-bg text-white px-16 py-5 rounded-2xl font-bold text-lg hover:shadow-2xl transition-all transform hover:scale-105"
                                >
                                    {isLoadingQuestions ? 'Loading Questions‚Ä¶' : 'Begin Practice Exam'}
                                </button>

{loadError && (
    <div className="mt-6 text-left bg-red-50 border-2 border-red-200 text-red-700 rounded-2xl p-5">
        <div className="font-bold mb-1">Could not start the exam</div>
        <div className="text-sm">
            {loadError}
            <div className="mt-2 text-xs text-red-600">
                Tip: Make sure <strong>questions.json</strong> is in the same folder and you opened the app via
                <strong> http://localhost:8000/finance-practice-exam.html</strong> (not by double-clicking the HTML).
            </div>
        </div>
    </div>
)}

                            </div>
                        </div>
                    </div>
                );
            }


// If exam has started but questions haven't loaded yet (or failed), show a friendly screen
if (examStarted && questions.length === 0) {
    return (
        <div className="min-h-screen gradient-bg flex items-center justify-center p-4">
            <div className="bg-white rounded-3xl card-shadow p-10 max-w-xl w-full text-center">
                <h2 className="text-3xl font-bold text-gray-800 mb-3">Loading questions‚Ä¶</h2>
                <p className="text-gray-600 mb-6">Please wait.</p>
                {loadError && (
                    <div className="text-left bg-red-50 border-2 border-red-200 text-red-700 rounded-2xl p-5">
                        <div className="font-bold mb-1">Error</div>
                        <div className="text-sm">{loadError}</div>
                    </div>
                )}
                <button
                    onClick={() => {
                        setExamStarted(false);
                        setIsLoadingQuestions(false);
                    }}
                    className="mt-6 gradient-bg text-white px-8 py-3 rounded-2xl font-bold hover:shadow-2xl transition-all"
                >
                    Back
                </button>
            </div>
        </div>
    );
}

            // Results Screen
            if (showResults) {
                const score = calculateScore();
                const analysisByDifficulty = getAnalysisByDifficulty();
                const analysisByChapter = getAnalysisByChapter();
                const passed = parseFloat(score.percentage) >= 70;

                const difficultyMeta = {
                    Easy:     { bar: '#1a7a4a', badge: { bg: '#e8f7ef', color: '#1a5c3a' } },
                    Moderate: { bar: '#a07c30', badge: { bg: '#f7f0dc', color: '#7a5a10' } },
                    Difficult:{ bar: '#8b1a1a', badge: { bg: '#fdecea', color: '#8b1a1a' } },
                };

                const SectionEyebrow = ({ label }) => (
                    <div style={{ display:'flex', alignItems:'center', gap:10, marginBottom:10 }}>
                        <div style={{ width:28, height:2, background:'#c9a84c', borderRadius:2, flexShrink:0 }} />
                        <span style={{ fontSize:'.66rem', fontWeight:700, letterSpacing:'.14em', textTransform:'uppercase', color:'#c9a84c' }}>{label}</span>
                    </div>
                );

                return (
                    <div style={{ minHeight:'100vh', background:'#faf8f3', fontFamily:"'DM Sans', sans-serif" }}>

                        {/* ‚îÄ‚îÄ Top header bar ‚îÄ‚îÄ */}
                        <div style={{ background:'#0f1e3c', padding:'18px 40px', display:'flex', alignItems:'center', justifyContent:'space-between', position:'relative', overflow:'hidden' }}>
                            {/* grid overlay */}
                            <div style={{ position:'absolute', inset:0, backgroundImage:'repeating-linear-gradient(90deg,transparent,transparent 79px,rgba(201,168,76,.04) 79px,rgba(201,168,76,.04) 80px),repeating-linear-gradient(0deg,transparent,transparent 79px,rgba(201,168,76,.04) 79px,rgba(201,168,76,.04) 80px)', pointerEvents:'none' }} />
                            <div style={{ display:'flex', alignItems:'center', gap:14, position:'relative' }}>
                                <div style={{ width:42, height:42, background:'linear-gradient(135deg,#c9a84c,#a07c30)', borderRadius:9, display:'flex', alignItems:'center', justifyContent:'center', fontFamily:"'Cormorant Garamond',serif", fontSize:'1.1rem', fontWeight:700, color:'#0f1e3c', flexShrink:0, boxShadow:'0 4px 12px rgba(201,168,76,.35)' }}>CFA</div>
                                <div>
                                    <div style={{ fontFamily:"'Cormorant Garamond',serif", color:'#fff', fontSize:'1.05rem', fontWeight:600, lineHeight:1.2 }}>Practice Hub</div>
                                    <div style={{ color:'rgba(255,255,255,.4)', fontSize:'.66rem', letterSpacing:'.12em', textTransform:'uppercase', marginTop:2 }}>Results &amp; Analysis</div>
                                </div>
                            </div>
                            <button
                                onClick={() => window.goToHome && window.goToHome()}
                                style={{ background:'rgba(201,168,76,.15)', border:'1px solid rgba(201,168,76,.3)', color:'#e8c97a', padding:'8px 20px', borderRadius:8, fontFamily:"'DM Sans',sans-serif", fontSize:'.8rem', fontWeight:600, cursor:'pointer', position:'relative', letterSpacing:'.03em', transition:'all .2s' }}
                                onMouseOver={e => e.currentTarget.style.background='rgba(201,168,76,.28)'}
                                onMouseOut={e => e.currentTarget.style.background='rgba(201,168,76,.15)'}
                            >
                                ‚Üê Home
                            </button>
                        </div>

                        {/* ‚îÄ‚îÄ Hero score banner ‚îÄ‚îÄ */}
                        <div style={{ background:'#0f1e3c', padding:'52px 40px 0', position:'relative', overflow:'hidden' }}>
                            <div style={{ position:'absolute', inset:0, background:'radial-gradient(ellipse 60% 80% at 10% 60%,rgba(201,168,76,.09) 0%,transparent 60%),radial-gradient(ellipse 80% 60% at 50% 100%,rgba(15,30,60,1) 0%,transparent 70%)', pointerEvents:'none' }} />
                            <div style={{ position:'absolute', inset:0, backgroundImage:'repeating-linear-gradient(0deg,transparent,transparent 49px,rgba(201,168,76,.05) 49px,rgba(201,168,76,.05) 50px),repeating-linear-gradient(90deg,transparent,transparent 49px,rgba(201,168,76,.05) 49px,rgba(201,168,76,.05) 50px)', pointerEvents:'none' }} />
                            <div style={{ maxWidth:1100, margin:'0 auto', position:'relative', paddingBottom:56 }}>

                                {/* eyebrow */}
                                <div style={{ display:'inline-flex', alignItems:'center', gap:8, background:'rgba(201,168,76,.12)', border:'1px solid rgba(201,168,76,.25)', borderRadius:20, padding:'5px 14px 5px 10px', marginBottom:28 }}>
                                    <div style={{ width:6, height:6, background:'#c9a84c', borderRadius:'50%' }} />
                                    <span style={{ fontSize:'.72rem', fontWeight:600, letterSpacing:'.1em', textTransform:'uppercase', color:'#c9a84c' }}>2026 CFA¬Æ Program ¬∑ Level I ¬∑ Session Results</span>
                                </div>

                                <div style={{ display:'grid', gridTemplateColumns:'1fr auto', gap:48, alignItems:'center' }}>
                                    <div>
                                        <h1 style={{ fontFamily:"'Cormorant Garamond',serif", color:'#fff', fontSize:'clamp(2.4rem,4.5vw,3.6rem)', fontWeight:700, lineHeight:1.08, letterSpacing:'-.02em', marginBottom:16 }}>
                                            {passed ? <span>Well done ‚Äî <em style={{ color:'#e8c97a', fontStyle:'italic' }}>keep it up!</em></span> : <span>Keep <em style={{ color:'#e8c97a', fontStyle:'italic' }}>practising</em></span>}
                                        </h1>
                                        <p style={{ color:'rgba(255,255,255,.55)', fontSize:'.95rem', lineHeight:1.7, maxWidth:460, marginBottom:32 }}>
                                            You answered <strong style={{ color:'#e8c97a' }}>{score.total}</strong> of <strong style={{ color:'#e8c97a' }}>{questions.length}</strong> questions.
                                            {score.unanswered > 0 && <span> <strong style={{ color:'rgba(255,255,255,.4)' }}>{score.unanswered} skipped.</strong></span>}
                                            {' '}Detailed answers and explanations are below.
                                        </p>
                                        {/* stat row */}
                                        <div style={{ display:'flex', gap:32, flexWrap:'wrap', paddingTop:24, borderTop:'1px solid rgba(255,255,255,.08)' }}>
                                            {[
                                                { num: score.correct,              label: 'Correct' },
                                                { num: score.total - score.correct, label: 'Incorrect' },
                                                { num: score.unanswered,            label: 'Skipped' },
                                                { num: formatTime(timeElapsed),     label: 'Time Taken' },
                                            ].map(s => (
                                                <div key={s.label}>
                                                    <div style={{ fontFamily:"'Cormorant Garamond',serif", fontSize:'1.9rem', fontWeight:700, color:'#e8c97a', lineHeight:1 }}>{s.num}</div>
                                                    <div style={{ fontSize:'.7rem', color:'rgba(255,255,255,.4)', textTransform:'uppercase', letterSpacing:'.08em', marginTop:3 }}>{s.label}</div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>

                                    {/* Big score circle */}
                                    <div style={{ textAlign:'center', flexShrink:0 }}>
                                        <div style={{ width:160, height:160, borderRadius:'50%', background:'rgba(201,168,76,.12)', border:'2px solid rgba(201,168,76,.3)', display:'flex', flexDirection:'column', alignItems:'center', justifyContent:'center', boxShadow:'0 0 48px rgba(201,168,76,.15)' }}>
                                            <div style={{ fontFamily:"'Cormorant Garamond',serif", fontSize:'3rem', fontWeight:700, color:'#e8c97a', lineHeight:1 }}>{score.percentage}%</div>
                                            <div style={{ fontSize:'.65rem', fontWeight:600, letterSpacing:'.1em', textTransform:'uppercase', color:'rgba(255,255,255,.4)', marginTop:6 }}>Score</div>
                                        </div>
                                        {/* progress arc bar */}
                                        <div style={{ marginTop:14, width:160, height:6, background:'rgba(255,255,255,.1)', borderRadius:3, overflow:'hidden' }}>
                                            <div style={{ height:'100%', width:`${score.percentage}%`, background:'linear-gradient(90deg,#c9a84c,#e8c97a)', borderRadius:3, transition:'width 1s ease' }} />
                                        </div>
                                        <div style={{ marginTop:6, fontSize:'.7rem', color:'rgba(255,255,255,.3)', letterSpacing:'.06em' }}>
                                            {passed ? '‚úì ABOVE THRESHOLD' : '‚Üë TARGET: 70%'}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* wave */}
                        <div style={{ display:'block', width:'100%', height:56, background:'#0f1e3c', clipPath:'ellipse(55% 100% at 50% 0%)', marginBottom:-2 }} />

                        {/* ‚îÄ‚îÄ Body content ‚îÄ‚îÄ */}
                        <div style={{ maxWidth:1100, margin:'0 auto', padding:'40px 40px 80px' }}>

                            {/* ‚îÄ‚îÄ Performance Breakdown ‚îÄ‚îÄ */}
                            <div style={{ marginBottom:48 }}>
                                <SectionEyebrow label="Performance Breakdown" />
                                <h2 style={{ fontFamily:"'Cormorant Garamond',serif", fontSize:'clamp(1.5rem,2.8vw,2rem)', fontWeight:700, color:'#0f1e3c', lineHeight:1.2, marginBottom:24 }}>Score by Difficulty &amp; Chapter</h2>
                                <div style={{ display:'grid', gridTemplateColumns:'repeat(auto-fit,minmax(300px,1fr))', gap:24 }}>

                                    {/* By difficulty */}
                                    <div style={{ background:'#fff', border:'1px solid #ddd8cc', borderRadius:16, overflow:'hidden', boxShadow:'0 2px 12px rgba(15,30,60,.07)' }}>
                                        <div style={{ background:'#0f1e3c', padding:'14px 22px', display:'flex', alignItems:'center', gap:10 }}>
                                            <span style={{ fontSize:'.65rem', fontWeight:700, letterSpacing:'.14em', textTransform:'uppercase', color:'#e8c97a' }}>By Difficulty</span>
                                        </div>
                                        <div style={{ padding:'20px 22px', display:'flex', flexDirection:'column', gap:14 }}>
                                            {Object.entries(analysisByDifficulty).map(([difficulty, stats]) => {
                                                const pct = stats.total > 0 ? ((stats.correct / stats.total) * 100).toFixed(0) : 0;
                                                const meta = difficultyMeta[difficulty] || difficultyMeta.Moderate;
                                                return (
                                                    <div key={difficulty}>
                                                        <div style={{ display:'flex', justifyContent:'space-between', alignItems:'center', marginBottom:5 }}>
                                                            <div style={{ display:'flex', alignItems:'center', gap:8 }}>
                                                                <span style={{ display:'inline-block', background:meta.badge.bg, color:meta.badge.color, fontSize:'.68rem', fontWeight:600, padding:'2px 9px', borderRadius:4, fontFamily:"'DM Mono',monospace" }}>{difficulty}</span>
                                                                <span style={{ fontSize:'.76rem', color:'#7a7a9a' }}>{stats.correct}/{stats.total}</span>
                                                            </div>
                                                            <span style={{ fontFamily:"'Cormorant Garamond',serif", fontSize:'1.35rem', fontWeight:700, color:'#0f1e3c' }}>{pct}%</span>
                                                        </div>
                                                        <div style={{ height:5, background:'#eceae4', borderRadius:3, overflow:'hidden' }}>
                                                            <div style={{ height:'100%', width:`${pct}%`, background:meta.bar, borderRadius:3, transition:'width 1s ease' }} />
                                                        </div>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>

                                    {/* By chapter */}
                                    <div style={{ background:'#fff', border:'1px solid #ddd8cc', borderRadius:16, overflow:'hidden', boxShadow:'0 2px 12px rgba(15,30,60,.07)' }}>
                                        <div style={{ background:'#0f1e3c', padding:'14px 22px' }}>
                                            <span style={{ fontSize:'.65rem', fontWeight:700, letterSpacing:'.14em', textTransform:'uppercase', color:'#e8c97a' }}>By Chapter</span>
                                        </div>
                                        <div style={{ padding:'20px 22px', display:'flex', flexDirection:'column', gap:14 }}>
                                            {Object.entries(analysisByChapter).map(([chapter, data]) => {
                                                const pct = data.total > 0 ? ((data.correct / data.total) * 100).toFixed(0) : 0;
                                                return (
                                                    <div key={chapter}>
                                                        <div style={{ display:'flex', justifyContent:'space-between', alignItems:'flex-start', marginBottom:5 }}>
                                                            <div>
                                                                <span style={{ display:'inline-block', fontFamily:"'DM Mono',monospace", fontSize:'.65rem', fontWeight:600, color:'#c9a84c', background:'#f7f0dc', padding:'2px 7px', borderRadius:4, marginRight:7 }}>Ch {chapter}</span>
                                                                <span style={{ fontSize:'.76rem', color:'#3a3a5c', fontWeight:500 }}>{data.name}</span>
                                                            </div>
                                                            <span style={{ fontFamily:"'Cormorant Garamond',serif", fontSize:'1.35rem', fontWeight:700, color:'#0f1e3c', flexShrink:0, marginLeft:12 }}>{pct}%</span>
                                                        </div>
                                                        <div style={{ height:5, background:'#eceae4', borderRadius:3, overflow:'hidden' }}>
                                                            <div style={{ height:'100%', width:`${pct}%`, background:'#1a2f5a', borderRadius:3, transition:'width 1s ease' }} />
                                                        </div>
                                                        <div style={{ fontSize:'.7rem', color:'#7a7a9a', marginTop:3 }}>{data.correct} of {data.total} correct</div>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {/* ‚îÄ‚îÄ Marked for Review ‚îÄ‚îÄ */}
                            {questions.filter(q => markedForReview.has(q.id) && !!answers[q.id]).length > 0 && (
                                <div style={{ marginBottom:48 }}>
                                    <SectionEyebrow label="Flagged Questions" />
                                    <h2 style={{ fontFamily:"'Cormorant Garamond',serif", fontSize:'clamp(1.5rem,2.8vw,2rem)', fontWeight:700, color:'#0f1e3c', lineHeight:1.2, marginBottom:20 }}>Marked for Review</h2>
                                    <div style={{ display:'flex', flexDirection:'column', gap:12 }}>
                                        {questions.filter(q => markedForReview.has(q.id) && !!answers[q.id]).map((q, idx) => {
                                            const answer = answers[q.id];
                                            const isCorrect = answer?.selected === q.correctAnswer;
                                            return (
                                                <div key={q.id} style={{ background:'#fff', border:`1px solid ${isCorrect ? '#b6dfc8' : '#f0bfbf'}`, borderLeft:`4px solid ${isCorrect ? '#1a7a4a' : '#c0392b'}`, borderRadius:'0 12px 12px 0', padding:'16px 20px', boxShadow:'0 2px 8px rgba(15,30,60,.06)' }}>
                                                    <div style={{ display:'flex', justifyContent:'space-between', alignItems:'flex-start', marginBottom:8, gap:12 }}>
                                                        <div style={{ display:'flex', alignItems:'center', gap:8 }}>
                                                            <span style={{ fontFamily:"'DM Mono',monospace", fontSize:'.68rem', color:'#c9a84c', background:'#f7f0dc', padding:'2px 8px', borderRadius:4 }}>Ch {q.chapter}</span>
                                                            <span style={{ fontFamily:"'DM Mono',monospace", fontSize:'.68rem', color:'#7a7a9a' }}>üîñ Flagged</span>
                                                        </div>
                                                        <span style={{ fontSize:'.72rem', fontWeight:700, padding:'3px 10px', borderRadius:4, background: isCorrect ? '#e8f7ef' : '#fdecea', color: isCorrect ? '#1a5c3a' : '#8b1a1a', flexShrink:0 }}>{isCorrect ? '‚úì Correct' : '‚úó Incorrect'}</span>
                                                    </div>
                                                    <p style={{ fontSize:'.85rem', color:'#1a1a2e', fontWeight:500, marginBottom:10, lineHeight:1.5 }}>{q.question}</p>
                                                    <div style={{ fontSize:'.79rem', color:'#3a3a5c', display:'flex', gap:16, flexWrap:'wrap', paddingTop:10, borderTop:'1px solid #eceae4' }}>
                                                        <span>Your answer: <strong style={{ color: isCorrect ? '#1a7a4a' : '#c0392b' }}>{answer?.selected}</strong></span>
                                                        {!isCorrect && <span>Correct: <strong style={{ color:'#1a7a4a' }}>{q.correctAnswer}</strong></span>}
                                                    </div>
                                                    <div style={{ marginTop:8, fontSize:'.79rem', color:'#3a3a5c', background:'#faf8f3', borderRadius:8, padding:'10px 14px', lineHeight:1.6 }}>
                                                        <span style={{ fontWeight:600, color:'#0f1e3c' }}>Explanation: </span>{q.explanation}
                                                    </div>
                                                </div>
                                            );
                                        })}
                                    </div>
                                </div>
                            )}

                            {/* ‚îÄ‚îÄ Question-by-Question Review ‚îÄ‚îÄ */}
                            <div style={{ marginBottom:48 }}>
                                <SectionEyebrow label="Full Review" />
                                <h2 style={{ fontFamily:"'Cormorant Garamond',serif", fontSize:'clamp(1.5rem,2.8vw,2rem)', fontWeight:700, color:'#0f1e3c', lineHeight:1.2, marginBottom:20 }}>Answers &amp; Solutions</h2>
                                <div style={{ display:'flex', flexDirection:'column', gap:12 }}>
                                    {questions.filter(q => !!answers[q.id]).map((q, idx) => {
                                        const answer = answers[q.id];
                                        const isCorrect = answer?.selected === q.correctAnswer;
                                        const diffMeta = difficultyMeta[q.difficulty] || difficultyMeta.Moderate;
                                        return (
                                            <div key={q.id} style={{ background:'#fff', border:'1px solid #ddd8cc', borderLeft:`4px solid ${isCorrect ? '#1a7a4a' : '#c0392b'}`, borderRadius:'0 14px 14px 0', boxShadow:'0 2px 10px rgba(15,30,60,.06)', overflow:'hidden' }}>
                                                {/* row header */}
                                                <div style={{ display:'flex', alignItems:'center', justifyContent:'space-between', padding:'12px 20px', borderBottom:'1px solid #eceae4', background: isCorrect ? '#f4fbf7' : '#fff8f8' }}>
                                                    <div style={{ display:'flex', alignItems:'center', gap:10 }}>
                                                        <div style={{ width:28, height:28, borderRadius:'50%', background: isCorrect ? '#1a7a4a' : '#c0392b', display:'flex', alignItems:'center', justifyContent:'center', flexShrink:0 }}>
                                                            <span style={{ color:'#fff', fontSize:'.72rem', fontWeight:700 }}>{isCorrect ? '‚úì' : '‚úó'}</span>
                                                        </div>
                                                        <span style={{ fontFamily:"'DM Mono',monospace", fontSize:'.72rem', color:'#7a7a9a' }}>Q{idx + 1}</span>
                                                        <span style={{ fontFamily:"'DM Mono',monospace", fontSize:'.65rem', color:'#c9a84c', background:'#f7f0dc', padding:'2px 7px', borderRadius:4 }}>Ch {q.chapter}</span>
                                                        <span style={{ fontSize:'.68rem', fontWeight:600, padding:'2px 8px', borderRadius:4, background: diffMeta.badge.bg, color: diffMeta.badge.color }}>{q.difficulty}</span>
                                                        <span style={{ fontSize:'.76rem', color:'#3a3a5c', fontWeight:500 }}>{q.topic}</span>
                                                    </div>
                                                    <span style={{ fontSize:'.72rem', fontWeight:700, padding:'3px 10px', borderRadius:4, background: isCorrect ? '#e8f7ef' : '#fdecea', color: isCorrect ? '#1a5c3a' : '#8b1a1a', flexShrink:0 }}>{isCorrect ? 'Correct' : 'Incorrect'}</span>
                                                </div>
                                                {/* body */}
                                                <div style={{ padding:'16px 20px' }}>
                                                    <p style={{ fontSize:'.88rem', color:'#1a1a2e', fontWeight:500, lineHeight:1.55, marginBottom:12 }}>{q.question}</p>
                                                    <div style={{ display:'flex', gap:12, flexWrap:'wrap', marginBottom:12 }}>
                                                        <span style={{ fontSize:'.79rem', color:'#3a3a5c' }}>
                                                            Your answer: <strong style={{ color: isCorrect ? '#1a7a4a' : '#c0392b' }}>{answer.selected}</strong>
                                                        </span>
                                                        {!isCorrect && (
                                                            <span style={{ fontSize:'.79rem', color:'#3a3a5c' }}>
                                                                Correct answer: <strong style={{ color:'#1a7a4a' }}>{q.correctAnswer}</strong>
                                                            </span>
                                                        )}
                                                    </div>
                                                    <div style={{ background:'#faf8f3', border:'1px solid #eceae4', borderLeft:'3px solid #c9a84c', borderRadius:'0 8px 8px 0', padding:'10px 14px', fontSize:'.79rem', color:'#3a3a5c', lineHeight:1.65 }}>
                                                        <span style={{ fontWeight:700, color:'#0f1e3c' }}>Explanation: </span>{q.explanation}
                                                    </div>
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>

                            {/* ‚îÄ‚îÄ Back to home ‚îÄ‚îÄ */}
                            <div style={{ textAlign:'center', paddingTop:12 }}>
                                <button
                                    onClick={() => window.goToHome && window.goToHome()}
                                    style={{ display:'inline-flex', alignItems:'center', justifyContent:'center', gap:10, padding:'15px 40px', background:'linear-gradient(135deg,#0f1e3c,#243a6b)', color:'#e8c97a', border:'none', borderRadius:12, fontFamily:"'DM Sans',sans-serif", fontSize:'.95rem', fontWeight:700, letterSpacing:'.02em', cursor:'pointer', boxShadow:'0 4px 20px rgba(15,30,60,.25)', transition:'all .2s' }}
                                    onMouseOver={e => { e.currentTarget.style.transform='translateY(-2px)'; e.currentTarget.style.boxShadow='0 8px 28px rgba(15,30,60,.32)'; }}
                                    onMouseOut={e => { e.currentTarget.style.transform='translateY(0)'; e.currentTarget.style.boxShadow='0 4px 20px rgba(15,30,60,.25)'; }}
                                >
                                    ‚Üê Back to Home Page
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // Exam Screen
            return (
                <div className="min-h-screen bg-gray-100">
                    {/* Header */}
                    <div className="bg-white shadow-md">
                        <div className="max-w-7xl mx-auto px-6 py-5">
                            <div className="flex items-center justify-between">
                                <div>
                                    <h1 className="text-2xl font-bold text-gray-800">Practice Session</h1>
                                    <p className="text-sm text-gray-600"> </p>
                                </div>
                                <div className="flex items-center space-x-8">
                                    <div className="text-center">
                                        <p className="text-xs text-gray-500 font-medium">TIME</p>
                                        <p className="text-2xl font-bold text-emerald-600 font-mono">{formatTime(timeElapsed)}</p>
                                    </div>
                                    <div className="text-center">
                                        <p className="text-xs text-gray-500 font-medium">PROGRESS</p>
                                        <p className="text-2xl font-bold text-emerald-600">{answeredCount}/{totalQuestions}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Progress Bar */}
                    <div className="bg-white shadow-sm">
                        <div className="max-w-7xl mx-auto px-6 py-4">
                            <div className="flex items-center justify-between mb-3">
                                <div className="flex items-center space-x-3">
                                    <button
                                        onClick={handlePrevious}
                                        disabled={currentQuestionIndex === 0}
                                        className={`p-2 rounded-lg transition-all ${
                                            currentQuestionIndex === 0 
                                                ? 'text-gray-300 cursor-not-allowed' 
                                                : 'text-emerald-600 hover:bg-emerald-50'
                                        }`}
                                    >
                                        <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
                                        </svg>
                                    </button>
                                    
                                    <span className="text-lg font-bold text-gray-800">
                                        Question {currentQuestionIndex + 1} of {totalQuestions}
                                    </span>
                                    
                                    <button
                                        onClick={handleNext}
                                        disabled={currentQuestionIndex === totalQuestions - 1}
                                        className={`p-2 rounded-lg transition-all ${
                                            currentQuestionIndex === totalQuestions - 1 
                                                ? 'text-gray-300 cursor-not-allowed' 
                                                : 'text-emerald-600 hover:bg-emerald-50'
                                        }`}
                                    >
                                        <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
                                        </svg>
                                    </button>
                                </div>
                                
                                <div className="flex items-center space-x-4">
                                    <label className="flex items-center cursor-pointer text-gray-700 hover:text-emerald-600 font-medium">
                                        <input 
                                            type="checkbox"
                                            checked={markedForReview.has(currentQuestion.id)}
                                            onChange={toggleRevisit}
                                            className="mr-2 w-5 h-5 text-emerald-600 rounded"
                                        />
                                        Mark for Review
                                    </label>

                                    <span className="text-sm text-gray-600 mr-3">Marked: <span className="font-semibold text-gray-900">{markedCount}</span></span>

                                    <button
                                        onClick={goToNextMarked}
                                        disabled={markedCount === 0}
                                        className={`px-4 py-2 rounded-xl font-bold transition-all ${markedCount === 0 ? 'bg-gray-100 text-gray-400 cursor-not-allowed' : 'bg-emerald-600 text-white hover:shadow-lg'}`}
                                    >
                                        Next Marked
                                    </button>

                                    <button
                                        onClick={clearAllMarked}
                                        disabled={markedCount === 0}
                                        className={`px-4 py-2 rounded-xl font-bold transition-all ${markedCount === 0 ? 'bg-gray-100 text-gray-400 cursor-not-allowed' : 'bg-gray-200 text-gray-800 hover:bg-gray-300'}`}
                                    >
                                        Clear Marks
                                    </button>

                                    <button
                                        onClick={exitExam}
                                        className="px-6 py-2 bg-gray-200 text-gray-800 rounded-xl font-bold hover:bg-gray-300 transition-all"
                                    >
                                        Exit
                                    </button>
                                </div>
                            </div>
                            
                            <div className="w-full bg-gray-200 rounded-full h-3 overflow-hidden">
                                <div 
                                    className="gradient-bg h-full transition-all duration-300"
                                    style={{ width: `${progress}%` }}
                                />
                            </div>
                        </div>
                    </div>

                    {/* Question Content */}
                    <div className="max-w-7xl mx-auto p-6">
                        <div className="bg-white rounded-3xl card-shadow p-10">
                            {/* Question Header */}
                            <div className="mb-8">
                                <div className="flex items-center justify-between mb-5">
                                    <span className="bg-emerald-100 text-emerald-800 px-4 py-2 rounded-xl text-sm font-bold">
                                        {currentQuestion.topic}
                                    </span>
                                    <span className={`px-4 py-2 rounded-xl text-sm font-bold ${
                                        currentQuestion.difficulty === 'Easy' ? 'bg-green-100 text-green-800' :
                                        currentQuestion.difficulty === 'Moderate' ? 'bg-yellow-100 text-yellow-800' :
                                        'bg-red-100 text-red-800'
                                    }`}>
                                        {currentQuestion.difficulty}
                                    </span>
                                </div>
                                <h2 className="text-2xl font-bold text-gray-800 leading-relaxed">
                                    {currentQuestion.question}
                                </h2>
                            </div>

                            {/* Answer Options */}
                            <div className="space-y-4 mb-10">
                                {currentQuestion.options.map((option, idx) => {
                                    const optionLetter = String.fromCharCode(65 + idx);
                                    const isSelected = selectedAnswer === optionLetter;
                                    const isEliminated = eliminatedOptions[`${currentQuestion.id}-${optionLetter}`];
                                    
                                    return (
                                        <div 
                                            key={idx}
                                            className={`option-card flex items-center border-3 rounded-2xl p-5 cursor-pointer ${
                                                isEliminated ? 'eliminated border-gray-200' : 
                                                isSelected ? 'border-purple-500 bg-emerald-50 shadow-lg' : 'border-gray-300 hover:border-purple-400'
                                            }`}
                                            onClick={() => !isEliminated && handleAnswerSelect(optionLetter)}
                                        >
                                            <div className={`w-12 h-12 rounded-xl flex items-center justify-center font-bold text-lg mr-5 ${
                                                isSelected ? 'gradient-bg text-white' : 'bg-gray-200 text-gray-700'
                                            }`}>
                                                {optionLetter}
                                            </div>
                                            <span className={`flex-1 text-lg ${isEliminated ? 'line-through text-gray-400' : 'text-gray-800 font-medium'}`}>
                                                {option}
                                            </span>
                                            <button
                                                onClick={(e) => {
                                                    e.stopPropagation();
                                                    toggleEliminate(currentQuestion.id, optionLetter);
                                                }}
                                                className={`ml-4 ${isEliminated ? 'text-gray-400' : 'text-gray-400 hover:text-red-500'} transition-colors`}
                                            >
                                                <svg className="w-7 h-7" fill="currentColor" viewBox="0 0 20 20">
                                                    <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clipRule="evenodd" />
                                                </svg>
                                            </button>
                                        </div>
                                    );
                                })}
                            </div>

                            {/* Submit Button */}
                            <button
                                onClick={handleConfirm}
                                disabled={!selectedAnswer}
                                className={`w-full py-5 rounded-2xl font-bold text-lg transition-all ${
                                    selectedAnswer
                                        ? 'gradient-bg text-white hover:shadow-2xl transform hover:scale-[1.02]'
                                        : 'bg-gray-300 text-gray-500 cursor-not-allowed'
                                }`}
                            >
                                {currentQuestionIndex < totalQuestions - 1 ? 'Submit Answer' : 'Submit Final Answer'}
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('app'));
        root.render(<FinanceExamApp />);
    

function mountReact() {
  const root = ReactDOM.createRoot(document.getElementById('app'));
  root.render(<FinanceExamApp />);
}
</script>

</body>
</html>